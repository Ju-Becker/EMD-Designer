!function(e){var t={};function a(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);const s={i:"",s:"",sr:"",sm:"",t:"",tr:"",tm:""};s.i="Double click an empty space in the <b>Model</b> pane to create a state.<br>Click an object to select it.<br>Drag a state to improve readability.<br>",s.s="Press <b>DEL</b> to delete the state.<br>Press <b>INS</b> to rename the state.<br>Hold <b>CTRL</b> and click a state to create a transition.<br>Click an empty space for more options.",s.sr="Press <b>CTRL</b> + <b>l</b> (latin), <b>g</b> (greek), <b>s</b> (symbol) to choose an alphabet.<br>Enter letters (<b>a</b> or <b>A</b>) to change the name.<br>Enter numbers (<b>1</b>, <b>2</b>, <b>12</b>) to add a subscript<br>Delete with <b>BACKSPACE</b>, confirm with <b>ENTER</b> or click.",s.t="Press <b>DEL</b> to delete the transition.<br>Press <b>INS</b> to rename the transition.<br>Hold <b>t</b> to choose a transition target (<b>s</b>ource, <b>f</b>actor).<br>Click an empty space for more options.",s.tr=s.sr,s.sm=s.s,s.tm=s.t;var n=s;const i={check:"",Delete:"",rename:"",in:"",out:"",S:"",G:"",L:"",up:"",low:"",T:"",X:"",target:"",source:""};i.check="Confirm the name",i.Delete="Delete the active",i.rename="Click this button to Rename",i.in="Create a specialArrow in",i.out="Create a specialArrow out",i.S="special alphabet keyboard",i.G="greek alphabet keyboard",i.L="latin alphabet keyboard",i.up="Upper case alphabet",i.low="Lower case alphabet",i.T="Create a new Transition",i.X="Vallidate your input",i.target="Choose a new target",i.source="Choose a new source";var o=i;const r={L:{S:null,C:null},G:{S:null,C:null},S:{S:null,C:null},greek:{S:null,C:null}};r.L.S={A:119886,B:119887,C:119888,D:119889,E:119890,F:119891,G:119892,H:8462,I:119894,J:119895,K:119896,L:119897,M:119898,N:119899,O:119900,P:119901,Q:119902,R:119903,S:119904,T:119905,U:119906,V:119907,W:119908,X:119909,Y:119910,Z:119911,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.L.C={A:119860,B:119861,C:119862,D:119863,E:119864,F:119865,G:119866,H:119867,I:119868,J:119869,K:119870,L:119871,M:119872,N:119873,O:119874,P:119875,Q:119876,R:119877,S:119878,T:119879,U:119880,V:119881,W:119882,X:119883,Y:119884,Z:119885,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.G.S={A:120572,B:120573,C:120585,D:120575,E:120576,F:120593,G:120574,H:120578,I:120580,J:120589,K:120581,L:120582,M:120583,N:120584,O:120586,P:120587,Q:120579,R:120588,S:120590,T:120591,U:120592,W:120596,X:120594,Y:120595,Z:120577,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.G.C={A:120546,B:120547,C:120559,D:120549,E:120550,F:120567,G:120548,H:120552,I:120554,K:120555,L:120556,M:120557,N:120558,O:120560,P:120561,Q:120553,R:120562,S:120564,T:120565,U:120566,W:120570,X:120568,Y:120569,Z:120551,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.S.S={E:120598,F:120601,K:120600,P:120603,Q:120599,R:120602,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.S.C={Q:120563,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.greek.S={120572:"alpha",120573:"beta",120585:"xi",120575:"delta",120576:"epsilon",120593:"phi",120574:"gamma",120578:"eta",120580:"iota",120589:"zeta",120581:"kappa",120582:"lambda",120583:"mu",120584:"nu",120586:"o",120587:"pi",120579:"theta",120588:"rho",120590:"sigma",120591:"tau",120592:"upsilon",120596:"omega",120594:"chi",120595:"psi",120577:"zeta"};var l=r;var c={stateRadius:20,snapToPadding:6,hitTargetPadding:6,instancesLimit:1e6,specialArrowLimit:5,stateDefaultColour:"black",stateSelectedColour:"blue",stateTransitionFactorColour:"red",transitionDefaultColour:"black",transitionSelectedColour:"blue",transitionStateFactorColour:"red",stateKeys:{Rename:45,Delete:46,Transition:17},transitionKeys:{Rename:45,Delete:46,Target:84,Source:83,Factor:70},canvas:null,context:null,buildString:e=>{let t="";for(let a=0;a<e.length;a+=1)t+=String.fromCodePoint(e[a]);return t}};var d=class{constructor(e,t,a,s=c.stateRadius){this.radius=s,this.x=Math.min(t,c.canvas.width-this.radius),this.x=Math.max(this.x,this.radius),this.y=Math.min(a,c.canvas.height-this.radius),this.y=Math.max(this.y,this.radius),this.moveOffsetX=0,this.moveOffsetY=0,this.id=e,this.nameArr=[],this.name="",this.data=[],this.colour=c.stateDefaultColour,this.lineWidth=1,this.transitions={in:[],out:[],factor:[]}}transitionAdd(e,t){this.transitions[t][e.id]=e}transitionDelete(e,t){delete this.transitions[t][e.id]}updateTransitions(){let e;for(e in this.transitions.factor)this.transitions.factor[e].nameUpdate()}activate(){let e;for(e in this.colour=c.stateSelectedColour,this.transitions.factor)this.transitions.factor[e].colour=c.stateTransitionFactorColour}deactivate(){let e;for(e in this.colour=c.stateDefaultColour,this.transitions.factor)this.transitions.factor[e].colour=c.transitionDefaultColour}moveStart(e,t){this.moveOffsetX=e-this.x,this.moveOffsetY=t-this.y}move(e,t){let a;for(a in this.x=e-this.moveOffsetX,this.y=t-this.moveOffsetY,this.x=Math.min(this.x,c.canvas.width-this.radius),this.x=Math.max(this.x,this.radius),this.y=Math.min(this.y,c.canvas.height-this.radius),this.y=Math.max(this.y,this.radius),this.transitions.in)this.transitions.in[a].updateShape();for(a in this.transitions.out)this.transitions.out[a].updateShape()}moveStop(){this.moveOffsetX=0,this.moveOffsetY=0}nameAddChr(e){this.nameArr.push(e),this.name+=String.fromCodePoint(e)}nameRemoveChr(){return 0!==this.nameArr.length&&(this.nameArr.pop(),this.name=c.buildString(this.nameArr),!0)}draw(){if(0!==this.radius){const e=c.context;e.lineWidth=this.lineWidth,e.strokeStyle=this.colour,e.fillStyle=this.colour,e.font="20px Verdana, Geneva, Tahoma, sans-serif",e.textAlign="center",e.textBaseline="middle",e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI),e.stroke(),e.fillText(this.name,this.x,this.y)}}closestPointOnCircle(e,t){const a=e-this.x,s=t-this.y,n=Math.sqrt(a*a+s*s);return{x:this.x+a*this.radius/n,y:this.y+s*this.radius/n}}};let h={},u={};function p(e){return e.preventDefault(),0!==e.button||(h.mouseDown(e),u.focus()),!1}function m(e){return e.preventDefault(),!1}function f(e){return e.preventDefault(),!1}function b(e){return e.preventDefault(),h.dblClick(e),!1}function v(e){return e.preventDefault(),0===e.button&&h.mouseCancel(e),!1}function g(e){h.mouseCancel(e)}function y(e){h.mouseMove(e)}function S(e){return e.preventDefault(),h.keyDown(e),!1}function I(e){h.keyUp(e)}var k=function(e,t){u=e,h=t,u.addEventListener("mousedown",p),u.addEventListener("click",m),u.addEventListener("dblclick",b),u.addEventListener("contextmenu",f),u.addEventListener("mousemove",y),u.addEventListener("mouseup",v),u.addEventListener("mouseout",g),u.addEventListener("keydown",S),u.addEventListener("keyup",I)};let w={};const D={};let C={},x={};function E(){let e;return e="s"===C.state?C.selectionTransitionTarget?"t":"i":"sm"===C.state?"m":"sr"===C.state?"r":null,e}D.mouseDown=e=>{switch(E()){case"i":C.systemStateMouseDown(e.offsetX,e.offsetY);break;case"t":x.stateSelectTransitionTarget(e);break;case"r":x.stateRenameExitSelect(e)}},D.mouseMove=e=>{"m"===E()&&C.moveObject(e)},D.mouseCancel=()=>{"m"===E()&&C.moveStop()},D.keyDown=e=>{const t=E(),a=e.keycode||e.which;switch(t){case"i":!function(e){switch(e){case w.Transition:x.stateActivateTransition();break;case w.Rename:x.stateActivateRename();break;case w.Delete:x.stateActivateDelete()}}(a);break;case"r":x.renameKeyDown(e)}},D.keyUp=e=>{const t=E(),a=e.keycode||e.which;"t"===t&&a===w.Transition&&x.stateActivateIdle()},D.init=(e,t,a)=>{C=e,w=a,x=t};var A=D;let M={};const R={};let T={},B={};function O(){let e;return e="t"===T.state?T.selectionTransitionTarget?"t":T.selectionTransitionSource?"s":T.selectionTransitionFactor?"f":"i":"tm"===T.state?"m":"tr"===T.state?"r":null,e}R.mouseDown=e=>{switch(O()){case"i":T.systemStateMouseDown(e.offsetX,e.offsetY);break;case"t":B.transitionSelectTarget(e);break;case"s":B.transitionSelectSource(e);break;case"f":B.transitionSelectFactor(e);break;case"r":B.transitionRenameExitSelect(e)}},R.mouseMove=e=>{"m"===O()&&T.moveObject(e)},R.mouseCancel=()=>{"m"===O()&&T.moveStop()},R.keyDown=e=>{switch(O()){case"i":!function(e){switch(e.keycode||e.which){case M.Target:B.transitionActivateTarget();break;case M.Source:B.transitionActivateSource();break;case M.Factor:B.transitionActivateFactor();break;case M.Rename:B.transitionActivateRename();break;case M.Delete:B.transitionActivateDelete()}}(e)}},R.keyUp=e=>{const t=O(),a=e.keycode||e.which;("t"===t&&a===M.Target||"s"===t&&a===M.Source||"f"===t&&a===M.Factor)&&B.transitionActivateIdle()},R.init=(e,t,a)=>{T=e,B=t,M=a};var P=R;const X={};let K={},L={},H={};X.mouseDown=e=>{K.systemStateMouseDown(e.offsetX,e.offsetY)},X.dblClick=e=>{e.shiftKey?H.specialstatecreate(e,"special"):L.stateCreate(e)},X.init=(e,t,a)=>{K=e,L=t,H=a};var j=X;const G={};let N={};function V(){let e;switch(N.state){case"s":case"sr":case"sm":e="s";break;case"t":case"tr":case"tm":e="t";break;case"i":e="i"}return e}G.mouseDown=e=>{switch(V()){case"i":j.mouseDown(e);break;case"s":A.mouseDown(e);break;case"t":P.mouseDown(e)}},G.dblClick=e=>("i"!==V()||j.dblClick(e),!1),G.mouseCancel=()=>{switch(V()){case"s":A.mouseCancel();break;case"t":P.mouseCancel()}},G.mouseMove=e=>{switch(V()){case"s":A.mouseMove(e);break;case"t":P.mouseMove(e)}},G.keyDown=e=>{switch(V()){case"s":A.keyDown(e);break;case"t":P.keyDown(e)}},G.keyUp=e=>{switch(V()){case"s":A.keyUp(e);break;case"t":P.keyUp(e)}};var F=function(e,t,a,s,n,i,o){k(e,G),N=t,j.init(N,a,s),A.init(N,a,i),P.init(N,n,o)};let U={},z={},Y=0,J=0,_=100;const q={s:0,t:0},W={};function Z(e,t,a){return U.beginPath(),U.arc(a.x,a.y,J,0,2*Math.PI),U.closePath(),!!U.isPointInPath(e,t)}function Q(e,t,a){const s=a.shape.source.point,n=a.shape.target.point,i=n.x-s.x,o=n.y-s.y,r=Math.sqrt(i*i+o*o),l=(i*(e-s.x)+o*(t-s.y))/(r*r),c=(i*(t-s.y)-o*(e-s.x))/r;return l>0&&l<1&&Math.abs(c)<Y}W.shMap=new Map,W.getShape=e=>W.shMap.get(e),W.findShape=(e,t)=>{let a,s,n;for([a,n]of W.shMap)switch(s=a.substring(0,1),s){case"s":if(Z(e,t,n))return n;break;case"t":if(Q(e,t,n))return n}return null},W.stateconflict=e=>{let t,a,s;const n=e.id;for([t,a]of W.shMap)switch(s=t.substring(0,1),s){case"s":if((e.x-a.x)*(e.x-a.x)+(e.y-a.y)*(e.y-a.y)<=4*J*J&&n!==t)return!0}return!1},W.findStateNameConflict=e=>{let t,a;const s=e.id,n=e.name;for([t,a]of W.shMap)if("s"===t.substring(0,1)&&a.name===n&&t!==s)return a;return null},W.generateFreeID=e=>q[e]>=_?"":(q[e]+=1,e+(q[e]-1)),W.draw=()=>{let e;for(e of(U.clearRect(0,0,z.width,z.height),W.shMap.values()))e.draw()},W.addShape=(e,t)=>{W.shMap.set(e,t)},W.deleteShape=e=>{W.shMap.delete(e)},W.init=(e,t,a,s)=>{z=e,U=z.getContext("2d"),J=t,Y=a,_=s};var ee=W;let te={},ae={},se={},ne={},ie=0;const oe={stateSelectTransitionTarget:e=>{const t=ae.activeShape,a=te.findShape(e.offsetX,e.offsetY);if(null==a||"s"!==a.id.substring(0,1)||a.id===t.id)return;t.deactivate();const s=se.transitionCreate(t,a);null!==s&&(ae.systemStateActivate("tr",s),te.draw())},renameKeyDown:e=>{let t=e.keyCode||e.which;const a=ae.activeShape;if(13===t&&oe.renameValidate())return ae.systemStateActivate("s",a),te.draw(),!0;if(e.ctrlKey)return t=String.fromCharCode(t),"L"!==t&&"G"!==t&&"S"!==t||(ae.alphabet=t),!0;if(8===t)return a.nameRemoveChr(),te.draw(),!0;t=String.fromCharCode(t);const s=ae.symbols[ae.alphabet][e.shiftKey?"C":"S"][t];return void 0===s||(a.nameAddChr(s),te.draw()),!0},stateName:e=>"sr"===ae.state&&(ae.activeShape.nameAddChr(e),te.draw(),!0),nameRemoveToken:()=>(ae.activeShape.nameRemoveChr(),te.draw(),!0),checkName:()=>{if(oe.renameValidate())return ae.systemStateActivate("s",ae.activeShape),te.draw(),!0},stateRenameExitSelect:e=>{oe.renameValidate()&&ae.systemStateMouseDown(e.offsetX,e.offsetY)},renameValidate:()=>{const e=ae.activeShape;if(0===e.name.length)return alert("Please provide a name!"),!1;if("ùëÅ"===e.name)return alert("The name ùëÅ is blocked!"),!1;if(null!==te.findStateNameConflict(e))return alert("There already exists a state with this name!"),!1;if(e.name!==ae.nameOld){let t=ne.returncapacitystatesbystate(e),a=8320;for(let s=0;s<t.length;s++)a++,t[s].name=e.name.concat([String.fromCodePoint(a)]),t[s].nameArr=e.nameArr.concat([a]),te.draw();e.updateTransitions(),ae.callback(te.shMap)}return!0},stateActivateTransition:()=>{ae.selectionTransitionTarget=!0},stateActivateRename:()=>{ae.systemStateActivate("sr",ae.activeShape)},stateActivateDelete:()=>{"s0"!==ae.activeShape.id&&(oe.stateDelete(ae.activeShape),ae.systemStateActivate("i",null),te.draw())},stateActivateIdle:()=>{ae.selectionTransitionTarget=!1},stateCreate:e=>{const t=te.generateFreeID("s");if(0===t.length)return alert("Only "+ie+" states allowed, limit reached!"),!1;const a=new d(t,e.offsetX,e.offsetY);return te.stateconflict(a)?(alert("Collision with another State"),!1):(te.addShape(t,a),ae.systemStateActivate("sr",a),te.draw(),!1)},stateDelete:e=>{let t,a=ne.returncapacitystatesbystate(e);for(t in e.deactivate(),e.transitions.in)se.transitionDelete(te.getShape(t),!1);for(t in e.transitions.out)se.transitionDelete(te.getShape(t),!1);for(t in e.transitions.factor)se.transitionDelete(te.getShape(t),!1);te.deleteShape(e.id);for(let e=0;e<a.length;e++)oe.stateDelete(a[e]);ae.callback(te.shMap)},init:(e,t,a,s,n)=>{te=e,ae=t,se=a,ne=s,ie=n}};var re=oe;var le=class{constructor(e,t,a){this.id=e,this.nameArr=[],this.name="",this.colour=c.transitionDefaultColour,this.lineWidth=1,this.shape={source:{point:{x:0,y:0}},target:{point:{x:0,y:0}}},this.factors=[],t.transitionAdd(this,"out"),a.transitionAdd(this,"in"),this.source=t,this.target=a,this.updateShape()}delete(){let e;for(e in this.deactivate(),this.source.transitionDelete(this,"out"),this.target.transitionDelete(this,"in"),this.factors)this.factors[e].transitionDelete(this,"factor")}setTarget(e){this.target.transitionDelete(this,"in"),this.target=e,e.transitionAdd(this,"in"),this.updateShape()}setSource(e){this.source.transitionDelete(this,"out"),this.source=e,e.transitionAdd(this,"out"),this.updateShape()}activate(){let e;for(e in this.colour=c.transitionSelectedColour,this.factors)this.factors[e].colour=c.transitionStateFactorColour}deactivate(){let e;for(e in this.colour=c.transitionDefaultColour,this.factors)this.factors[e].colour=c.stateDefaultColour}moveStart(e,t){}move(e,t){}moveStop(){}updateShape(){const e=(this.source.x+this.target.x)/2,t=(this.source.y+this.target.y)/2;this.shape.source.point=this.source.closestPointOnCircle(e,t),this.shape.target.point=this.target.closestPointOnCircle(e,t)}nameUpdate(){let e,t,a;const s=this.nameArr,n=s.length;for(this.name="",e=0;e<n;e+=1)[t,a]=s[e],this.name+="s"!==t?String.fromCodePoint(a):a.name}factorUpdate(){let e,t,a;const s=this.nameArr,n=s.length;for(e in this.factors)this.factors[e].transitionDelete(this,"factor"),this.factors[e].colour=c.stateDefaultColour;for(this.factors=[],e=0;e<n;e+=1)[t,a]=s[e],"s"===t&&(this.factors[a.id]=a,a.transitionAdd(this,"factor"),a.colour=c.transitionStateFactorColour)}nameAddToken(e,t){const a=this.nameArr,s=a.length,n=s>0?a[s-1][0]:"";return("o"!==e||"o"!==n)&&(this.nameArr.push([e,t]),this.nameUpdate(),this.factorUpdate(),!0)}nameRemoveToken(){return 0!==this.nameArr.length&&(this.nameArr.pop(),this.nameUpdate(),this.factorUpdate(),!0)}nameNormalize(){const e=this.nameArr,t=e.length;t>0&&"o"===e[t-1][0]&&this.nameRemoveToken()}draw(){const e=c.context;e.lineWidth=this.lineWidth,e.strokeStyle=this.colour,e.fillStyle=this.colour,e.font="20px Verdana, Geneva, Tahoma, sans-serif",e.textAlign="center",e.textBaseline="middle",e.beginPath(),e.moveTo(this.shape.source.point.x,this.shape.source.point.y),e.lineTo(this.shape.target.point.x,this.shape.target.point.y),e.stroke();let t=this.shape.target.point.x-this.shape.source.point.x,a=this.shape.target.point.y-this.shape.source.point.y;const s=Math.sqrt(t*t+a*a);t/=s,a/=s,e.beginPath(),e.moveTo(this.shape.target.point.x,this.shape.target.point.y),e.lineTo(this.shape.target.point.x-8*t+5*a,this.shape.target.point.y-8*a-5*t),e.lineTo(this.shape.target.point.x-8*t-5*a,this.shape.target.point.y-8*a+5*t),e.fill();let n=(this.shape.source.point.x+this.shape.target.point.x)/2,i=(this.shape.source.point.y+this.shape.target.point.y)/2;n+=15*a,i+=-15*t,e.fillText(this.name,n,i)}};let ce={},de={},he={},ue={},pe=0;const me={transitionCreate:(e,t)=>{const a=ce.generateFreeID("t");if(0===a.length)return alert("Only "+pe+" transitions allowed, limit reached!"),null;if(void 0!==e.max)return null;if(ue.inserttransitionlimitreached(t)&&void 0!==t.max)return null;const s=new le(a,e,t);return ce.addShape(a,s),s},transitionSelectTarget:e=>{he.rearrangement();const t=ce.findShape(e.offsetX,e.offsetY);if(null===t)return;if("s"!==t.id.substring(0,1))return;if(t.id===de.activeShape.source.id)return;if(t.id===de.activeShape.target.id)return;if(he.limitspAinreached(t))return void alert("limit reached");if(void 0!==t.capacitystate)return;if(ue.inserttransitionlimitreached(t)&&(void 0!==t.max||void 0!==t.capacitystate))return;let a=ue.returncapacitytransitionsbystate(t);for(let e=0;e<a.length;e++)a[e].name=de.activeShape.name,a[e].nameArr=de.activeShape.nameArr;de.activeShape.deactivate(),de.activeShape.setTarget(t),de.activeShape.activate(),he.arrangement(),de.callback(ce.shMap),ce.draw()},transitionSelectSource:e=>{he.rearrangement();const t=ce.findShape(e.offsetX,e.offsetY);null!=t&&"s"===t.id.substring(0,1)&&t.id!==de.activeShape.source.id&&t.id!==de.activeShape.target.id&&(he.limitspAoutreached(t)?alert("limit reached"):void 0===t.capacitystate&&void 0===t.type&&(de.activeShape.deactivate(),de.activeShape.setSource(t),de.activeShape.activate(),he.arrangement(),de.callback(ce.shMap),ce.draw()))},transitionSelectFactor:e=>{const t=ce.findShape(e.offsetX,e.offsetY);null!==t&&"s"===t.id.substring(0,1)&&(de.activeShape.deactivate(),de.activeShape.toggleFactor(t),de.activeShape.activate(),de.callback(ce.shMap),ce.draw())},transitionActivateTarget:()=>{de.selectionTransitionTarget=!0},transitionActivateSource:()=>{de.selectionTransitionSource=!0},transitionActivateFactor:()=>{de.selectionTransitionFactor=!0},transitionActivateDelete:()=>{me.transitionDelete(de.activeShape),de.systemStateActivate("i",null),ce.draw()},transitionActivateIdle:()=>{de.selectionTransitionTarget=!1,de.selectionTransitionSource=!1,de.selectionTransitionFactor=!1},transitionDelete:(e,t=!0)=>{e.delete(),ce.deleteShape(e.id),t&&de.callback(ce.shMap)},transitionActivateRename:()=>{de.systemStateActivate("tr",de.activeShape)},nameValidate:()=>{const e=de.activeShape;if(0===e.name.length)return alert("Please provide a name!"),!1;if(e.name!==de.nameOld){let e=ue.returncapacitytransitionsbytransition(de.activeShape);for(let t=0;t<e.length;t++)e[t].name=de.activeShape.name,e[t].nameArr=de.activeShape.nameArr;de.callback(ce.shMap)}return!0},nameAppendRate:e=>"tr"===de.state&&(de.activeShape.nameAddToken("r",e),ce.draw(),!0),nameAppendPlus:()=>"tr"===de.state&&(de.activeShape.nameAddToken("o",65291),ce.draw(),!0),nameConfirm:()=>"tr"===de.state&&(de.activeShape.nameNormalize(),ce.draw(),!!me.nameValidate()&&(de.systemStateActivate("t",de.activeShape),ce.draw(),!0)),transitionRenameExitSelect:e=>{de.activeShape.nameNormalize(),me.nameValidate()&&de.systemStateMouseDown(e.offsetX,e.offsetY)},nameAppendState:e=>"tr"===de.state&&(de.activeShape.nameAddToken("s",e),ce.draw(),!0),nameRemoveToken:()=>"tr"===de.state&&(de.activeShape.nameRemoveToken(),ce.draw(),!0),init:(e,t,a,s,n)=>{ce=e,de=t,pe=a,he=s,ue=n}};var fe=me;const be=[],ve={addListener:e=>{be.push(e)},update:e=>{be.forEach(t=>{t(e)})}};var ge=ve;let ye="http://www.w3.org/2000/svg",Se=35;const Ie={setNS:e=>{ye=e},getNS:()=>ye,setKeySize:e=>{Se=e},getKeySize:()=>Se,createKey:function(e,t,a){const s=document.createElementNS(ye,"g");return s.setAttributeNS(null,"transform","translate("+e+","+t+")"),s.appendChild(function(){const e=document.createElementNS(ye,"rect");return e.setAttributeNS(null,"x",0),e.setAttributeNS(null,"y",0),e.setAttributeNS(null,"width",Se),e.setAttributeNS(null,"height",Se),e.style.strokeWidth=1,e.style.stroke="black",e.setAttributeNS(null,"fill","white"),e}()),s.appendChild(function(e){const t=document.createElementNS(ye,"text");return t.setAttributeNS(null,"x",.5*Se),t.setAttributeNS(null,"y",.5*Se),t.style.textAnchor="middle",t.style.alignmentBaseline="central",t.style.font="20px Verdana, Geneva, Tahoma, sans-serif",t.style.fill="black",t.style.pointerEvents="none",t.innerHTML=e,t}(a)),s}};var ke=Ie;let we="http://www.w3.org/2000/svg",De=35,Ce=13;const xe={check:null,del:null,plus:null,L:null,G:null,S:null,up:null,low:null,Del:null,R:null,T:null,X:null,target:null,source:null,in:null,out:null,checkenter:null,Deleteenter:null,Renter:null,inenter:null,outenter:null,Lenter:null,Genter:null,Senter:null,upenter:null,lowenter:null,Tenter:null,Xenter:null,targetenter:null,sourceenter:null},Ee=10003,Ae=11013,$e=65291,Me=76,Re=71,Te=83,Be=8593,Oe=8595,Pe=9249,Xe=82,Ke=8594,Le=88,He=8614,je=8620,Ge=8681,Ne=8679;function Ve(e,t){t.addEventListener("mousedown",t=>(t.preventDefault(),0!==t.button||xe[e](),!1))}function Fe(e,t){t.addEventListener("mouseenter",t=>(t.preventDefault(),0!==t.button||xe[e](),!1))}const Ue={setNS:e=>{we=e},getNS:()=>we,setKeySize:e=>{De=e},getKeySize:()=>De,setColoumnCount:e=>{Ce=e},getColoumnCount:()=>Ce,setHandler:(e,t)=>{xe[e]=t},getHandler:e=>xe[e],create:function(e,t,a){let s,n;ke.setKeySize(De),ke.setNS(we);const i=document.createElementNS(we,"g");switch(i.setAttributeNS(null,"transform","translate("+e+","+t+")"),a){case"s":n=String.fromCodePoint(Pe),s=ke.createKey(De*(Ce-13),0,n),Ve("Del",s),Fe("Deleteenter",s),i.appendChild(s),n=String.fromCodePoint(Xe),s=ke.createKey(De*(Ce-12),0,n),Ve("R",s),Fe("Renter",s),i.appendChild(s),n=String.fromCodePoint(Ke),s=ke.createKey(De*(Ce-11),0,n),Ve("T",s),Fe("Tenter",s),i.appendChild(s),n=String.fromCodePoint(Ge),s=ke.createKey(De*(Ce-10),0,n),Ve("in",s),Fe("inenter",s),i.appendChild(s),n=String.fromCodePoint(Ne),s=ke.createKey(De*(Ce-9),0,n),Ve("out",s),Fe("outenter",s),i.appendChild(s);break;case"sspecial":n=String.fromCodePoint(Pe),s=ke.createKey(De*(Ce-13),0,n),Ve("Del",s),Fe("Deleteenter",s),i.appendChild(s),n=String.fromCodePoint(Xe),s=ke.createKey(De*(Ce-12),0,n),Ve("R",s),Fe("Renter",s),i.appendChild(s);break;case"cspecial":n=String.fromCodePoint(Xe),s=ke.createKey(De*(Ce-12),0,n),Ve("R",s),Fe("Renter",s),i.appendChild(s),n=String.fromCodePoint(Ke),s=ke.createKey(De*(Ce-11),0,n),Ve("T",s),Fe("Tenter",s),i.appendChild(s),n=String.fromCodePoint(Ge),s=ke.createKey(De*(Ce-10),0,n),Ve("in",s),Fe("inenter",s),i.appendChild(s),n=String.fromCodePoint(Ne),s=ke.createKey(De*(Ce-9),0,n),Ve("out",s),Fe("outenter",s),i.appendChild(s);break;case"t":n=String.fromCodePoint(Pe),s=ke.createKey(De*(Ce-13),0,n),Ve("Del",s),Fe("Deleteenter",s),i.appendChild(s),n=String.fromCodePoint(Xe),s=ke.createKey(De*(Ce-12),0,n),Ve("R",s),i.appendChild(s),Fe("Renter",s),n=String.fromCodePoint(He),s=ke.createKey(De*(Ce-11),0,n),Ve("target",s),Fe("targetenter",s),i.appendChild(s),n=String.fromCodePoint(je),s=ke.createKey(De*(Ce-10),0,n),Ve("source",s),Fe("sourceenter",s),i.appendChild(s);break;case"tspecialin":n=String.fromCodePoint(Pe),s=ke.createKey(De*(Ce-13),0,n),Ve("Del",s),Fe("Deleteenter",s),i.appendChild(s),n=String.fromCodePoint(Xe),s=ke.createKey(De*(Ce-12),0,n),Ve("R",s),Fe("Renter",s),i.appendChild(s),n=String.fromCodePoint(He),s=ke.createKey(De*(Ce-11),0,n),Ve("target",s),Fe("targetenter",s),i.appendChild(s);break;case"tspecialout":n=String.fromCodePoint(Pe),s=ke.createKey(De*(Ce-13),0,n),Ve("Del",s),Fe("Deleteenter",s),i.appendChild(s),n=String.fromCodePoint(Xe),s=ke.createKey(De*(Ce-12),0,n),Ve("R",s),Fe("Renter",s),i.appendChild(s),n=String.fromCodePoint(je),s=ke.createKey(De*(Ce-10),0,n),Ve("source",s),Fe("sourceener",s),i.appendChild(s);break;case"X":n=String.fromCodePoint(Le),s=ke.createKey(De*(Ce-13),0,n),Ve("X",s),Fe("Xenter",s),i.appendChild(s);break;case"name":n=String.fromCodePoint($e),s=ke.createKey(De*(Ce-5),0,n),Ve("plus",s),i.appendChild(s),n=String.fromCodePoint(Ae),s=ke.createKey(De*(Ce-3),0,n),Ve("del",s),i.appendChild(s),n=String.fromCodePoint(Ee),s=ke.createKey(De*(Ce-1),0,n),Ve("check",s),Fe("checkenter",s),i.appendChild(s),n=String.fromCodePoint(Me),s=ke.createKey(De*(Ce-13),0,n),Ve("L",s),Fe("Lenter",s),i.appendChild(s),n=String.fromCodePoint(Re),s=ke.createKey(De*(Ce-12),0,n),Ve("G",s),Fe("Genter",s),i.appendChild(s),n=String.fromCodePoint(Te),s=ke.createKey(De*(Ce-11),0,n),Ve("S",s),Fe("Senter",s),i.appendChild(s),n=String.fromCodePoint(Be),s=ke.createKey(De*(Ce-9),0,n),Ve("up",s),Fe("upenter",s),i.appendChild(s),n=String.fromCodePoint(Oe),s=ke.createKey(De*(Ce-8),0,n),Ve("low",s),Fe("lowenter",s),i.appendChild(s)}return i}};var ze=Ue;let Ye="http://www.w3.org/2000/svg",Je=35,_e=13,qe=null;function We(e,t){t.addEventListener("mousedown",t=>(t.preventDefault(),0!==t.button||qe(e),!1))}const Ze={setNS:e=>{Ye=e},getNS:()=>Ye,setKeySize:e=>{Je=e},getKeySize:()=>Je,setColoumnCount:e=>{_e=e},getColoumnCount:()=>_e,setHandler:e=>{qe=e},getHandler:()=>qe,createAlphabet:function(e,t,a,s){let n,i,o,r,c=0,d=0,h=65;ke.setKeySize(Je),ke.setNS(Ye);const u=document.createElementNS(Ye,"g");for(u.setAttributeNS(null,"transform","translate("+e+","+t+")");h<91;)n=String.fromCharCode(h),i=l[a][s][n],void 0!==i&&(o=String.fromCodePoint(i),r=ke.createKey(d*Je,c*Je,o),We(i,r),u.appendChild(r),d+=1,d===_e&&(d=0,c+=1)),h+=1;return u}};var Qe=Ze;let et=35,tt=13,at="http://www.w3.org/2000/svg",st=null;const nt={};function it(e,t){t.addEventListener("mousedown",t=>(t.preventDefault(),0!==t.button||st(e),!1))}nt.setNS=e=>{at=e},nt.getNS=()=>at,nt.setKeySize=e=>{et=e},nt.getKeySize=()=>et,nt.setColoumnCount=e=>{tt=e},nt.getColoumnCount=()=>tt,nt.getHandler=()=>st,nt.setHandler=e=>{st=e},nt.create=function(e,t,a){let s,n,i,o=0,r=0;ke.setKeySize(et),ke.setNS(at);const l=document.createElementNS(at,"g");for([s,n]of(l.setAttributeNS(null,"transform","translate("+e+","+t+")"),a))"n"===s.substring(0,1)&&(i=ke.createKey(r*et,o*et,n.name),it(n,i),l.appendChild(i),r+=1,r===tt&&(r=0,o+=1)),"s"===s.substring(0,1)&&(i=ke.createKey(r*et,o*et,n.name),it(n,i),l.appendChild(i),r+=1,r===tt&&(r=0,o+=1));return l};var ot=nt;let rt="http://www.w3.org/2000/svg",lt=13,ct=35,dt=10,ht=null,ut=null,pt=null,mt=null,ft=null,bt=null,vt=null;const gt={plus:null,del:null,check:null,L:null,G:null,S:null,up:null,low:null,Del:null,R:null,T:null,X:null,target:null,source:null,in:null,out:null,checkenter:null,Deleteenter:null,Renter:null,inenter:null,outenter:null,Lenter:null,Genter:null,Senter:null,upenter:null,lowenter:null,Tenter:null,Xenter:null,targetenter:null,sourceenter:null};let yt=[10,55];const St={};function It(){ot.setColoumnCount(lt),ot.setKeySize(ct),ot.setNS(rt),ot.setHandler(vt)}function kt(e){It();const t=ot.create(yt[0],yt[1],e);null!==mt&&ut.removeChild(mt),ut.appendChild(t),mt=t}St.updateAlphabet=(e,t)=>{ut.removeChild(pt),pt=Qe.createAlphabet(dt,2*dt+ct,e,t),ut.appendChild(pt)},St.Alphabetvisibility=e=>{pt.setAttributeNS(null,"visibility",e)},St.updateAlphabetCase=e=>{if("up"==e){let e=pt.getElementsByTagName("text")[0].innerHTML;switch(e=e.charCodeAt(1),e){case 56398:ut.removeChild(pt),pt=Qe.createAlphabet(dt,2*dt+ct,"L","C"),ut.appendChild(pt);break;case 57084:ut.removeChild(pt),pt=Qe.createAlphabet(dt,2*dt+ct,"G","C"),ut.appendChild(pt);break;case 57110:ut.removeChild(pt),pt=Qe.createAlphabet(dt,2*dt+ct,"S","C"),ut.appendChild(pt)}}else{let e=pt.getElementsByTagName("text")[0].innerHTML;switch(e=e.charCodeAt(1),e){case 56372:ut.removeChild(pt),pt=Qe.createAlphabet(dt,2*dt+ct,"L","S"),ut.appendChild(pt);break;case 57058:ut.removeChild(pt),pt=Qe.createAlphabet(dt,2*dt+ct,"G","S"),ut.appendChild(pt);break;case 57075:ut.removeChild(pt),pt=Qe.createAlphabet(dt,2*dt+ct,"S","S"),ut.appendChild(pt)}}},St.updateSpecialKeys=e=>{ut.removeChild(ft),ft=ze.create(dt,dt,e),ut.appendChild(ft)},St.StateKeysvisibility=e=>{mt.setAttributeNS(null,"visibility",e)},St.visibility=e=>{ut.setAttributeNS(null,"visibility",e)},St.init=(e,t)=>{ht=e,function(){const e=2*dt+ct*lt,t=4*dt+5*ct;ut=document.createElementNS(rt,"svg"),ut.setAttributeNS(null,"width",e+"px"),ut.setAttributeNS(null,"height",t+"px")}(),ze.setKeySize(ct),ze.setNS(rt),ze.setColoumnCount(lt),ze.setHandler("plus",gt.plus),ze.setHandler("del",gt.del),ze.setHandler("check",gt.check),ze.setHandler("L",gt.L),ze.setHandler("G",gt.G),ze.setHandler("S",gt.S),ze.setHandler("up",gt.up),ze.setHandler("low",gt.low),ze.setHandler("Del",gt.Del),ze.setHandler("R",gt.R),ze.setHandler("T",gt.T),ze.setHandler("X",gt.X),ze.setHandler("target",gt.target),ze.setHandler("source",gt.source),ze.setHandler("in",gt.in),ze.setHandler("out",gt.out),ze.setHandler("checkenter",gt.checkenter),ze.setHandler("Deleteenter",gt.Deleteenter),ze.setHandler("Renter",gt.Renter),ze.setHandler("inenter",gt.inenter),ze.setHandler("outenter",gt.outenter),ze.setHandler("Senter",gt.Senter),ze.setHandler("Genter",gt.Genter),ze.setHandler("Lenter",gt.Lenter),ze.setHandler("upenter",gt.upenter),ze.setHandler("lowenter",gt.lowenter),ze.setHandler("Tenter",gt.Tenter),ze.setHandler("Xenter",gt.Xenter),ze.setHandler("targetenter",gt.targetenter),ze.setHandler("sourceenter",gt.sourceenter),Qe.setColoumnCount(lt),Qe.setKeySize(ct),Qe.setNS(rt),Qe.setHandler(bt),It(),t.addListener(kt),yt=[dt,3*dt+3*ct],ft=ze.create(dt,dt,"name"),ut.appendChild(ft),pt=Qe.createAlphabet(dt,2*dt+ct,"L","C"),ut.appendChild(pt),ht.appendChild(ut),ut.setAttributeNS(null,"visibility","hidden"),document.getElementById("inID").style.visibility="hidden"},St.setNS=e=>{rt=e},St.getNS=()=>rt,St.setKeySize=e=>{ct=e},St.getKeySize=()=>ct,St.setColoumnCount=e=>{lt=e},St.getColoumnCount=()=>lt,St.setAlphabetHandler=e=>{bt=e},St.getAlphabetHandler=()=>bt,St.setStateKeyHandler=e=>{vt=e},St.getStateKeyHandler=()=>vt,St.setPadding=e=>{dt=e},St.setSpecialKeyHandler=(e,t)=>{gt[e]=t},St.getSpecialKeyHandler=e=>gt[e],St.getPadding=()=>dt;var wt=St;let Dt={},Ct={},xt={},Et={},At={},$t=0;const Mt={updateAlphabetL:()=>{wt.updateAlphabet("L","C")},updateAlphabetG:()=>{wt.updateAlphabet("G","S")},updateAlphabetS:()=>{wt.updateAlphabet("S","S")},updateAlphabetlow:()=>{wt.updateAlphabetCase("low")},updateAlphabetup:()=>{wt.updateAlphabetCase("up")},letterIn:e=>{switch(Dt.state[0]){case"s":xt.stateName(e);break;case"t":Ct.nameAppendRate(e)}},RemoveTolken:()=>{switch(Dt.state){case"sr":xt.nameRemoveToken();break;case"tr":Ct.nameRemoveToken()}},check:()=>{switch(Dt.state[0]){case"s":xt.checkName();break;case"t":Ct.nameConfirm()}},delete:()=>{switch(Dt.state[0]){case"s":xt.stateActivateDelete();break;case"t":Et.rearrangement(),Ct.transitionActivateDelete()}},rename:()=>{switch(Dt.state[0]){case"s":xt.stateActivateRename();break;case"t":Ct.transitionActivateRename()}},arrowIn:()=>{Et.specialArrowCreate("in")},arrowOut:()=>{Et.specialArrowCreate("out")},newTransition:()=>{xt.stateActivateTransition(),wt.updateSpecialKeys("X")},leaveX:()=>{switch(Dt.state){case"s":xt.stateActivateIdle(),wt.updateSpecialKeys("s"),Mt.systemupdate("s");break;case"t":Ct.transitionActivateIdle(),wt.updateSpecialKeys("t"),Mt.systemupdate("t")}},transitiontarget:()=>{Ct.transitionActivateTarget(),wt.updateSpecialKeys("X")},transitionsource:()=>{Ct.transitionActivateSource(),wt.updateSpecialKeys("X")},showinfo:e=>{let t=window.event,a=document.getElementById("infoID");a.style.left=t.clientX+"px";let s=t.clientY-50;a.style.top=s+"px",a.style.visibility="visible",a.innerHTML=e,0===$t&&($t++,setTimeout((function(){a.style.visibility="hidden",$t=0}),1250))},systemupdate:e=>{let t=document.getElementById("inID");switch(e){case"s":"special"===Dt.activeShape.type?(t.style.visibility="visible",wt.visibility("visible"),wt.updateSpecialKeys("sspecial"),wt.Alphabetvisibility("hidden"),wt.StateKeysvisibility("hidden")):void 0!==Dt.activeShape.capacitystate?(t.style.visibility="visible",wt.visibility("visible"),wt.updateSpecialKeys("cspecial"),wt.Alphabetvisibility("hidden"),wt.StateKeysvisibility("hidden")):(t.style.visibility="visible",wt.visibility("visible"),wt.updateSpecialKeys("s"),wt.Alphabetvisibility("hidden"),wt.StateKeysvisibility("hidden"));break;case"sr":t.style.visibility="visible",wt.visibility("visible"),Mt.updateAlphabetL(),wt.Alphabetvisibility("visible"),wt.updateSpecialKeys("name"),wt.StateKeysvisibility("hidden");break;case"sm":t.style.visibility="hidden",wt.visibility("hidden"),wt.Alphabetvisibility("hidden");break;case"t":switch(Dt.activeShape.type){case void 0:t.style.visibility="visible",wt.visibility("visible"),wt.updateSpecialKeys("t"),wt.Alphabetvisibility("hidden"),wt.StateKeysvisibility("hidden");break;case"in":t.style.visibility="visible",wt.visibility("visible"),wt.updateSpecialKeys("tspecialin"),wt.Alphabetvisibility("hidden"),wt.StateKeysvisibility("hidden");break;case"out":t.style.visibility="visible",wt.visibility("visible"),wt.updateSpecialKeys("tspecialout"),wt.Alphabetvisibility("hidden"),wt.StateKeysvisibility("hidden")}void 0!==Dt.activeShape.capacitystate&&(t.style.visibility="hidden",wt.visibility("hidden"),wt.Alphabetvisibility("hidden"),wt.StateKeysvisibility("hidden"));break;case"tr":t.style.visibility="visible",wt.visibility("visible"),Mt.updateAlphabetG(),wt.Alphabetvisibility("visible"),wt.updateSpecialKeys("name"),wt.StateKeysvisibility("visible");break;case"tm":case"i":t.style.visibility="hidden",wt.visibility("hidden"),wt.Alphabetvisibility("hidden"),wt.StateKeysvisibility("hidden")}},checkenter:()=>{let e=At.check;Mt.showinfo(e)},Deleteenter:()=>{let e=At.Delete;switch(Dt.state){case"s":e+=" state";break;case"t":void 0!==Dt.activeShape.type?e+=" special arrow":e+=" transition"}Mt.showinfo(e)},Renter:()=>{let e=At.rename;Mt.showinfo(e)},inenter:()=>{let e=At.in;Mt.showinfo(e)},outenter:()=>{let e=At.out;Mt.showinfo(e)},Senter:()=>{let e=At.S;Mt.showinfo(e)},Genter:()=>{let e=At.G;Mt.showinfo(e)},Lenter:()=>{let e=At.L;Mt.showinfo(e)},upenter:()=>{let e=At.up;Mt.showinfo(e)},lowenter:()=>{let e=At.low;Mt.showinfo(e)},Tenter:()=>{let e=At.T;Mt.showinfo(e)},Xenter:()=>{let e=At.X;Mt.showinfo(e)},tagetenter:()=>{let e=At.target;Mt.showinfo(e)},sourceenter:()=>{let e=At.source;Mt.showinfo(e)},init:(e,t,a,s,n)=>{Dt=e,Ct=t,xt=a,Et=s,At=n}};var Rt=Mt;var Tt=class extends le{constructor(e,t,a,s){super(e,t,a),this.type=s}};let Bt={},Ot={},Pt=0;const Xt={returnstates:e=>{let t,a,s,n=[];for([t,a]of Bt.shMap)s=t.substring(0,1),"t"===s&&void 0!==a.type&&(a.source===e?n.push(a.target):a.target===e&&n.push(a.source));return n},specialArrowCreate:e=>{const t=Bt.generateFreeID("s"),a=Bt.generateFreeID("t");let s,n=Ot.activeShape.x,i=Ot.activeShape.y,o=0,r=0,l=0,c=0;const h=Xt.returnstates(Ot.activeShape);for(let e=0;e<h.length;e++)Ot.activeShape.x-h[e].x<=0&&Ot.activeShape.y-h[e].y>0||h[e].x-Ot.activeShape.x>0&&h[e].y-Ot.activeShape.y>0?l++:c++;if(l===Pt&&"in"===e||c===Pt&&"out"===e)return alert("Only "+Pt+" specialArrows allowed, limit reached!"),null;const u=Math.PI/Pt;switch(e){case"in":o=100*Math.cos(Math.PI/2-u*l),r=100*Math.cos(u*l);const h=new d(t,n+o,i-r,1);s=new Tt(a,h,Ot.activeShape,e);break;case"out":o=100*Math.cos(Math.PI/2-u*c),r=100*Math.cos(u*c);const p=new d(t,n-o,i+r,1);s=new Tt(a,Ot.activeShape,p,e)}return Bt.addShape(a,s),Ot.activeShape.deactivate(),Ot.systemStateActivate("tr",s),Bt.draw(),!1},rearrangement:()=>{let e=null;switch(Ot.activeShape.type){case"in":e=Ot.activeShape.target;break;case"out":e=Ot.activeShape.source}let t,a,s,n=0,i=0,o=0,r=0;const l=Math.PI/Pt;for([t,a]of Bt.shMap)s=t.substring(0,1),"t"===s&&void 0!==a.type&&t!=Ot.activeShape.id&&(a.source===e?(o=100*Math.cos(Math.PI/2-l*i),r=100*Math.cos(l*i),i++,a.target.move(e.x-o,e.y+r)):a.target===e&&(o=100*Math.cos(Math.PI/2-l*n),r=100*Math.cos(l*n),n++,a.source.move(e.x+o,e.y-r)))},arrangement:(e=Ot.activeShape)=>{let t=null;switch(e.type){case"in":t=e.target;break;case"out":t=e.source}let a,s,n,i=0,o=0,r=0,l=0;const c=Math.PI/Pt;for([a,s]of Bt.shMap)n=a.substring(0,1),"t"===n&&void 0!==s.type&&(s.source===t?(r=100*Math.cos(Math.PI/2-c*o),l=100*Math.cos(c*o),o++,s.target.move(t.x-r,t.y+l)):s.target===t&&(r=100*Math.cos(Math.PI/2-c*i),l=100*Math.cos(c*i),i++,s.source.move(t.x+r,t.y-l)))},arrangementstate:(e=Ot.activeShape)=>{let t,a,s,n=0,i=0,o=0,r=0;const l=Math.PI/Pt;for([t,a]of Bt.shMap)s=t.substring(0,1),"t"===s&&void 0!==a.type&&("out"===a.type&&a.source===e?(o=100*Math.cos(Math.PI/2-l*i),r=100*Math.cos(l*i),i++,a.target.move(e.x-o,e.y+r)):"in"===a.type&&a.target===e&&(o=100*Math.cos(Math.PI/2-l*n),r=100*Math.cos(l*n),n++,a.source.move(e.x+o,e.y-r)))},limitspAoutreached:(e=Ot.activeShape)=>{let t,a,s,n=0;for([t,a]of Bt.shMap)s=t.substring(0,1),"t"===s&&"out"===a.type&&a.source===e&&n++;return n>=Pt},limitspAinreached:(e=Ot.activeShape)=>{let t,a,s,n=0;for([t,a]of Bt.shMap)s=t.substring(0,1),"t"===s&&"in"===a.type&&a.target===e&&n++;return n>=Pt},init:(e,t,a)=>{Bt=e,Ot=t,Pt=a}};var Kt=Xt;var Lt=class extends d{constructor(e,t,a,s,n){super(e,t,a),this.type=s,this.max=n}draw(){const e=c.context;e.lineWidth=this.lineWidth,e.strokeStyle=this.colour,e.fillStyle=this.colour,e.font="20px Verdana, Geneva, Tahoma, sans-serif",e.textAlign="center",e.textBaseline="middle",e.strokeRect(this.x-15,this.y-15,this.radius+10,this.radius+10),e.fillText(this.name,this.x,this.y)}};let Ht={},jt={},Gt={},Nt=0;const Vt={specialstatecreate:(e,t)=>{const a=Ht.generateFreeID("s");if(0===a.length)return alert("Only "+Nt+" states allowed, limit reached!"),!1;var s="100";if(null===s)return;var n=Math.floor(Number(s));if(!(n!==1/0&&String(n)===s&&n>=0))return void alert("Error with the input!\nThe capacity must be a number less or equal zero.");s=parseInt(s);const i=new Lt(a,e.offsetX,e.offsetY,t,s);if(Ht.stateconflict(i))return alert("Collision with another State"),!1;Ht.addShape(a,i),jt.systemStateActivate("sr",i),Ht.draw();const o=Ht.generateFreeID("s"),r=new d(o,e.offsetX-50,e.offsetY+150);r.capacitystate="left",r.lineWidth=2,Ht.addShape(o,r),Ht.draw();const l=Ht.generateFreeID("s"),c=new d(l,e.offsetX+50,e.offsetY+150);c.capacitystate="right",c.lineWidth=.5,Ht.addShape(l,c),Ht.draw();const h=Ht.generateFreeID("t"),u=new le(h,Ht.getShape(a),Ht.getShape(o));u.capacitystate="left",u.lineWidth=2,Ht.addShape(h,u);const p=Ht.generateFreeID("t"),m=new le(p,Ht.getShape(a),Ht.getShape(l));return m.capacitystate="right",m.lineWidth=.5,Ht.addShape(p,m),Ht.draw(),!1},specialstatechangemax:()=>{var e=window.prompt("Insert the capacity of the state:",100);if(null!==e){var t=Math.floor(Number(e));t!==1/0&&String(t)===e&&t>=0?(e=parseInt(e),jt.activeShape.max=e):alert("Error with the input!\nThe capacity must be a number less or equal zero.")}},returncapacitytransitionsbystate:e=>{let t,a,s=[];for([t,a]of Ht.shMap)"t"===t.substring(0,1)&&a.source===e&&null!=a.capacitystate&&s.push(a);return s},returncapacitytransitionsbytransition:e=>{let t,a,s=[],n=e.target;for([t,a]of Ht.shMap)"t"===t.substring(0,1)&&a.source===n&&null!=a.capacitystate&&s.push(a);return s},returncapacitystatesbystate:e=>{let t,a,s=[];for([t,a]of Ht.shMap)"t"===t.substring(0,1)&&a.source===e&&null!=a.capacitystate&&s.push(a.target);return s},inserttransitionlimitreached:e=>{let t,a,s=!1;for([t,a]of Ht.shMap)"t"===t.substring(0,1)&&a.target===e&&(s=!0);return s},init:(e,t,a,s)=>{Ht=e,jt=t,Gt=a,Nt=s}};var Ft=Vt;const Ut={};Ut.help=n,Ut.symbols=l,Ut.alphabet="L",Ut.callback=ge.update,Ut.activeShape=null,Ut.selectionTransitionTarget=!1,Ut.selectionTransitionSource=!1,Ut.selectionTransitionFactor=!1,Ut.state="i",Ut.nameOld="",Ut.initState=()=>{let e="n",t=new d(e,0,0,0);ee.addShape(e,t);let a=78;t.nameAddChr(a),e=ee.generateFreeID("s"),t=new d(e,2*c.stateRadius,2*c.stateRadius),ee.addShape(e,t),a=Ut.symbols.L.C.S,t.nameAddChr(a)},Ut.init=()=>{c.canvas=document.getElementById("canvasID"),c.context=c.canvas.getContext("2d"),ee.init(c.canvas,c.stateRadius,c.hitTargetPadding,c.instancesLimit),fe.init(ee,Ut,c.instancesLimit,Kt,Ft),Kt.init(ee,Ut,c.specialArrowLimit),re.init(ee,Ut,fe,Ft,c.instancesLimit),Ft.init(ee,Ut,fe,c.instancesLimit),Rt.init(Ut,fe,re,Kt,o),Ut.helpBox=document.getElementById("helpID"),Ut.helpBox.innerHTML=Ut.help.i,F(c.canvas,Ut,re,Ft,fe,c.stateKeys,c.transitionKeys),Ut.initState(),ee.draw(),Ut.callback(ee.shMap)},Ut.systemStateActivate=(e,t)=>{null!=t&&t.activate(),Ut.nameOld=null!=t?t.name:"",Ut.activeShape=t,Ut.state=e,Ut.selectionTransitionFactor=!1,Ut.selectionTransitionSource=!1,Ut.selectionTransitionTarget=!1,Ut.alphabet="tr"===e?"G":"L",Ut.helpBox.innerHTML=Ut.help[e],Rt.systemupdate(e)},Ut.systemStateMouseDown=(e,t)=>{const a=ee.findShape(e,t);let s="i";if(null!=a){s=a.id.substring(0,1)+"m",a.moveStart(e,t);let n=Kt.returnstates(a);if(0!==n.length)for(let a=0;a<n.length;a++)n[a].moveStart(e,t)}"i"!==Ut.state&&Ut.activeShape.deactivate(),Ut.systemStateActivate(s,a),ee.draw()},Ut.moveStop=()=>{if(Ut.state.length>1&&"m"===Ut.state.substring(1,2)){Ut.activeShape.moveStop();let e=Kt.returnstates(Ut.activeShape);if(0!==e.length)for(let t=0;t<e.length;t++)e[t].moveStop();Ut.systemStateActivate(Ut.state.substring(0,1),Ut.activeShape)}},Ut.moveObject=e=>{Ut.activeShape.move(e.offsetX,e.offsetY);let t=Kt.returnstates(Ut.activeShape);if(0!==t.length)for(let a=0;a<t.length;a++)t[a].move(e.offsetX,e.offsetY);for(let e=0;e<t.length;e++)if(t[e].y<2){Ut.moveStop(),Ut.activeShape.move(Ut.activeShape.x,102),t[e].move(t[e].x,2);for(let e=0;e<t.length;e++)t[e].moveStop();Kt.arrangementstate()}else if(t[e].x<Ut.activeShape.radius){Ut.moveStop(),Ut.activeShape.move(Ut.activeShape.radius+102,Ut.activeShape.y);for(let e=0;e<t.length;e++)t[e].moveStop();Kt.arrangementstate()}if(ee.stateconflict(Ut.activeShape)){if(Ut.moveStop(),0!==t.length)for(let e=0;e<t.length;e++)t[e].moveStop();let e=0,a=0,s=1;for(;ee.stateconflict(Ut.activeShape);){for(;e<=s&&ee.stateconflict(Ut.activeShape);e++)if(Ut.activeShape.move(Ut.activeShape.x+e,Ut.activeShape.y+a),0!==t.length)for(let s=0;s<t.length;s++)t[s].move(t[s].x+e,t[s].y+a);for(;a<=s&&ee.stateconflict(Ut.activeShape);a++)if(Ut.activeShape.move(Ut.activeShape.x+e,Ut.activeShape.y+a),0!==t.length)for(let s=0;s<t.length;s++)t[s].move(t[s].x+e,t[s].y+a);for(s++;e>=-s&&ee.stateconflict(Ut.activeShape);e--)if(Ut.activeShape.move(Ut.activeShape.x+e,Ut.activeShape.y+a),0!==t.length)for(let s=0;s<t.length;s++)t[s].move(t[s].x+e,t[s].y+a);for(;a>=-s&&ee.stateconflict(Ut.activeShape);a--)if(Ut.activeShape.move(Ut.activeShape.x+e,Ut.activeShape.y+a),0!==t.length)for(let s=0;s<t.length;s++)t[s].move(t[s].x+e,t[s].y+a);s++}}ee.draw()};var zt=Ut;const Yt={};let Jt={},_t={},qt={},Wt={},Zt={};function Qt(e){const t=[],a=e.nameArr.length,s=e.source;let n,i,o,r=0;if(0===a)return t;for(t[0]=[],n=0;n<a;n+=1)[i,o]=e.nameArr[n],"o"===i?(t[r].push(["s",s]),r+=1,t[r]=[]):0!==o.radius?t[r].push([i,o]):t[r].push(["n",o]);return t[r].push(["s",s]),t}function ea(e){const t=[],a=e.nameArr.length;let s,n,i,o=0;if(0===a)return t;for(t[0]=[],s=0;s<a;s+=1)[n,i]=e.nameArr[s],"o"===n?(o+=1,t[o]=[]):0!==i.radius?t[o].push([n,i]):t[o].push(["n",i]);return t}function ta(e,t,a){let s;const n=t.length,i=_t.get(e);for(s=0;s<n;s+=1)i.push({sign:a,prod:t[s]})}function aa(e,t,a,s,n,i){let o,r,l,c;for([r,l]of s)"t"===r.substring(0,1)&&l.source===a.source&&"left"===l.capacitystate&&(c=l.target.id);i="right"===n?c:3;const d=t.length,h=_t.get(e),u=a.source;for([r,l]of s)"t"===r.substring(0,1)&&l.target===u&&(o=l.source);if(void 0!==o){t[0][1][1]=o;for(let e=0;e<d;e+=1)h.push({sign:i,prod:t[e]})}}Yt.odeBuild=e=>{let t,a,s;for([t,a]of(function(e){let t,a;for([t,a]of(_t=new Map,qt=[],Wt=new Map,Zt=new Map,e))if("t"===t.substring(0,1)&&"left"===a.capacitystate&&Zt.set(a.source.id,a.target.id),"s"===t.substring(0,1))if(void 0===a.max)_t.set(a,[]);else{let s,n;for([s,n]of(qt.push(a),e))"t"===s.substring(0,1)&&n.source===a&&void 0!==n.capacitystate&&Wt.set(n.target.id,t)}}(e),e))"t"===t.substring(0,1)&&(void 0===a.capacitystate?void 0!==a.type?(s=ea(a),"in"===a.type?ta(a.target,s,1):ta(a.source,s,-1)):void 0===a.target.max?(s=Qt(a),ta(a.source,s,-1),ta(a.target,s,1)):(s=Qt(a),ta(a.source,s,-1)):(s=Qt(a),aa(a.target,s,a,e,a.capacitystate,1)))},Yt.update=e=>{let t,a,s,n,i,o,r,l,c,d,h,u,p,m=0,f=0,b=[];const v=String.fromCodePoint(8339);for([n,i]of(Yt.odeBuild(e),t="<table>",_t))if("N"!==n.name){b.push(n.name),a="<tr><td align='right'>",a=n.nameArr.length>1?a+"("+n.name+")"+v:a+n.name+v,a+="</td>",a+="<td align='center'>=</td>",a+="<td align='left'><div class='odeEquation'>",o=i.length,p=!1;let g=!0;for(r=0;r<o;r+=1){if(f=0,s=i[r].sign<0?"‚Äì":p?"+":"",g&&"left"===n.capacitystate){let t,a;for([t,a]of(s+=String.fromCodePoint(119892),s+="(",e))"t"===t.substring(0,1)&&"left"===a.capacitystate&&a.target===n&&(s+=a.source.name);s+="-",s+=n.name,s+=")",g=!1}if(g&&"right"===n.capacitystate){let t,a,i,o;for([t,a]of(s+="(1-",s+=String.fromCodePoint(119892),s+="(",e))"t"===t.substring(0,1)&&"right"===a.capacitystate&&a.target===n&&(s+=a.source.name);for([i,o]of(s+="-",e))if("t"===i.substring(0,1)&&"right"===o.capacitystate&&o.target===n){let t,a;for([t,a]of e)"t"===t.substring(0,1)&&"left"===a.capacitystate&&a.source===o.source&&(s+=a.target.name)}s+="))",g=!1}for(l=i[r].prod,c=l.length,d=0;d<c;d+=1)[h,u]=l[d],"s"===h?(u=u.name,f++):u="n"===h?u.name:String.fromCodePoint(u),s+=u;if(f>1){switch(s+="N",s+=String.fromCodePoint(8315),f--,f){case 1:m=185;break;case 2:m=178;break;case 3:m=179;break;default:m=8304+f}s+=String.fromCodePoint(m)}a+=s,p=!0}p||(a+="0"),a+="</div></td></tr>",t+=a}a="<tr><td align='right'>N</td><td align='center'>=</td><td align='left'><div class='odeEquation'>";for(let e=0;e<b.length;e++)e>0&&(a+="+"),a+=b[e];a+="</div></td></tr>",t+=a,t+="</table>",Jt.innerHTML=t},Yt.init=e=>{Jt=e},Yt.getODEs=()=>_t,Yt.getcapacitystates=()=>qt,Yt.getlinktocapacitystate=()=>Wt,Yt.getlinktcstateleftstate=()=>Zt;var sa=Yt;var na=function(){const e={},t=sa.getODEs(),a=sa.getcapacitystates(),s=sa.getlinktocapacitystate(),n=sa.getlinktcstateleftstate();return e.states=function(e){const t=new Map;return e.forEach((e,a)=>{t.set(a.id,a.name)}),t}(t),e.rates=function(e){const t=new Set;return e.forEach(e=>{e.forEach(e=>{e.prod.forEach(e=>{"r"===e[0]&&t.add(String.fromCodePoint(e[1]))})})}),t}(t),e.equations=function(e){const t=new Map;return e.forEach((e,a)=>{const s=[];e.forEach(e=>{const t={};t.sign=e.sign,t.prod=[],e.prod.forEach(e=>{const a="r"===e[0]?[e[0],String.fromCodePoint(e[1])]:[e[0],e[1].id];t.prod.push(a)}),s.push(t)}),t.set(a.id,s)}),t}(t),e.capacitystates=function(e){const t=new Map;for(let a=0;a<e.length;a++)t.set(e[a].id,e[a].name);return t}(a),e.linktocapacitystate=s,e.linktcstateleftstate=n,e};const ia={init:()=>{sa.init(document.getElementById("odeID")),ge.addListener(sa.update),wt.setAlphabetHandler(Rt.letterIn),wt.setStateKeyHandler(fe.nameAppendState),wt.setSpecialKeyHandler("plus",fe.nameAppendPlus),wt.setSpecialKeyHandler("del",Rt.RemoveTolken),wt.setSpecialKeyHandler("check",Rt.check),wt.setSpecialKeyHandler("L",Rt.updateAlphabetL),wt.setSpecialKeyHandler("G",Rt.updateAlphabetG),wt.setSpecialKeyHandler("S",Rt.updateAlphabetS),wt.setSpecialKeyHandler("up",Rt.updateAlphabetup),wt.setSpecialKeyHandler("low",Rt.updateAlphabetlow),wt.setSpecialKeyHandler("Del",Rt.delete),wt.setSpecialKeyHandler("R",Rt.rename),wt.setSpecialKeyHandler("T",Rt.newTransition),wt.setSpecialKeyHandler("X",Rt.leaveX),wt.setSpecialKeyHandler("target",Rt.transitiontarget),wt.setSpecialKeyHandler("source",Rt.transitionsource),wt.setSpecialKeyHandler("in",Rt.arrowIn),wt.setSpecialKeyHandler("out",Rt.arrowOut),wt.setSpecialKeyHandler("checkenter",Rt.checkenter),wt.setSpecialKeyHandler("Deleteenter",Rt.Deleteenter),wt.setSpecialKeyHandler("Renter",Rt.Renter),wt.setSpecialKeyHandler("inenter",Rt.inenter),wt.setSpecialKeyHandler("outenter",Rt.outenter),wt.setSpecialKeyHandler("Genter",Rt.Genter),wt.setSpecialKeyHandler("Lenter",Rt.Lenter),wt.setSpecialKeyHandler("Senter",Rt.Senter),wt.setSpecialKeyHandler("upenter",Rt.upenter),wt.setSpecialKeyHandler("lowenter",Rt.lowenter),wt.setSpecialKeyHandler("Tenter",Rt.Tenter),wt.setSpecialKeyHandler("Xenter",Rt.Xenter),wt.setSpecialKeyHandler("targetenter",Rt.tagetenter),wt.setSpecialKeyHandler("sourceenter",Rt.sourceenter),wt.init(document.getElementById("inID"),ge),zt.init()}};ia.getODEs=na;var oa=ia;const ra={};function la(){const e=ra.board.create("point",[0,0],{needsRegularUpdate:!1,visible:!1}),t=ra.board.create("point",[1,0],{needsRegularUpdate:!1,visible:!1}),a=ra.board.create("axis",[e,t],{needsRegularUpdate:!1,name:"$t$",withLabel:!0,label:{position:"rt",offset:[-5,8]}});a.removeAllTicks();const s=ra.board.create("ticks",[a,1],{offset:[-10,-10],precision:5,minorTicks:0,drawLabels:!0,grid:!0,majorHeight:-1,strokeColor:"#ccc"});let n,i,o;s.ticksFunction=()=>n,ra.board.fullUpdate();let r=[];const l=ra.board.create("point",[0,0],{needsRegularUpdate:!1,visible:!1}),c=ra.board.create("point",[0,1],{needsRegularUpdate:!1,visible:!1}),d=ra.board.create("axis",[l,c],{needsRegularUpdate:!1,withLabel:!0,label:{position:"rt",offset:[-5,8]}});d.removeAllTicks();const h=ra.board.create("ticks",[d,1],{strokeColor:"#ccc",label:{offset:[10,0]},precision:8,minorTicks:0,drawLabels:!0,drawZero:!1,majorHeight:-1});h.ticksFunction=()=>i,ra.board.fullUpdate();const u=function(){o=ra.board.getBoundingBox();const e=10**Math.floor(Math.log10(.6*(o[2]-o[0])));n=(o[2]-o[0])/e>5?e:.5*e;const t=10**Math.floor(Math.log10(.6*(o[1]-o[3])));i=(o[1]-o[3])/t>5?t:.5*t,ra.board.fullUpdate()};u();const p=ra.board.create("point",[0,0],{visible:!1});ra.upperAxis=30,ra.lowerAxis=ra.board.canvasHeight-30,ra.board.on("boundingbox",()=>{console.time("Axis"),o=ra.board.getBoundingBox();const n=new JXG.Coords(JXG.COORDS_BY_USER,[0,p.Y()],ra.board).scrCoords[2],i=new JXG.Coords(JXG.COORDS_BY_USER,[0,p.X()],ra.board).scrCoords[1];var m;n<=10?(a.point1.setAttribute({frozen:!0}),a.point2.setAttribute({frozen:!0}),s.visProp.label.offset=[-10,-10]):n>ra.board.canvasHeight-10?(e.moveTo((m=ra.board.canvasHeight-10,r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,m],ra.board),r.usrCoords),0),t.moveTo((e=>(r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[ra.board.canvasWidth,e],ra.board),r.usrCoords))(ra.board.canvasHeight-10),0),a.point1.setAttribute({frozen:!0}),a.point2.setAttribute({frozen:!0}),s.visProp.label.offset=[-10,9]):(a.point1.setAttribute({frozen:!1}),a.point2.setAttribute({frozen:!1}),e.moveTo([0,ra.yPost(0)],0),t.moveTo([1,ra.yPost(0)],0),e.moveTo([0,0],0),t.moveTo([1,0],0),s.visProp.label.offset=[-10,-10]),i<10?(l.moveTo((e=>(r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,ra.board.canvasHeight],ra.board),r.usrCoords))(10),0),c.moveTo((e=>(r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,0],ra.board),r.usrCoords))(10),0),d.point1.setAttribute({frozen:!0}),d.point2.setAttribute({frozen:!0}),h.visProp.label.offset=[7,0]):i>ra.board.canvasWidth-10?(d.point1.setAttribute({frozen:!0}),d.point2.setAttribute({frozen:!0}),h.visProp.label.offset=[-28,0],h.visProp.label.align="right"):(d.point1.setAttribute({frozen:!1}),d.point2.setAttribute({frozen:!1}),l.moveTo([0,0],0),c.moveTo([0,1],0)),u(),console.timeEnd("Axis")}),ra.boardRestriction=!0,ra.yLogFunc=function(){console.time("yLog"),this.checked?(ra.board.setBoundingBox([-ra.tEnd.X()/10,.3,1.1*ra.tEnd.X(),-Math.log10(1/ra.eps)-1],!1),h.generateLabelText=(e,t)=>e.usrCoords[2]-t.usrCoords[2]<-Math.log10(1/ra.eps)?"":e.usrCoords[2]-t.usrCoords[2]<1-Math.log10(1/ra.eps)?"0":"$10^{"+Math.floor(e.usrCoords[2]-t.usrCoords[2])+"}$",ra.yPre=e=>e>Math.log10(ra.eps)?10**e:0,ra.yPost=e=>Math.abs(e)>ra.eps?Math.log10(Math.abs(e)):Math.log10(ra.eps),ra.move=e=>e>ra.eps?Math.log10(e):Math.log10(ra.eps),ra.boardRestriction=!1,ra.board.highlightInfobox=function(e,t,a){t<=-Math.log10(1/ra.eps)?ra.board.infobox.setText(" ("+e+",0)"):ra.board.infobox.setText(" ("+e+" , $"+(10**t*10**Math.ceil(-t-1)%1*10).toFixed(2)+"\\cdot 10^{"+Math.ceil(-t)+"}$)")}):(ra.board.setBoundingBox([-ra.tEnd.X()/10,1.2,1.1*ra.tEnd.X(),-.1],!1),h.generateLabelText=function(e,t){return e.usrCoords[2]-t.usrCoords[2]},ra.yPost=e=>e,ra.yPre=e=>e,ra.move=e=>e>Math.log10(ra.eps)?10**e:0,ra.boardRestriction=!0,ra.board.highlightInfobox=function(e,t,a){ra.board.infobox.setText("("+e+", "+t+")")}),ra.board.fullUpdate(),u(),console.timeEnd("yLog")},window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},jax:["input/TeX","output/HTML-CSS"],svg:{fontCache:"global"},startup:{promise:new Promise((function(e,t){setTimeout(()=>e(1),100)}))}},(()=>{const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js",e.async=!0,document.head.appendChild(e)})(),ra.promise=new Promise((e,t)=>{setTimeout(()=>e(1),100)}),ra.typeset=function(e){return window.MathJax.startup.promise=window.MathJax.startup.promise.then(()=>(e(),window.MathJax.typesetPromise())).catch(e=>console.log("Typeset failed: "+e.message)),window.MathJax.startup.promise},ra.eps=1e-12,ra.yPre=e=>e,ra.yPost=e=>e,ra.move=e=>e>Math.log10(ra.eps)?10**e:0,$("#plotID").mouseenter(()=>{ra.helpID=$("#helpID").html(),$("#helpID").html("Scroll to zoom in and out. Hold <b>SHIFT</b> to pan.<br>To change interventions either drag them or hold <b>SHIFT</b> and click to enter coordinates directly. <br>Press <b>+</b> button to add an intervention and press <b>&#8211</b> button to remove last intervention.Switch <b>Log</b> checkbox to switch y-axis to logarithmic scale.<br>Press any checkbox in the <b>legend</b> to hide corresponding function graph.<br>")}),$("#plotID").mouseleave(()=>{$("#helpID").html(ra.helpID)}),$("#ratesID").mouseenter(()=>{ra.helpID=$("#helpID").html(),$("#helpID").html("Values can be adjusted by either directly changing the numerical value or by scrolling/ dragging the graph .<br>Click on intervention tab to view corresponding rates .<br>")}),$("#ratesID").mouseleave(()=>{$("#helpID").html(ra.helpID)}),$("#statesID").mouseenter(()=>{ra.helpID=$("#helpID").html(),$("#helpID").html("Values can be adjusted by either directly changing the numerical value or by scrolling/ dragging the graph .<br>")}),$("#statesID").mouseleave(()=>{$("#helpID").html(ra.helpID)}),$("#GraphButtons").html('<span float="right" class="slider-checkbox"><input type="checkbox" id="logY" /><label class="label" for="logY"></label><button class="button" id="button">+</button>&nbsp<button class="button" id="button2">&#8211</button>&nbsp<span float="right" class="slider-checkbox"><input type="checkbox" id="slidersum" /><label class="label" for="slidersum"></label>')}function ca(){!function(){const e=ra.board.create("line",[[0,0],[1,0]],{visible:!1});ra.tEnd=ra.board.create("glider",[200,0,e],{name:"$t_{\\infty}$",color:"black"}),ra.board.setBoundingBox([-ra.tEnd.X()/10,1.2,1.1*ra.tEnd.X(),-.1],!1),ra.tEnd.on("up",(function(e){const t=this;ra.promise=ra.promise.then(()=>{if(e.shiftKey&&null==ra.input){const e=ra.board.getBoundingBox();ra.typeset(()=>{ra.input=ra.board.create("text",[(e[2]+e[0])/2.5,(e[1]+e[3])/2,'<div id="inputID"><p>Enter Value of $t_\\\\infty$</p><br><input type="float" id="xValue" required value='+t.X()+'><br><br><button class="button" id="Accept">Accept</button></div>'],{fixed:!0,highlight:!1})}).then(()=>{$("#Accept").click(()=>{t.moveTo([$("#xValue").val(),0]),ra.board.removeObject(ra.input),ra.input=null,ra.plotCurves(),ra.board.setBoundingBox([-ra.tEnd.X()/10,e[1],1.1*ra.tEnd.X(),e[3]],!1)})})}ra.plotCurves();const a=ra.board.getBoundingBox();return ra.board.setBoundingBox([-ra.tEnd.X()/10,a[1],1.1*ra.tEnd.X(),a[3]],!1),new Promise((function(e,t){setTimeout(()=>e(1),100)}))})}))}(),function(){function e(e){return e<=ra.eps?Math.log10(ra.eps):1===e?Math.log10(1+ra.eps):Math.log10(e)}function t(e){return e<=Math.log10(ra.eps)?0:10**e}function a(){let e=0;return Object.keys(ra.states).forEach(a=>{e+=t(ra.states[a].point.X())}),0===e&&(e=1),e}function s(){let e=0;for(var t in ra.data.states)e+=ra.data.states[t].value;return 0===e&&(e=1),e}ra.saveStates=()=>{ra.data.states={},Object.keys(ra.states).forEach(e=>{ra.data.states[e]={},ra.data.states[e].value=ra.states[e].getValue(),ra.data.states[e].name=ra.states[e].name})},ra.savecapacityStates=()=>{ra.data.capacitystates={},Object.keys(ra.capacitystates).forEach(e=>{ra.data.capacitystates[e]={},ra.data.capacitystates[e].value=ra.capacitystates[e].getValue(),ra.data.capacitystates[e].name=ra.capacitystates[e].name})},ra.saveInterventions=()=>{ra.data.interventions={},Object.keys(ra.interventions).forEach(e=>{ra.data.interventions[e]=ra.interventions[e].getValue()})},ra.saveRates=()=>{ra.data.rates={},Object.keys(ra.rates).forEach(e=>{ra.data.rates[e]={},Object.keys(ra.interventions).forEach(t=>{ra.data.rates[e][t]=ra.rates[e][t].getValue()})})},ra.save=()=>{ra.saveStates(),ra.savecapacityStates(),ra.saveRates(),ra.saveInterventions()},ra.loadStates=()=>{ra.statesMap={},ra.board.suspendUpdate(),Object.values(ra.states).forEach(e=>{ra.board.removeObject(e.plotPoint),JXG.JSXGraph.freeBoard(e.board)}),Object.values(ra.curves).forEach(e=>{ra.board.removeObject(e)}),ra.board.removeObject(ra.labels),ra.board.unsuspendUpdate(),ra.states={};for(let e=0;e<Object.keys(ra.data.states).length;e++)ra.statesMap[Object.keys(ra.data.states)[e]]=e;const n=ra.board.create("line",[()=>-1*ra.interventions.t0.getValue(),()=>1,()=>0],{visible:!1});$("#statesID").empty(),$("#statesID").append("<table>"),document.getElementById("statesID").style.display="block",Object.keys(ra.data.states).forEach(i=>{ra.states[i]={},ra.states[i].name=ra.data.states[i].name,$("#statesID").append('<tr><td><div class="stateName" >'+ra.states[i].name+'(0) = </div></td><td><div contenteditable="true" class="stateText"  id= "text'+i+'">'+(ra.data.states[i].value<ra.eps?(0).toExponential(3):ra.data.states[i].value.toExponential(3))+'</div></td><td><div class="stateBoard" tabindex="1" id= "board'+i+'"></div></td></tr>'),ra.states[i].board=JXG.JSXGraph.initBoard("board"+i,{axis:!1,maxboundingbox:[-1/0,1/0,1/0,-1/0],showCopyright:!1,showNavigation:!1,showInfobox:!1,highlight:!1,highlightInfobox:!1,pan:{enabled:!0,needshift:!1},zoom:{factorX:1.05,factorY:1,wheel:!0,needshift:!1,eps:.01}}),ra.states[i].point=ra.states[i].board.create("point",[e(ra.data.states[i].value),0],{name:ra.data.states[i].name,visible:!0,highlight:!1,highlightInfobox:!1,label:{offset:[0,-25]},color:ra.colors[ra.statesMap[i]],fixed:!0,showInfobox:!1}),ra.states[i].board.setBoundingBox([e(ra.data.states[i].value)-2,.1,e(ra.data.states[i].value)+2,-.1]),ra.states[i].point.setAttribute({frozen:!0}),ra.states[i].getValue=function(){return t(this.point.X())};const o=ra.states[i].board.create("axis",[[0,0],[1,0]]);o.removeAllTicks(),ra.states[i].board.create("ticks",[o,1],{drawLabels:!0,minorTicks:0,drawZero:!0,generateLabelText:(e,t)=>e.usrCoords[1]-t.usrCoords[1]<=-12?0:"$10^{"+1*Math.floor(e.usrCoords[1]-t.usrCoords[1])+"}$"}),ra.states[i].plotPoint=ra.board.create("glider",[0,t(ra.states[i].point.X())/s(),n],{color:ra.colors[ra.statesMap[i]],name:ra.data.states[i].name+"(0)",label:{autoPosition:!0,visible:!1},showInfobox:!1,highlight:!1,fixed:!0}),ra.states[i].board.on("boundingbox",()=>{const e=ra.states[i].board.getBoundingBox();ra.states[i].board.setBoundingBox([e[2]-4,.1,e[2],-.1]);ra.states[i].getValue()<=ra.eps?document.getElementById("text"+i).innerHTML=(0).toExponential(3):document.getElementById("text"+i).innerHTML=ra.states[i].getValue().toExponential(3),Object.keys(ra.states).forEach(e=>{ra.states[e].plotPoint.setPositionDirectly(JXG.COORDS_BY_USER,[0,ra.yPost(t(ra.states[e].point.X())/a())])}),ra.plotCurves()}),$(document).focusout("#text"+i,()=>{"block"===$("#statesID").css("display")&&(Object.keys(ra.states).forEach(e=>{ra.states[e].plotPoint.setPositionDirectly(JXG.COORDS_BY_USER,[0,ra.yPost(parseFloat($("#text"+e).text())/a())])}),ra.states[i].board.setBoundingBox([e(parseFloat($("#text"+i).text()))-2,.1,e(parseFloat($("#text"+i).text()))+2,-.1]))})}),$("#statesID").append("</table>"),document.getElementById("statesID").style.display="none",ra.curves={},Object.keys(ra.data.states).forEach(e=>{ra.curves[e]=ra.board.create("curve",[0,0],{strokeColor:ra.colors[ra.statesMap[e]],name:ra.data.states[e].name+"(t)",highlight:!1}),ra.curves.n=ra.board.create("curve",[0,0],{strokeColor:"black",name:"N(t)",highlight:!1})}),ra.setLegend(),ra.setLegendFunction()},ra.loadcstates=()=>{if(ra.capacitystatesMap={},ra.board.suspendUpdate(),Object.values(ra.capacitystates).forEach(e=>{ra.board.removeObject(e.plotPoint),ra.board.removeObject(e.capacityline.point1),ra.board.removeObject(e.capacityline.point2),ra.board.removeObject(e.capacityline),JXG.JSXGraph.freeBoard(e.board)}),ra.board.removeObject(ra.labels),ra.board.unsuspendUpdate(),ra.capacitystates={},void 0!==ra.data.capacitystates)for(let e=0;e<Object.keys(ra.data.capacitystates).length;e++)ra.capacitystatesMap[Object.keys(ra.data.capacitystates)[e]]=e;const n=ra.board.create("line",[()=>-1*ra.interventions.t0.getValue(),()=>1,()=>0],{visible:!1});if($("#cstatesID").empty(),$("#cstatesID").append("<table>"),document.getElementById("cstatesID").style.display="block",void 0!==ra.data.capacitystates&&Object.keys(ra.data.capacitystates).forEach(i=>{ra.capacitystates[i]={},ra.capacitystates[i].name=ra.data.capacitystates[i].name,$("#cstatesID").append('<tr><td><div class="stateName" >'+ra.capacitystates[i].name+' = </div></td><td><div contenteditable="true" class="stateText"  id= "text'+i+'">'+(ra.data.capacitystates[i].value<ra.eps?(0).toExponential(3):ra.data.capacitystates[i].value.toExponential(3))+'</div></td><td><div class="stateBoard" tabindex="1" id= "board'+i+'"></div></td></tr>'),ra.capacitystates[i].board=JXG.JSXGraph.initBoard("board"+i,{axis:!1,maxboundingbox:[-1/0,1/0,1/0,-1/0],showCopyright:!1,showNavigation:!1,showInfobox:!1,highlight:!1,highlightInfobox:!1,pan:{enabled:!0,needshift:!1},zoom:{factorX:1.05,factorY:1,wheel:!0,needshift:!1,eps:.01}}),ra.capacitystates[i].point=ra.capacitystates[i].board.create("point",[e(ra.data.capacitystates[i].value),0],{name:ra.data.capacitystates[i].name,visible:!0,highlight:!1,highlightInfobox:!1,label:{offset:[0,-25]},color:ra.capacitycolors[ra.capacitystatesMap[i]],fixed:!0,showInfobox:!1}),ra.capacitystates[i].board.setBoundingBox([e(ra.data.capacitystates[i].value)-2,.1,e(ra.data.capacitystates[i].value)+2,-.1]),ra.capacitystates[i].point.setAttribute({frozen:!0}),ra.capacitystates[i].getValue=function(){return t(this.point.X())};const o=ra.capacitystates[i].board.create("axis",[[0,0],[1,0]]);o.removeAllTicks(),ra.capacitystates[i].board.create("ticks",[o,1],{drawLabels:!0,minorTicks:0,drawZero:!0,generateLabelText:(e,t)=>e.usrCoords[1]-t.usrCoords[1]<=-12?0:"$10^{"+1*Math.floor(e.usrCoords[1]-t.usrCoords[1])+"}$"}),ra.capacitystates[i].plotPoint=ra.board.create("glider",[0,t(ra.capacitystates[i].point.X())/s(),n],{color:ra.capacitycolors[ra.capacitystatesMap[i]],name:ra.data.capacitystates[i].name+"(0)",label:{autoPosition:!0,visible:!1},showInfobox:!1,highlight:!1,fixed:!0,size:2}),ra.capacitystates[i].capacityline=ra.board.create("line",[[ra.interventions.t0.getValue(),t(ra.capacitystates[i].point.X())/s()],[ra.tEnd.X(),t(ra.capacitystates[i].point.X())/s()]],{straightFirst:!1,straightLast:!1,strokeWidth:.5,color:ra.capacitycolors[ra.capacitystatesMap[i]],dash:4,highlight:!1}),ra.capacitystates[i].board.on("boundingbox",()=>{const e=ra.capacitystates[i].board.getBoundingBox();ra.capacitystates[i].board.setBoundingBox([e[2]-4,.1,e[2],-.1]);ra.capacitystates[i].getValue()<=ra.eps?document.getElementById("text"+i).innerHTML=(0).toExponential(3):document.getElementById("text"+i).innerHTML=ra.capacitystates[i].getValue().toExponential(3),Object.keys(ra.capacitystates).forEach(e=>{ra.capacitystates[e].plotPoint.setPositionDirectly(JXG.COORDS_BY_USER,[0,ra.yPost(t(ra.capacitystates[e].point.X())/a())]),ra.capacitystates[e].capacityline.point1.setPositionDirectly(JXG.COORDS_BY_USER,[ra.interventions.t0.getValue(),ra.yPost(t(ra.capacitystates[e].point.X())/a())]),ra.capacitystates[e].capacityline.point2.setPositionDirectly(JXG.COORDS_BY_USER,[ra.tEnd.X(),ra.yPost(t(ra.capacitystates[e].point.X())/a())])}),ra.plotCurves()}),$(document).focusout("#text"+i,()=>{"block"===$("#cstatesID").css("display")&&(Object.keys(ra.capacitystates).forEach(e=>{ra.capacitystates[e].plotPoint.setPositionDirectly(JXG.COORDS_BY_USER,[0,ra.yPost(parseFloat($("#text"+e).text())/a())]),ra.capacitystates[e].capacityline.point1.setPositionDirectly(JXG.COORDS_BY_USER,[ra.interventions.t0.getValue(),ra.yPost(parseFloat($("#text"+e).text())/a())]),ra.capacitystates[e].capacityline.point2.setPositionDirectly(JXG.COORDS_BY_USER,[ra.tEnd.X(),ra.yPost(parseFloat($("#text"+e).text())/a())])}),ra.capacitystates[i].board.setBoundingBox([e(parseFloat($("#text"+i).text()))-2,.1,e(parseFloat($("#text"+i).text()))+2,-.1]))})}),$("#cstatesID").append("</table>"),document.getElementById("cstatesID").style.display="none",ra.setLegend(),ra.setLegendFunction(),0!==Object.keys(ra.capacitystates).length){let e="",t=!0;Object.keys(ra.capacitystates).forEach(a=>{void 0===ra.selectedfunction[a]&&(ra.capacityfunction[ra.linktcstateleftstate[a]]=function(e,t){return 1-Math.exp(-e*e*1/t)},ra.selectedfunction[a]=[],ra.selectedfunction[a].expfct=!0,ra.selectedfunction[a].sqrfct=!1,ra.selectedfunction[a].arctanfct=!1),e+="<option value =",e+=a,t&&(e+=" selected",t=!1),e+=">",e+=ra.capacitystates[a].name,e+="</option>"}),$("#cstatesID").append('<div style="font-family:\'Arial\'; font-size:15px">Choose the fitting function for the state:<select id="cselect">'+e+'</select> </div><div><input type="checkbox" id="expfct" checked><label for="expfct" style="font-family:\'Arial\'; font-size:15px; margin-right: 6px;">Exp</label><input type="checkbox" id="sqrfct"><label for="sqrfct" style="font-family:\'Arial\'; font-size:15px; margin-right: 6px;">Sqr</label><input type="checkbox" id="arctanfct"><label for="arctanfct" style="font-family:\'Arial\'; font-size:15px; margin-right: 6px;">Arctan</label></div>'),document.getElementById("expfct").addEventListener("click",(function(){document.getElementById("expfct").checked=!0,document.getElementById("sqrfct").checked=!1,document.getElementById("arctanfct").checked=!1,ra.selectedfunction[document.getElementById("cselect").value].expfct=!0,ra.selectedfunction[document.getElementById("cselect").value].sqrfct=!1,ra.selectedfunction[document.getElementById("cselect").value].arctanfct=!1,ra.capacityfunction[ra.linktcstateleftstate[document.getElementById("cselect").value]]=function(e,t){return 1-Math.exp(-e*e*1/t)},ra.plotCurves()})),document.getElementById("sqrfct").addEventListener("click",(function(){document.getElementById("expfct").checked=!1,document.getElementById("sqrfct").checked=!0,document.getElementById("arctanfct").checked=!1,ra.selectedfunction[document.getElementById("cselect").value].expfct=!1,ra.selectedfunction[document.getElementById("cselect").value].sqrfct=!0,ra.selectedfunction[document.getElementById("cselect").value].arctanfct=!1,ra.capacityfunction[ra.linktcstateleftstate[document.getElementById("cselect").value]]=function(e,t){return 1-1/Math.sqrt(1+e*e*1/t)},ra.plotCurves()})),document.getElementById("arctanfct").addEventListener("click",(function(){document.getElementById("expfct").checked=!1,document.getElementById("sqrfct").checked=!1,document.getElementById("arctanfct").checked=!0,ra.selectedfunction[document.getElementById("cselect").value].expfct=!1,ra.selectedfunction[document.getElementById("cselect").value].sqrfct=!1,ra.selectedfunction[document.getElementById("cselect").value].arctanfct=!0,ra.capacityfunction[ra.linktcstateleftstate[document.getElementById("cselect").value]]=function(e,t){return 1-1/(1+Math.atan(e)*Math.atan(e))},ra.plotCurves()})),document.getElementById("cselect").addEventListener("change",(function(){let e;for(e in ra.selectedfunction[document.getElementById("cselect").value])document.getElementById(e).checked=ra.selectedfunction[document.getElementById("cselect").value][e]})),Object.keys(ra.capacitystates).forEach(e=>{let t;for(t in ra.selectedfunction[e])ra.selectedfunction[e][t]&&(document.getElementById("cselect").value=e,document.getElementById(t).click())})}},ra.loadInterventions=()=>{ra.board.suspendUpdate(),Object.values(ra.interventions).forEach(e=>{ra.board.removeObject(e.line.point1),ra.board.removeObject(e.line.point2),ra.board.removeObject(e.line),ra.board.removeObject(e.point)}),ra.board.unsuspendUpdate(),ra.board.update(),ra.interventions={};const t=ra.board.create("line",[[0,0],[1,0]],{visible:!1});$("#tabtab3ID").empty(),Object.keys(ra.data.interventions).forEach(a=>{ra.interventions[a]={},ra.interventions[a].point=ra.board.create("glider",[ra.data.interventions[a],0,t],{color:"black",visible:!0,name:"$t_{"+a.substring(1)+"}$"}),ra.interventions[a].line=ra.board.create("line",[[()=>ra.interventions[a].point.X(),0],[()=>ra.interventions[a].point.X(),1]],{color:"lightGrey",visible:!0}),ra.interventions[a].point.on("up",(function(e){const t=this;ra.promise=ra.promise.then(()=>{if(e.shiftKey&&null==ra.input){const e=ra.board.getBoundingBox();ra.typeset(()=>{ra.input=ra.board.create("text",[(e[2]+e[0])/2.5,(e[1]+e[3])/2,'<div id="inputID"><p>Enter Value of $t$<sub>'+a.substring(1,2)+'</sub></p><br><input type="float" id="xValue" required value='+t.X()+'><br><br><button class="button" id="Accept">Accept</button></div>'],{fixed:!0,highlight:!1})}).then(()=>{$("#Accept").click(()=>{t.moveTo([$("#xValue").val(),0]),ra.board.removeObject(ra.input),ra.input=null,ra.plotCurves()})})}return ra.plotCurves(),new Promise((function(e,t){setTimeout(()=>e(1),100)}))})})),ra.interventions[a].getValue=function(){return this.point.X()},$("#tabtab3ID").append('<button id = "button'+a+'">t<sub>'+a.substring(1)+"</sub></button>"),$("#button"+a).click(()=>{ra.activeIntervention=a,$("#tabtab3ID").children().removeClass("active"),$("#button"+a).addClass("active"),Object.keys(ra.rates).forEach(t=>{Object.keys(ra.interventions).forEach(e=>{ra.rates[t][e].point.setAttribute({visible:!1,frozen:!1})}),ra.rates[t].board.setBoundingBox([e(ra.rates[t][a].getValue())-2,.1,e(ra.rates[t][a].getValue())+2,-.1]),ra.rates[t][a].point.setAttribute({visible:!0,frozen:!0})})})}),ra.interventions.t0.line.setAttribute({visible:!1}),$("#buttont0").addClass("active"),ra.activeIntervention="t0"},ra.loadRates=()=>{ra.rates={},$("#ratesID").empty(),$("#ratesID").append("<table>"),document.getElementById("ratesID").style.display="block",Object.keys(ra.data.rates).forEach(a=>{ra.rates[a]={},$("#ratesID").append('<tr><td><div class="rateName" >'+a+'= </div></td><td><div contenteditable="true" class="rateText"  id= "text'+a+'">'+ra.data.rates[a].t0+'</div></td><td><div class="rateBoard"  id= "board'+a+'"></div></td></tr>'),ra.rates[a].board=JXG.JSXGraph.initBoard("board"+a,{axis:!1,maxboundingbox:[-1/0,1/0,1/0,-1/0],boundingbox:[-.6,.1,1,-.1],showCopyright:!1,showNavigation:!1,showInfobox:!1,highlight:!1,pan:{enabled:!0,needshift:!1},zoom:{factorX:1.05,factorY:1,wheel:!0,needshift:!1,eps:.01}});const s=ra.rates[a].board.create("axis",[[0,0],[1,0]]);s.removeAllTicks(),ra.rates[a].board.create("ticks",[s,1],{drawLabels:!0,minorTicks:0,drawZero:!0,generateLabelText:(e,t)=>e.usrCoords[1]-t.usrCoords[1]<=-12?0:"$10^{"+1*Math.floor(e.usrCoords[1]-t.usrCoords[1])+"}$"}),Object.keys(ra.data.rates[a]).forEach(s=>{ra.rates[a][s]={},ra.rates[a][s].point=ra.rates[a].board.create("point",[e(ra.data.rates[a][s]),0],{name:a,visible:!1,label:{offset:[0,-25]},color:"black",fixed:!0,showInfobox:!1,highlight:!1}),ra.rates[a][s].getValue=function(){return t(this.point.X())},ra.rates[a].board.on("boundingbox",()=>{const e=ra.rates[a].board.getBoundingBox();ra.rates[a].board.setBoundingBox([e[2]-4,.1,e[2],-.1]);ra.rates[a][ra.activeIntervention].getValue()<=ra.eps?document.getElementById("text"+a).innerHTML=(0).toExponential(3):document.getElementById("text"+a).innerHTML=ra.rates[a][ra.activeIntervention].getValue().toExponential(3),ra.plotCurves()}),$(document).focusout("#text"+a,()=>{"block"===$("#ratesID").css("display")&&ra.rates[a].board.setBoundingBox([e(parseFloat($("#text"+a).text()))-2,.1,e(parseFloat($("#text"+a).text()))+2,-.1])})})}),$("#ratesID").append("</table>"),Object.keys(ra.data.rates).forEach(t=>{ra.rates[t].board.setBoundingBox([e(ra.data.rates[t].t0)-2,.1,e(ra.data.rates[t].t0)+2,-.1]),ra.rates[t].t0.point.setAttribute({visible:!0,frozen:!0})})}}(),ra.data.states={},ra.data.states.s0={},ra.data.states.s0.name="S",ra.data.states.s0.value=1e3,ra.data.interventions={},ra.data.interventions.t0=0,ra.data.rates={},ra.load()}function da(){$("#button").click(()=>{console.time("addIntervention"),ra.save(),ra.data.interventions["t"+Object.keys(ra.data.interventions).length]=ra.data.interventions["t"+(Object.keys(ra.data.interventions).length-1)]+10,Object.keys(ra.data.rates).forEach(e=>{ra.data.rates[e]["t"+Object.keys(ra.data.rates[e]).length]=ra.data.rates[e]["t"+(Object.keys(ra.data.rates[e]).length-1)]}),ra.load(),console.timeEnd("addIntervention"),ra.plotCurves()}),$("#button2").click(()=>{console.time("removeIntervention"),ra.save(),Object.keys(ra.data.interventions).length>=2&&(delete ra.data.interventions["t"+(Object.keys(ra.data.interventions).length-1)],Object.keys(ra.data.rates).forEach(e=>{delete ra.data.rates[e]["t"+Object.keys(ra.data.interventions).length]})),ra.load(),console.timeEnd("removeIntervention"),ra.plotCurves()}),$("#slidersum").change(()=>{ra.plotCurves()}),$("#logY").change((function(){ra.yLogFunc.call(this),Object.keys(ra.states).forEach(e=>{ra.states[e].plotPoint.moveTo([ra.states[e].plotPoint.X(),ra.move(ra.states[e].plotPoint.Y())])}),ra.plotCurves()}))}ra.curves={},ra.data={},ra.states={},ra.capacitystates={},ra.linktocapacitystate={},ra.linktcstateleftstate={},ra.capacityfunction={},ra.selectedfunction={},ra.rates={},ra.statesMap={},ra.capacitystatesMap={},ra.interventions={},ra.load=()=>{$("#ratesID").show(),$("#tab3ID").show(),$("#statesID").hide(),$("#cstatesID").hide(),ra.loadInterventions(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#statesID").show(),$("#cstatesID").show(),ra.loadStates(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#statesID").show(),$("#cstatesID").show(),ra.loadcstates(),$("#ratesID").show(),$("#tab3ID").show(),$("#statesID").hide(),$("#cstatesID").hide(),ra.loadRates(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#statesID").show(),$("#cstatesID").show(),$("#Values").addClass("active"),$("#Rates").removeClass("active")},ra.update=()=>{ra.save();const e=oa.getODEs();e.states.forEach((e,t)=>{Object.keys(ra.data.states).includes(t)?ra.data.states[t].name!==e&&(ra.data.states[t].name=e):(ra.data.states[t]={},ra.data.states[t].name=e,ra.data.states[t].value=0)}),Object.keys(ra.data.states).forEach(t=>{e.states.has(t)||delete ra.data.states[t]}),e.rates.forEach(e=>{Object.keys(ra.data.rates).includes(e)||(ra.data.rates[e]={},Object.keys(ra.data.interventions).forEach(t=>{ra.data.rates[e][t]=.1}))}),Object.keys(ra.data.rates).forEach(t=>{e.rates.has(t)||delete ra.data.rates[t]}),e.capacitystates.forEach((e,t)=>{Object.keys(ra.data.capacitystates).includes(t)?ra.data.capacitystates[t].name!==e&&(ra.data.capacitystates[t].name=e):(ra.data.capacitystates[t]={},ra.data.capacitystates[t].name=e,ra.data.capacitystates[t].value=100)}),e.linktocapacitystate.forEach((e,t)=>{ra.linktocapacitystate[t]=e}),e.linktcstateleftstate.forEach((e,t)=>{ra.linktcstateleftstate[t]=e}),Object.keys(ra.data.capacitystates).forEach(t=>{e.capacitystates.has(t)||delete ra.data.capacitystates[t]}),ra.load(),ra.plotCurves()},ra.pointArray=[],ra.interventionArray=[],ra.colors=["red","blue","green","purple","orange","gray","pink","yellow","teal","Brown","BlueViolet","CadetBlue","Chartreuse","Chocolate","CornflowerBlue","Coral","Crimson","Cyan","DarkMagenta","DarkGreen"],ra.capacitycolors=["Fuchsia","Lime","Indigo","Khaki","Magenta","Maroon","Navy","Olive"],ra.setLegend=()=>{let e="",t="<br>";e+=" .switch { position: relative; display: inline-block; width: 30px; height: 18px;}",e+=".switch input {opacity: 0;width: 0;height: 0;}",e+=".slidern {position: absolute; cursor: pointer;top: 0;left: 0;right: 0;bottom: 0;background-color: #ccc;-webkit-transition: 0.4s;transition: 0.4s;}",e+='.slidern:before {position: absolute;content: ""; height: 13px; width: 13px; left: 2px;bottom: 2px; background-color: white;-webkit-transition: 0.4s;transition: 0.4s;}',e+="input:checked + .slidern {background-color:",e+="black",e+=";}",e+="input:focus + .slidern {box-shadow: 0 0 1px grey;}",e+="input:checked + .slidern:before {-webkit-transform: translateX(13px); -ms-transform: translateX(13px); transform: translateX(13px);}",e+=".slidern.round {border-radius: 17px;}",e+=".slidern.round:before {border-radius: 50%;}",t+='<label class="switch">',t+='<input type="checkbox" id="checkn" name="checkn" checked> n',t+='<span class="slidern round"></span></label><span> ',t+="N",t+="(t)  &nbsp&nbsp</span><br>",Object.keys(ra.curves).forEach(a=>{"n"!==a&&(e+=".slider"+a+" {position: absolute; cursor: pointer;top: 0;left: 0;right: 0;bottom: 0;background-color: #ccc;-webkit-transition: 0.4s;transition: 0.4s;}",e+=".slider"+a+':before {position: absolute;content: ""; height: 13px; width: 13px; left: 2px;bottom: 2px; background-color: white;-webkit-transition: 0.4s;transition: 0.4s;}',e+="input:checked + .slider"+a+" {background-color:",e+="n"===a?"black":ra.colors[ra.statesMap[a]],e+=";}",e+="input:focus + .slider"+a+" {box-shadow: 0 0 1px "+ra.colors[ra.statesMap[a]]+";}",e+="input:checked + .slider"+a+":before {-webkit-transform: translateX(13px); -ms-transform: translateX(13px); transform: translateX(13px);}",e+=".slider"+a+".round {border-radius: 17px;}",e+=".slider"+a+".round:before {border-radius: 50%;}",t+='<label class="switch">',t+='<input type="checkbox" id="check'+a+'" name="check'+a+'" checked> '+a,t+='<span class="slider'+a+' round"></span></label><span> ',t+="n"===a?"N":ra.states[a].name,t+="(t)  &nbsp&nbsp</span><br>")});const a=document.createElement("style");a.type="text/css",a.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(a);const s=ra.board.getBoundingBox();ra.labels=ra.board.create("text",[s[2],(s[1]+s[3])*(.55+.03*Object.keys(ra.curves).length),t],{frozen:!0,fontSize:18,fixed:!0,visible:!0,anchorX:"right",anchorY:"top",highlight:!1})},ra.setLegendFunction=()=>{Object.keys(ra.curves).forEach(e=>{$("#check"+e).on("click",(function(){this.checked?ra.curves[e].setAttribute({visible:!0}):ra.curves[e].setAttribute({visible:!1})}))})};var ha=function(){da()};var ua=function(){console.time("Ode");const e=oa.getODEs(),t={};function a(e){return Object.keys(ra.interventions).includes("t"+(1+parseInt(e.substring(1),10)))?ra.interventions["t"+(1+parseInt(e.substring(1),10))].getValue():ra.tEnd.X()}ra.delta=20,Object.keys(ra.interventions).forEach(a=>{t[a]=function(t){return function(a,s){const n=s.map(()=>0);let i,o=0;e.equations.forEach((e,t)=>{o+=s[ra.statesMap[t]]});var r=ra.capacityfunction;return e.equations.forEach((e,a)=>{e.forEach(e=>{i=!1;let l=e.sign>0?1:-1;1!==e.sign&&-1!==e.sign&&3!==e.sign?l=1-r[e.sign](ra.capacitystates[ra.linktocapacitystate[a]].getValue()-s[ra.statesMap[e.sign]],o):3===e.sign&&(l=r[a](ra.capacitystates[ra.linktocapacitystate[a]].getValue()-s[ra.statesMap[a]],o)),e.prod.forEach(e=>{"r"===e[0]?l*=ra.rates[e[1]][t].getValue():"n"===e[0]?l*=o:(i?(l*=s[ra.statesMap[e[1]]],l/=o):l*=s[ra.statesMap[e[1]]],i=!0)}),n[ra.statesMap[a]]+=l})}),n}}(a)});let s=[[]];e.states.forEach((e,t)=>{s[0][ra.statesMap[t]]=ra.states[t].getValue()}),Object.keys(ra.interventions).sort((e,t)=>e.substring(1)<t.substring(1)?-1:1).forEach(e=>{s=s.concat(JXG.Math.Numerics.rungeKutta("rk4",s[s.length-1],[ra.interventions[e].getValue(),a(e)],(a(e)-ra.interventions[e].getValue())*ra.delta+1,t[e]).slice(1))});let n=0;for(let e=0;e<s[0].length;e++)n+=s[0][e];if(0!==n)for(let e=0;e<s.length;e++)for(let t=0;t<s[e].length;t++)s[e][t]=s[e][t]/n;for(let e=0;e<s.length;e++){let t=0;s[e][s[s.length-1].length]=ra.interventions.t0.getValue()+e/ra.delta;for(let a=0;a<s[e].length-1;a++)t+=s[e][a];s[e].unshift(t)}return console.timeEnd("Ode"),s};const pa={};pa.curves=[],pa.number={8321:1,8322:2,8323:3,8324:4,8325:5,8326:6,8327:7,8328:8,8329:9};var ma=function(){ra.plotCurves=function(e,t){let a=-1;return function(){clearTimeout(a);const s=arguments,n=this;a=setTimeout((function(){e.apply(n,s)}),t)}}(()=>{const e=ua();console.time("Plot"),Object.keys(ra.curves).forEach(t=>{ra.curves[t].dataX=[],ra.curves[t].dataY=[];for(let a=0;a<1e3;a++)ra.curves[t].dataX[a]=e[Math.floor(a*e.length/1e3)][e[0].length-1],ra.curves[t].dataY[a]="n"===t?ra.yPost(e[Math.floor(a*e.length/1e3)][0]):ra.yPost(e[Math.floor(a*e.length/1e3)][ra.statesMap[t]+1])}),ra.board.update(),function(){if(Object.values(pa.curves).forEach(e=>{ra.board.removeObject(e)}),!document.getElementById("slidersum").checked)return;let e=[],t=[],a=!1;Object.keys(ra.data.states).forEach(s=>{a=!1,t.includes(s)||(e=ra.curves[s].dataY,"n"!=s&&(Object.keys(ra.data.states).forEach(n=>{if("n"!=n&&function(e,t){for(var a=0,s=0,n="";s<t.length;)e[a]!=t[s]||a==e.length?n+=t[s]:a++,s++;return n}(ra.states[s].name,ra.states[n].name).charCodeAt(0)in pa.number){t.push(n),a=!0;for(let t=0;t<e.length;t++)e[t]+=ra.curves[n].dataY[t]}}),a&&(pa.curves[s+"sum"]=ra.board.create("curve",[ra.curves[s].dataX,e],{strokeColor:ra.colors[ra.statesMap[s]],name:s+"sum(t)",highlight:!1}))))})}(),console.timeEnd("Plot")},20)};function fa(e){var t,a,s,n,i,o,r=0,l="s1",c=!0,h="",u="";if("Epidemic-Model-Data"===e.slice(0,19)){for(r=20;":"!==e[r];){for(s=[],t=0,a=0,n="",i="",o="",h="";"("!==e[r];){switch(e[r]){case"m":r+=10,h="m";break;case"l":r+=10,h="l";break;case"r":r+=11,h="r"}i+=e[r],r++}for(r++;","!==e[r];)t+=e[r],r++;for(t=parseInt(t),r++;")"!==e[r];)a+=e[r],r++;for(a=parseInt(a),r++,r++;","!==e[r];)o+=e[r],r++;for(o=parseFloat(o),r++;";"!==e[r]&&":"!==e[r];)n+=e[r],","===e[++r]&&(s.push(parseInt(n)),n="",r++);if(s.push(parseInt(n)),c){var p=0;c=!1;const e=ee.getShape("s0");for(zt.systemStateActivate("sr",e),zt.activeShape.move(t,a),re.nameRemoveToken();p<s.length;)re.stateName(s[p]),p++;zt.activeShape.deactivate(),zt.systemStateActivate("i"),ee.draw(),zt.callback(ee.shMap),ra.data.states={},ra.data.states.s0={},ra.data.states.s0.name="S",ra.data.states.s0.value=o,ra.data.interventions={},ra.data.interventions.t0=0,ra.data.rates={},ra.data.capacitystates={}}else{for(;i!==l;)l=ee.generateFreeID("s");var m;m="m"===h?new Lt(i,t,a,"special",100):new d(i,t,a),ee.addShape(i,m);for(p=0;p<s.length;)m.nameAddChr(s[p]),p++;switch(h){case"l":m.capacitystate="left",m.lineWidth=2;break;case"r":m.capacitystate="right",m.lineWidth=.5}ee.draw(),zt.callback(ee.shMap),ra.data.states[i]={},ra.data.states[i].name=m.name,ra.data.states[i].value=o,"m"===h&&(ra.data.capacitystates[i]={},ra.data.capacitystates[i].name=m.name,ra.data.capacitystates[i].value=o)}":"!==e[r]&&r++}r+=2;var f="",b="";for(s=[],n="";";"!==e[r]&&":"!==e[r];){for(u="","l"===e[r]&&(r+=15,u="left"),"r"===e[r]&&(r+=16,u="right"),f="",b="",s=[],n="";","!==e[r];){for(n="";"-"!==e[r]&&","!==e[r];)n+=e[r],r++;switch(n[0]){case"(":n=n.substring(1,n.length-1),s.push("("),s.push(n),s.push(")");break;case"+":s.push("+");break;default:s.push(n)}","!==e[r]&&r++}for(s.push(","),n="",r++;","!==e[r];)n+=e[r],r++;for(f+=n,f=ee.getShape(f),r++,n="";";"!==e[r]&&":"!==e[r];)n+=e[r],r++;var v;if(b+=n,b=ee.getShape(b),"left"===u){const e=ee.generateFreeID("t");(v=new le(e,f,b)).capacitystate="left",v.lineWidth=2,ee.addShape(e,v)}else if("right"===u){const e=ee.generateFreeID("t");(v=new le(e,f,b)).capacitystate="right",v.lineWidth=.5,ee.addShape(e,v)}else v=fe.transitionCreate(f,b);zt.systemStateActivate("tr",v);for(p=0;","!==s[p];){var g="";switch(s[p]){case"+":zt.activeShape.nameAddToken("o",65291),p++;break;case"(":for(p++;")"!==s[p];)g+=s[p],p++;g=ee.getShape(g),zt.activeShape.nameAddToken("s",g),p++;break;default:zt.activeShape.nameAddToken("r",parseInt(s[p])),p++}}zt.activeShape.deactivate(),zt.systemStateActivate("i"),ee.draw(),zt.callback(ee.shMap),":"!==e[r]&&r++}r+=2;f="",b="";for(s=[],n="";";"!==e[r]&&":"!==e[r];){for(f="",b="",s=[],n="";","!==e[r];){for(n="";"-"!==e[r]&&","!==e[r];)n+=e[r],r++;switch(n[0]){case"(":n=n.substring(1,n.length-1),s.push("("),s.push(n),s.push(")");break;case"+":s.push("+");break;default:s.push(n)}","!==e[r]&&r++}for(s.push(","),r++,n="";";"!==e[r]&&":"!==e[r];)n+=e[r],r++;b+=n,b=ee.getShape(b),zt.systemStateActivate("t",b),Kt.specialArrowCreate("in");for(p=0;","!==s[p];){g="";switch(s[p]){case"+":zt.activeShape.nameAddToken("o",65291),p++;break;case"(":for(p++;")"!==s[p];)g+=s[p],p++;g=ee.getShape(g),zt.activeShape.nameAddToken("s",g),p++;break;default:zt.activeShape.nameAddToken("r",parseInt(s[p])),p++}}zt.activeShape.deactivate(),zt.systemStateActivate("i"),ee.draw(),zt.callback(ee.shMap),":"!==e[r]&&r++}r+=2;var y,S,I,k;f="",b="";for(s=[],n="";";"!==e[r]&&":"!==e[r];){for(f="",b="",s=[],n="";","!==e[r];){for(n="";"-"!==e[r]&&","!==e[r];)n+=e[r],r++;switch(n[0]){case"(":n=n.substring(1,n.length-1),s.push("("),s.push(n),s.push(")");break;case"+":s.push("+");break;default:s.push(n)}","!==e[r]&&r++}for(s.push(","),r++,n="";";"!==e[r]&&":"!==e[r];)n+=e[r],r++;f+=n,f=ee.getShape(f),zt.systemStateActivate("t",f),Kt.specialArrowCreate("out");for(p=0;","!==s[p];){g="";switch(s[p]){case"+":zt.activeShape.nameAddToken("o",65291),p++;break;case"(":for(p++;")"!==s[p];)g+=s[p],p++;g=ee.getShape(g),zt.activeShape.nameAddToken("s",g),p++;break;default:zt.activeShape.nameAddToken("r",parseInt(s[p])),p++}}zt.activeShape.deactivate(),zt.systemStateActivate("i"),ee.draw(),zt.callback(ee.shMap),":"!==e[r]&&r++}for(r+=2;":"!==e[r];){for(y="",S="";"-"!==e[r];)y+=e[r],r++;for(r++;","!==e[r]&&":"!==e[r];)S+=e[r],r++;S=parseFloat(S),":"!==e[r]&&r++,ra.data.interventions[y]=S}for(r+=2;":"!==e[r];){for(I="",y="",k="";","!==e[r];)I+=e[r],r++;for(I=String.fromCodePoint(I),r++;","!==e[r];)y+=e[r],r++;for(r++;":"!==e[r]&&";"!==e[r];)k+=e[r],r++;k=parseFloat(k),":"!==e[r]&&r++,void 0===ra.data.rates[I]&&(ra.data.rates[I]={}),ra.data.rates[I][y]=k}ra.load(),document.getElementById("uploadmodel").style.backgroundColor="lightgreen",$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#cstatesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").show(),$("#helpID").hide(),$("#Simulator").removeClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").addClass("active")}else alert("wrong data input")}function ba(e,t,a){var s=new Blob([e],{type:a});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(s,t);else{var n=document.createElement("a"),i=URL.createObjectURL(s);n.href=i,n.download=t,document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(i)}),0)}}function va(){let e="<div>Select states to fit:</div>",t="",a="";e+='<label class="switch">',e+='<input type="checkbox" id="fittingcheckn" name="fittingcheckn"> N',e+='<span class="slidern round"></span></label><span style="font-family:\'Arial\';"> ',e+="N",e+="(t)  &nbsp&nbsp</span><br>",Object.keys(ra.states).forEach(t=>{e+='<label class="switch">',e+='<input type="checkbox" id="fittingcheck'+t+'" name="fittingcheck'+t+'"> '+t,e+='<span class="slider'+t+' round"></span></label><span style="font-family:\'Arial\';"> ',e+=ra.states[t].name,e+="(t)  &nbsp&nbsp</span><br>"}),e+="<div>Select your susceptible compartment:</div>";let s=!0;Object.keys(ra.states).forEach(t=>{e+='<label class="switch">',e+='<input type="checkbox" id="scompartment'+t+'" name="scompartment'+t+'"',s&&(e+=" checked",s=!1),e+="> "+t,e+='<span class="slider'+t+' round"></span></label><span style="font-family:\'Arial\';"> ',e+=ra.states[t].name,e+="(t)  &nbsp&nbsp</span><br>"}),e+='<button id="fittingchoicevalidate" class="downloadupload" style="margin-right: 6px; width: 97px">Accept</button>',e+='<button id="fittingchoicecancel" class="downloadupload" style="width: 97px">Cancel</button>',$("#fittingchoice").html(e),Object.keys(ra.states).forEach(e=>{let t="scompartment";t+=e,document.getElementById(t).addEventListener("click",(function(){document.getElementById(t).checked||(document.getElementById(t).checked=!0),Object.keys(ra.states).forEach(t=>{let a="scompartment";a+=t,t!==e&&(document.getElementById(a).checked=!1)})}))}),document.getElementById("fittingchoicevalidate").addEventListener("click",(function(){document.getElementById("fittingcheckn").checked&&(t+='"',t+="n",t+='",'),Object.keys(ra.states).forEach(e=>{let a="fittingcheck";a+=e,document.getElementById(a).checked&&(t+='"',t+=e,t+='",')}),","===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),Object.keys(ra.states).forEach(e=>{let t="scompartment";t+=e,document.getElementById(t).checked&&(a+='"',a+=e,a+='",')}),","===a.charAt(a.length-1)&&(a=a.substring(0,a.length-1)),$("#fittingchoice").html(""),function(e,t){ua();var a,s,n,i,o,r,c='{"Model":\n';for([i,o]of(c+='         {"Equations": {',c+='"n": "',Object.keys(ra.states).forEach(e=>{c+=e,c+="+"}),c=c.substring(0,c.length-1),c+='", ',ee.shMap))if("s"===(n=i.substring(0,1))){for([a,s]of(c+='"',c+=i,c+='": "',ee.shMap)){if("t"===(n=a.substring(0,1))&&s.source.id===i&&void 0===s.type){r=0,c+="-",c+=i,c+="*";for(let e=0;e<s.nameArr.length;e++)switch(s.nameArr[e][0]){case"r":c+=s.nameArr[e][1],c+="*";break;case"s":c+=s.nameArr[e][1].id,c+="*","n"!=s.nameArr[e][1].id&&r++;break;case"o":for(;r>0;r--)c+="/n";c+="-",c+=i,c+="*"}for("*"===c.charAt(c.length-1)&&(c=c.substring(0,c.length-1));r>0;r--)c+="/n"}if("t"===n&&s.target.id===i&&void 0===s.type){r=0,c+="+",c+=s.source.id,c+="*";for(let e=0;e<s.nameArr.length;e++)switch(s.nameArr[e][0]){case"r":c+=s.nameArr[e][1],c+="*";break;case"s":c+=s.nameArr[e][1].id,c+="*","n"!=s.nameArr[e][1].id&&r++;break;case"o":for(;r>0;r--)c+="/n";c+="+",c+=s.source.id,c+="*"}for("*"===c.charAt(c.length-1)&&(c=c.substring(0,c.length-1));r>0;r--)c+="/n"}if("t"===n&&s.source.id===i&&"out"===s.type){r=-1,c+="-";for(let e=0;e<s.nameArr.length;e++)switch(s.nameArr[e][0]){case"r":c+=s.nameArr[e][1],c+="*";break;case"s":c+=s.nameArr[e][1].id,c+="*","n"!=s.nameArr[e][1].id&&r++;break;case"o":for(;r>0;r--)c+="/n";c+="-",c+=i,c+="*"}for("*"===c.charAt(c.length-1)&&(c=c.substring(0,c.length-1));r>0;r--)c+="/n"}if("t"===n&&s.target.id===i&&"in"===s.type){r=-1,c+="+";for(let e=0;e<s.nameArr.length;e++)switch(s.nameArr[e][0]){case"r":c+=s.nameArr[e][1],c+="*";break;case"s":c+=s.nameArr[e][1].id,c+="*","n"!=s.nameArr[e][1].id&&r++;break;case"o":for(;r>0;r--)c+="/n";c+="+",c+=s.source.id,c+="*"}for("*"===c.charAt(c.length-1)&&(c=c.substring(0,c.length-1));r>0;r--)c+="/n"}}c+='", '}c=c.substring(0,c.length-2),c+='},\n          "Parameters": [',Object.keys(ra.rates).forEach(e=>{c+='"',c+=e.codePointAt(0),c+='",'}),","===c.charAt(c.length-1)&&(c=c.substring(0,c.length-1)),c+="],\n",c+='          "state_ids": [',Object.keys(ra.states).forEach(e=>{c+='"',c+=e,c+='"',c+=","}),","===c.charAt(c.length-1)&&(c=c.substring(0,c.length-1)),c+="],\n",c+='          "state-names": {',Object.keys(ra.states).forEach(e=>{c+='"',c+=e,c+='"',c+=":",c+='"';for(let t=0;t<ra.states[e].name.length;t++){let a=ra.states[e].name.codePointAt(t);Object.keys(l.L.C).forEach(e=>{l.L.C[e]===a&&(c+=e),l.L.S[e]===a&&(c+=e.toLowerCase())})}c+='"',c+=","}),","===c.charAt(c.length-1)&&(c=c.substring(0,c.length-1)),c+="},\n",c+='          "rates-names": {',Object.keys(ra.rates).forEach(e=>{c+='"',c+=e.codePointAt(0),c+='"',c+=":",c+='"',c+=l.greek.S[e.codePointAt(0)],c+='"',c+=","}),","===c.charAt(c.length-1)&&(c=c.substring(0,c.length-1)),c+="},\n",c+='          "IV": [',Object.keys(ra.states).forEach(e=>{c+=ra.states[e].getValue(),c+=","}),","===c.charAt(c.length-1)&&(c=c.substring(0,c.length-1)),c+='],\n          "Compartments_to_Fit": [',c+=e,c+='],\n          "Susceptibles": ',c+=t,c+=',\n          "n": ';var d=0;Object.keys(ra.states).forEach(e=>{d+=ra.states[e].getValue()}),c+=d,ba(c+="}\n}","EMD-model.json",/text.*/)}(t,a)})),document.getElementById("fittingchoicecancel").addEventListener("click",(function(){$("#fittingchoice").html("")}))}const ga={SIR:"",SIS:"",SEIR:"",SIRS:"",SIRD:"",SIRV:"",MSEIR:"",SIHRD:""},ya={SIRvitaldynamics:"",SISvitaldynamics:"",SEIRvitaldynamics:"",SIRSvitaldynamics:"",SIRDvitaldynamics:"",SIRVvitaldynamics:"",MSEIRvitaldynamics:"",SIHRDvitaldynamics:""};ga.SIR="Epidemic-Model-Data\n",ga.SIR+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(500,100),0,119877:\n",ga.SIR+="120573-(s1),s0,s1;120574,s1,s2:\n",ga.SIR+=":\n",ga.SIR+=":\n",ga.SIR+="t0-0:\n",ga.SIR+="120573,t0,0.3;120574,t0,0.1:",ga.SIS="Epidemic-Model-Data\n",ga.SIS+="s0(100,100),1000,119878;s1(300,100),10,119868:\n",ga.SIS+="120573-(s1),s0,s1;120574,s1,s0:\n",ga.SIS+=":\n",ga.SIS+=":\n",ga.SIS+="t0-0:\n",ga.SIS+="120573,t0,0.2;120574,t0,0.1:\n",ga.SEIR="Epidemic-Model-Data\n",ga.SEIR+="s0(100,100),1000,119878;s1(300,100),0,119864;s2(500,100),10,119868;s3(700,100),0,119877:\n",ga.SEIR+="120573-(s2),s0,s1;120572,s1,s2;120574,s2,s3:\n",ga.SEIR+=":\n",ga.SEIR+=":\n",ga.SEIR+="t0-0:\n",ga.SEIR+="120573,t0,0.3;120572,t0,0.1;120574,t0,0.1:\n",ga.SIRS="Epidemic-Model-Data\n",ga.SIRS+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(450,300),0,119877:\n",ga.SIRS+="120573-(s1),s0,s1;120574,s1,s2;120591,s2,s0:\n",ga.SIRS+=":\n",ga.SIRS+=":\n",ga.SIRS+="t0-0:\n",ga.SIRS+="120573,t0,0.4;120574,t0,0.2;120591,t0,0.01:\n",ga.SIRD="Epidemic-Model-Data\n",ga.SIRD+="s0(100,200),1000,119878;s1(300,200),10,119868;s2(500,100),0,119877;s3(500,300),0,119863:\n",ga.SIRD+="120573-(s1),s0,s1;120574,s1,s2;120575,s1,s3:\n",ga.SIRD+=":\n",ga.SIRD+=":\n",ga.SIRD+="t0-0:\n",ga.SIRD+="120573,t0,0.3;120574,t0,0.1;120575,t0,0.005:\n",ga.SIRV="Epidemic-Model-Data\n",ga.SIRV+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(500,100),0,119877;s3(200,200),0,119881:\n",ga.SIRV+="120573-(s1),s0,s1;120574,s1,s2;120575,s0,s3:\n",ga.SIRV+=":\n",ga.SIRV+=":\n",ga.SIRV+="t0-0:\n",ga.SIRV+="120573,t0,0.3;120574,t0,0.1;120575,t0,0.01:\n",ga.MSEIR="Epidemic-Model-Data\n",ga.MSEIR+="s0(100,100),100,119872;s1(300,100),900,119878;s2(500,100),0,119864;s3(700,100),1,119868;s4(900,100),0,119877:\n",ga.MSEIR+="120575,s0,s1;120573-(s3),s1,s2;120572,s2,s3;120574,s3,s4:\n",ga.MSEIR+=":\n",ga.MSEIR+=":\n",ga.MSEIR+="t0-0:\n",ga.MSEIR+="120575,t0,0.01;120573,t0,0.3;120572,t0,0.1;120574,t0,0.1:\n",ga.SIHRD="Epidemic-Model-Data\n",ga.SIHRD+="s0(250,50),1000,119878;s1(250,250),10,119868;maincstates2(400,400),100,119870;leftcstates3(250,550),0,119867;rightcstates4(550,550),0,119863;s5(100,400),0,119877:\n",ga.SIHRD+="leftctransition120582,s2,s3;rightctransition120582,s2,s4;120573-(s1),s0,s1;120582,s1,s2;120581,s3,s5;120591,s1,s5:\n",ga.SIHRD+=":\n",ga.SIHRD+=":\n",ga.SIHRD+="t0-0:\n",ga.SIHRD+="120573,t0,0.5;120582,t0,0.11;120591,t0,0.1;120581,t0,0.1:\n",ya.SIRvitaldynamics="Epidemic-Model-Data\n",ya.SIRvitaldynamics+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(500,100),0,119877:\n",ya.SIRvitaldynamics+="120573-(s1),s0,s1;120574,s1,s2:\n",ya.SIRvitaldynamics+="120583-(n),s0:\n",ya.SIRvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2:\n",ya.SIRvitaldynamics+="t0-0:\n",ya.SIRvitaldynamics+="120573,t0,0.3;120574,t0,0.1;120583,t0,0.01;120584,t0,0.01:\n",ya.SISvitaldynamics="Epidemic-Model-Data\n",ya.SISvitaldynamics+="s0(100,100),1000,119878;s1(300,100),10,119868:\n",ya.SISvitaldynamics+="120573-(s1),s0,s1;120574,s1,s0:\n",ya.SISvitaldynamics+="120583-(n),s0:\n",ya.SISvitaldynamics+="120584-(s0),s0;120584-(s1),s1:\n",ya.SISvitaldynamics+="t0-0:\n",ya.SISvitaldynamics+="120573,t0,0.2;120574,t0,0.1;120583,t0,0.001;120584,t0,0.001:\n",ya.SEIRvitaldynamics="Epidemic-Model-Data\n",ya.SEIRvitaldynamics+="s0(100,100),1000,119878;s1(300,100),0,119864;s2(500,100),10,119868;s3(700,100),0,119877:\n",ya.SEIRvitaldynamics+="120573-(s2),s0,s1;120572,s1,s2;120574,s2,s3:\n",ya.SEIRvitaldynamics+="120583-(n),s0:\n",ya.SEIRvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2;120584-(s3),s3:\n",ya.SEIRvitaldynamics+="t0-0:\n",ya.SEIRvitaldynamics+="120573,t0,0.3;120572,t0,0.1;120574,t0,0.1;120583,t0,0.001;120584,t0,0.001:\n",ya.SIRSvitaldynamics="Epidemic-Model-Data\n",ya.SIRSvitaldynamics+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(450,300),0,119877:\n",ya.SIRSvitaldynamics+="120573-(s1),s0,s1;120574,s1,s2;120591,s2,s0:\n",ya.SIRSvitaldynamics+="(n)-120583,s0:\n",ya.SIRSvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2:\n",ya.SIRSvitaldynamics+="t0-0:\n",ya.SIRSvitaldynamics+="120573,t0,0.4;120574,t0,0.2;120591,t0,0.01;120583,t0,0.001;120584,t0,0.001:\n",ya.SIRDvitaldynamics="Epidemic-Model-Data\n",ya.SIRDvitaldynamics+="s0(100,200),1000,119878;s1(300,200),10,119868;s2(500,100),0,119877;s3(500,300),0,119863:\n",ya.SIRDvitaldynamics+="120573-(s1),s0,s1;120574,s1,s2;120575,s1,s3:\n",ya.SIRDvitaldynamics+="120583-(s0)-+-120583-(s1)-+-120583-(s2),s0:\n",ya.SIRDvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2:\n",ya.SIRDvitaldynamics+="t0-0:\n",ya.SIRDvitaldynamics+="120573,t0,0.3;120574,t0,0.1;120575,t0,0.005;120583,t0,0.01;120584,t0,0.01:\n",ya.SIRVvitaldynamics="Epidemic-Model-Data\n",ya.SIRVvitaldynamics+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(500,100),0,119877;s3(200,200),0,119881:\n",ya.SIRVvitaldynamics+="120573-(s1),s0,s1;120574,s1,s2;120575,s0,s3:\n",ya.SIRVvitaldynamics+="120583-(n),s0:\n",ya.SIRVvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2;120584-(s3),s3:\n",ya.SIRVvitaldynamics+="t0-0:\n",ya.SIRVvitaldynamics+="120573,t0,0.3;120574,t0,0.1;120575,t0,0.01;120583,t0,0.01;120584,t0,0.01:\n",ya.MSEIRvitaldynamics="Epidemic-Model-Data\n",ya.MSEIRvitaldynamics+="s0(100,100),100,119872;s1(300,100),900,119878;s2(500,100),0,119864;s3(700,100),1,119868;s4(900,100),0,119877:\n",ya.MSEIRvitaldynamics+="120575,s0,s1;120573-(s3),s1,s2;120572,s2,s3;120574,s3,s4:\n",ya.MSEIRvitaldynamics+="120583-(s0)-+-120583-(s2)-+-120583-(s3)-+-120583-(s4),s0;120583-(s1),s1:\n",ya.MSEIRvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2;120584-(s3),s3;120584-(s4),s4:\n",ya.MSEIRvitaldynamics+="t0-0:\n",ya.MSEIRvitaldynamics+="120575,t0,0.01;120573,t0,0.3;120572,t0,0.1;120574,t0,0.1;120583,t0,0.001;120584,t0,0.001:\n",ya.SIHRDvitaldynamics="Epidemic-Model-Data\n",ya.SIHRDvitaldynamics+="s0(139,118),1000,119878;s1(250,250),10,119868;maincstates2(400,400),100,119870;leftcstates3(250,550),0,119867;rightcstates4(550,550),0,119863;s5(100,400),0,119877:\n",ya.SIHRDvitaldynamics+="leftctransition120582,s2,s3;rightctransition120582,s2,s4;120573-(s1),s0,s1;120582,s1,s2;120581,s3,s5;120591,s1,s5:\n",ya.SIHRDvitaldynamics+="120583-(s0)-+-120583-(s1)-+-120583-(s3)-+-120583-(s5),s0:\n",ya.SIHRDvitaldynamics+="120584-(s1),s1;120584-(s0),s0;120584-(s5),s5;120584-(s3),s3:\n",ya.SIHRDvitaldynamics+="t0-0:\n",ya.SIHRDvitaldynamics+="120573,t0,0.7;120582,t0,0.11;120591,t0,0.1;120581,t0,0.1;120583,t0,0.1;120584,t0,0.1:\n";var Sa=function(){let e,t="";for(e in t+='<div style="padding-left:130px; margin-bottom: 5px; font-size: 10pt; font-family: Verdana, Geneva, Tahoma, sans-serif;">With vital dynamics:</div>',ga)t+='<span style="padding-bottom:5px; display:block;">',t+='<button id="',t+=e,t+='" style="width:100px; margin-right: 50px;" class="downloadupload">',t+=e,t+="</button>",t+='<button id="',t+=e,t+="vitaldynamics",t+='" style="width:100px;" class="downloadupload">',t+=e,t+="</button>",t+="</span>";for(e in t+='<div style="margin-bottom: 5px; margin-top: 10px; font-size: 10pt; font-family: Verdana, Geneva, Tahoma, sans-serif;">Create by number of states:</div>',t+='<input type="number" id="numberstates" min="1" value="1" style="background-color: lightgrey; width: 40px;">',t+='<button id="createwithnumber" style="width:55px; margin-left: 10px;" class="downloadupload">Create</button>',t+='<button id="createwithnumbertransitons" style="width:150px; margin-left: 10px;" class="downloadupload">Create with transitions</button>',document.getElementById("defaultmodelscontent").innerHTML=t,ga){let t=e,a=e;a+="vitaldynamics",document.getElementById(t).addEventListener("click",(function(){"s1"===ee.generateFreeID("s")?(fa(ga[t]),$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").hide(),$("#Simulator").removeClass("active"),$("#Designer").addClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").removeClass("active")):alert("There is an acitve model running! \nPlease refresh the website.")})),document.getElementById(a).addEventListener("click",(function(){"s1"===ee.generateFreeID("s")?(fa(ya[a]),$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").hide(),$("#Simulator").removeClass("active"),$("#Designer").addClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").removeClass("active")):alert("There is an acitve model running! \nPlease refresh the website.")}))}document.getElementById("createwithnumber").addEventListener("click",(function(){let e=document.getElementById("numberstates").value;if(e<1)return;if("s1"!==ee.generateFreeID("s"))return void alert("There is an acitve model running! \nPlease refresh the website.");let t="Epidemic-Model-Data\n",a=100,s=0,n="",i="";for(let o=0;o<e;o++)o%4==0&&(s+=100,a=100),n="s",n+=o,i=119860+o,t+=n,t+="(",t+=a,t+=",",t+=s,t+="),",t+=0===o?"1000,":"0,",t+=i,t+=";",a+=200;t=t.substring(0,t.length-1),t+=":\n:\n:\n:\nt0-0:\n:\n",fa(t),$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").hide(),$("#Simulator").removeClass("active"),$("#Designer").addClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").removeClass("active")})),document.getElementById("createwithnumbertransitons").addEventListener("click",(function(){let e=document.getElementById("numberstates").value;if(e<1)return;if("s1"!==ee.generateFreeID("s"))return void alert("There is an acitve model running! \nPlease refresh the website.");let t,a="Epidemic-Model-Data\n",s=100,n=0,i="",o="",r="";for(let t=0;t<e;t++)t%4==0&&(n+=100,s=100),i="s",i+=t,r=119860+t,a+=i,a+="(",a+=s,a+=",",a+=n,a+="),",a+=0===t?"1000,":"0,",a+=r,a+=";",s+=200;a=a.substring(0,a.length-1),a+=":\n";for(let s=0;s<e-1;s++)i="s",i+=s,o="s",o+=s+1,t=120572+s,a+=t,a+=",",a+=i,a+=",",a+=o,a+=";";a=a.substring(0,a.length-1),a+=":\n:\n:\nt0-0:\n";for(let s=0;s<e-1;s++)t=120572+s,a+=t,a+=",",a+="t0,",a+="0.1;";a=a.substring(0,a.length-1),a+=":\n",fa(a),$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").hide(),$("#Simulator").removeClass("active"),$("#Designer").addClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").removeClass("active")}))};function Ia(){JXG.Options=JXG.merge(JXG.Options,{board:{showNavigation:!1,showCopyright:!1,useMathJax:!0}}),JXG.Options.text.useMathJax=!0,ra.board=JXG.JSXGraph.initBoard("plotID",{boundingbox:[-20,1.2,220,-.1],axis:!1,keepaspectratio:!1,showCopyright:!1,showNavigation:!1,zoom:{factorX:1.25,factorY:1.25,wheel:!0,needshift:!1,eps:.1}}),la(),ma(),ca(),ha(),ra.plotCurves(),Sa()}function ka(){$("#Designer").click(()=>{$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#cstatesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").hide(),$("#Simulator").removeClass("active"),$("#Designer").addClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").removeClass("active")}),$("#Simulator").click(()=>{$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#helpID").show(),$("#plotID").show(),$("#tab2ID").show(),$("#GraphButtons").show(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").hide(),$("#Simulator").addClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").removeClass("active"),Object.values(ra.rates).forEach(e=>{e.board.update()})}),$("#Defaultmodels").click(()=>{$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#cstatesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").show(),$("#Simulator").removeClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").addClass("active")}),$("#UploadDownload").click(()=>{$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#cstatesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").show(),$("#defaultmodelscontent").hide(),$("#helpID").hide(),$("#Simulator").removeClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").addClass("active"),$("#Defaultmodels").removeClass("active")}),$("#uploadmodel").change(()=>{!function(){if("s1"!==ee.generateFreeID("s"))return alert("There is an acitve model running! \nPlease refresh the website before the upload."),void(document.getElementById("uploadmodel").style.backgroundColor="red");const e=document.getElementById("uploadmodel").files[0];if(e.type.match(/text.*/)){const t=new FileReader;t.onload=function(e){fa(t.result)},t.readAsText(e)}else alert("Error with your datatype")}()}),$("#downloadmodel").click(()=>{!function(){var e,t,a="Epidemic-Model-Data\n";for([e,t]of ee.shMap)"s"===e.substring(0,1)&&(void 0!==t.max&&(a+="maincstate"),"left"===t.capacitystate&&(a+="leftcstate"),"right"===t.capacitystate&&(a+="rightcstate"),a+=e,a+="(",a+=t.x,a+=",",a+=t.y,a+=")",a+=",",void 0!==ra.states[e]||null!=t.max&&void 0!==ra.capacitystates[e]?void 0!==t.max?a+=ra.capacitystates[e].getValue():a+=ra.states[e].getValue():void 0!==t.max?a+="100":a+="0",a+=",",a+=t.nameArr,a+=";");for([e,t]of(a=a.substring(0,a.length-1),a+=":",a+="\n",ee.shMap))if("t"===e.substring(0,1)&&void 0===t.type){"left"===t.capacitystate&&(a+="leftctransition"),"right"===t.capacitystate&&(a+="rightctransition");for(let e=0;e<t.nameArr.length;e++)switch(t.nameArr[e][0]){case"r":a+=t.nameArr[e][1],a+="-";break;case"s":a+="(",a+=t.nameArr[e][1].id,a+=")",a+="-";break;case"o":a+="+",a+="-"}a=a.substring(0,a.length-1),a+=",",a+=t.source.id,a+=",",a+=t.target.id,a+=";"}for([e,t]of(":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",ee.shMap))if("t"===e.substring(0,1)&&"in"===t.type){for(let e=0;e<t.nameArr.length;e++)switch(t.nameArr[e][0]){case"r":a+=t.nameArr[e][1],a+="-";break;case"s":a+="(",a+=t.nameArr[e][1].id,a+=")",a+="-";break;case"o":a+="+",a+="-"}a=a.substring(0,a.length-1),a+=",",a+=t.target.id,a+=";"}for([e,t]of(":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",ee.shMap))if("t"===e.substring(0,1)&&"out"===t.type){for(let e=0;e<t.nameArr.length;e++)switch(t.nameArr[e][0]){case"r":a+=t.nameArr[e][1],a+="-";break;case"s":a+="(",a+=t.nameArr[e][1].id,a+=")",a+="-";break;case"o":a+="+",a+="-"}a=a.substring(0,a.length-1),a+=",",a+=t.source.id,a+=";"}":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",Object.keys(ra.interventions).forEach(e=>{a+=e,a+="-",a+=ra.interventions[e].getValue(),a+=","}),":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",Object.keys(ra.rates).forEach(e=>{Object.keys(ra.interventions).forEach(t=>{a+=e.codePointAt(0),a+=",",a+=t,a+=",",a+=ra.rates[e][t].getValue(),a+=";"})}),":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",ba(a,"EMD-download.txt",/text.*/)}()}),$("#downloaddatacsv").click(()=>{!function(){const e=ua();var t,a,s="population,";for([t,a]of ee.shMap){if("s"===t.substring(0,1)){for(let e=0;e<a.name.length;e++){let t=a.name.codePointAt(e);Object.keys(l.L.C).forEach(e=>{l.L.C[e]===t&&(s+=e),l.L.S[e]===t&&(s+=e.toLowerCase())})}s+=","}}s+="\n";for(let t=0;t<e.length;t++){var n=e[t].pop();Number.isInteger(n)&&(s+=e[t],s+=",",s+="\n")}ba(s,"EMD-data.csv",/text.*/)}()}),$("#downloadmodeljson").click(()=>{va()}),$("#downloadfittingprogram").click(()=>{window.open("https://github.com/Kilian672/EMD-Code/blob/main/App.exe","_blank").focus()}),$("#Rates").click(()=>{$("#ratesID").show(),$("#tab3ID").show(),$("#statesID").hide(),$("#cstatesID").hide(),$("#Rates").addClass("active"),$("#Values").removeClass("active"),Object.values(ra.rates).forEach(e=>{e.board.update()})}),$("#Values").click(()=>{$("#ratesID").hide(),$("#tab3ID").hide(),$("#statesID").show(),$("#cstatesID").show(),$("#Values").addClass("active"),$("#Rates").removeClass("active"),Object.values(ra.states).forEach(e=>{e.board.update()}),document.getElementById("cstatesID").focus()})}document.addEventListener("DOMContentLoaded",()=>{ka(),document.getElementById("Designer").click(),oa.init(),document.getElementById("Simulator").click(),document.getElementById("Rates").click(),$("#Simulator").click(e=>{$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#plotID").show(),$("#tab2ID").show(),$("#GraphButtons").show(),$("#Simulator").addClass("active"),$("#Designer").removeClass("active"),0!==Object.keys(ra).length&&ra.update(),document.getElementById("Rates").click()}),Ia(),document.getElementById("Designer").click()})}]);