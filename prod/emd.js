!function(e){var t={};function a(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);const s={i:"",s:"",sr:"",sm:"",t:"",tr:"",tm:""};s.i="Double click an empty space in the <b>Model</b> pane to create a state.<br>Click an object to select it.<br>Drag a state to improve readability.<br>",s.s="Press <b>DEL</b> to delete the state.<br>Press <b>INS</b> to rename the state.<br>Hold <b>CTRL</b> and click a state to create a transition.<br>Click an empty space for more options.",s.sr="Press <b>CTRL</b> + <b>l</b> (latin), <b>g</b> (greek), <b>s</b> (symbol) to choose an alphabet.<br>Enter letters (<b>a</b> or <b>A</b>) to change the name.<br>Enter numbers (<b>1</b>, <b>2</b>, <b>12</b>) to add a subscript<br>Delete with <b>BACKSPACE</b>, confirm with <b>ENTER</b> or click.",s.t="Press <b>DEL</b> to delete the transition.<br>Press <b>INS</b> to rename the transition.<br>Hold <b>t</b> to choose a transition target (<b>s</b>ource, <b>f</b>actor).<br>Click an empty space for more options.",s.tr=s.sr,s.sm=s.s,s.tm=s.t;var n=s;const i={check:"",Delete:"",rename:"",in:"",out:"",S:"",G:"",L:"",up:"",low:"",T:"",X:"",target:"",source:""};i.check="Confirm the name",i.Delete="Delete the active",i.rename="Click this button to Rename",i.in="Create a specialArrow in",i.out="Create a specialArrow out",i.S="special alphabet keyboard",i.G="greek alphabet keyboard",i.L="latin alphabet keyboard",i.up="Upper case alphabet",i.low="Lower case alphabet",i.T="Create a new Transition",i.X="Vallidate your input",i.target="Choose a new target",i.source="Choose a new source";var o=i;const r={L:{S:null,C:null},G:{S:null,C:null},S:{S:null,C:null}};r.L.S={A:119886,B:119887,C:119888,D:119889,E:119890,F:119891,G:119892,H:8462,I:119894,J:119895,K:119896,L:119897,M:119898,N:119899,O:119900,P:119901,Q:119902,R:119903,S:119904,T:119905,U:119906,V:119907,W:119908,X:119909,Y:119910,Z:119911,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.L.C={A:119860,B:119861,C:119862,D:119863,E:119864,F:119865,G:119866,H:119867,I:119868,J:119869,K:119870,L:119871,M:119872,N:119873,O:119874,P:119875,Q:119876,R:119877,S:119878,T:119879,U:119880,V:119881,W:119882,X:119883,Y:119884,Z:119885,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.G.S={A:120572,B:120573,C:120585,D:120575,E:120576,F:120593,G:120574,H:120578,I:120580,J:120589,K:120581,L:120582,M:120583,N:120584,O:120586,P:120587,Q:120579,R:120588,S:120590,T:120591,U:120592,W:120596,X:120594,Y:120595,Z:120577,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.G.C={A:120546,B:120547,C:120559,D:120549,E:120550,F:120567,G:120548,H:120552,I:120554,K:120555,L:120556,M:120557,N:120558,O:120560,P:120561,Q:120553,R:120562,S:120564,T:120565,U:120566,W:120570,X:120568,Y:120569,Z:120551,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.S.S={E:120598,F:120601,K:120600,P:120603,Q:120599,R:120602,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.S.C={Q:120563,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329};var l=r;var c={stateRadius:20,snapToPadding:6,hitTargetPadding:6,instancesLimit:1e6,specialArrowLimit:5,stateDefaultColour:"black",stateSelectedColour:"blue",stateTransitionFactorColour:"red",transitionDefaultColour:"black",transitionSelectedColour:"blue",transitionStateFactorColour:"red",stateKeys:{Rename:45,Delete:46,Transition:17},transitionKeys:{Rename:45,Delete:46,Target:84,Source:83,Factor:70},canvas:null,context:null,buildString:e=>{let t="";for(let a=0;a<e.length;a+=1)t+=String.fromCodePoint(e[a]);return t}};var d=class{constructor(e,t,a,s=c.stateRadius){this.radius=s,this.x=Math.min(t,c.canvas.width-this.radius),this.x=Math.max(this.x,this.radius),this.y=Math.min(a,c.canvas.height-this.radius),this.y=Math.max(this.y,this.radius),this.moveOffsetX=0,this.moveOffsetY=0,this.id=e,this.nameArr=[],this.name="",this.data=[],this.colour=c.stateDefaultColour,this.lineWidth=1,this.transitions={in:[],out:[],factor:[]}}transitionAdd(e,t){this.transitions[t][e.id]=e}transitionDelete(e,t){delete this.transitions[t][e.id]}updateTransitions(){let e;for(e in this.transitions.factor)this.transitions.factor[e].nameUpdate()}activate(){let e;for(e in this.colour=c.stateSelectedColour,this.transitions.factor)this.transitions.factor[e].colour=c.stateTransitionFactorColour}deactivate(){let e;for(e in this.colour=c.stateDefaultColour,this.transitions.factor)this.transitions.factor[e].colour=c.transitionDefaultColour}moveStart(e,t){this.moveOffsetX=e-this.x,this.moveOffsetY=t-this.y}move(e,t){let a;for(a in this.x=e-this.moveOffsetX,this.y=t-this.moveOffsetY,this.x=Math.min(this.x,c.canvas.width-this.radius),this.x=Math.max(this.x,this.radius),this.y=Math.min(this.y,c.canvas.height-this.radius),this.y=Math.max(this.y,this.radius),this.transitions.in)this.transitions.in[a].updateShape();for(a in this.transitions.out)this.transitions.out[a].updateShape()}moveStop(){this.moveOffsetX=0,this.moveOffsetY=0}nameAddChr(e){this.nameArr.push(e),this.name+=String.fromCodePoint(e)}nameRemoveChr(){return 0!==this.nameArr.length&&(this.nameArr.pop(),this.name=c.buildString(this.nameArr),!0)}draw(){if(0!==this.radius){const e=c.context;e.lineWidth=this.lineWidth,e.strokeStyle=this.colour,e.fillStyle=this.colour,e.font="20px Verdana, Geneva, Tahoma, sans-serif",e.textAlign="center",e.textBaseline="middle",e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI),e.stroke(),e.fillText(this.name,this.x,this.y)}}closestPointOnCircle(e,t){const a=e-this.x,s=t-this.y,n=Math.sqrt(a*a+s*s);return{x:this.x+a*this.radius/n,y:this.y+s*this.radius/n}}};let h={},u={};function p(e){return e.preventDefault(),0!==e.button||(h.mouseDown(e),u.focus()),!1}function m(e){return e.preventDefault(),!1}function b(e){return e.preventDefault(),!1}function v(e){return e.preventDefault(),h.dblClick(e),!1}function f(e){return e.preventDefault(),0===e.button&&h.mouseCancel(e),!1}function g(e){h.mouseCancel(e)}function S(e){h.mouseMove(e)}function y(e){return e.preventDefault(),h.keyDown(e),!1}function w(e){h.keyUp(e)}var I=function(e,t){u=e,h=t,u.addEventListener("mousedown",p),u.addEventListener("click",m),u.addEventListener("dblclick",v),u.addEventListener("contextmenu",b),u.addEventListener("mousemove",S),u.addEventListener("mouseup",f),u.addEventListener("mouseout",g),u.addEventListener("keydown",y),u.addEventListener("keyup",w)};let k={};const C={};let D={},x={};function A(){let e;return e="s"===D.state?D.selectionTransitionTarget?"t":"i":"sm"===D.state?"m":"sr"===D.state?"r":null,e}C.mouseDown=e=>{switch(A()){case"i":D.systemStateMouseDown(e.offsetX,e.offsetY);break;case"t":x.stateSelectTransitionTarget(e);break;case"r":x.stateRenameExitSelect(e)}},C.mouseMove=e=>{"m"===A()&&D.moveObject(e)},C.mouseCancel=()=>{"m"===A()&&D.moveStop()},C.keyDown=e=>{const t=A(),a=e.keycode||e.which;switch(t){case"i":!function(e){switch(e){case k.Transition:x.stateActivateTransition();break;case k.Rename:x.stateActivateRename();break;case k.Delete:x.stateActivateDelete()}}(a);break;case"r":x.renameKeyDown(e)}},C.keyUp=e=>{const t=A(),a=e.keycode||e.which;"t"===t&&a===k.Transition&&x.stateActivateIdle()},C.init=(e,t,a)=>{D=e,k=a,x=t};var E=C;let M={};const R={};let T={},O={};function P(){let e;return e="t"===T.state?T.selectionTransitionTarget?"t":T.selectionTransitionSource?"s":T.selectionTransitionFactor?"f":"i":"tm"===T.state?"m":"tr"===T.state?"r":null,e}R.mouseDown=e=>{switch(P()){case"i":T.systemStateMouseDown(e.offsetX,e.offsetY);break;case"t":O.transitionSelectTarget(e);break;case"s":O.transitionSelectSource(e);break;case"f":O.transitionSelectFactor(e);break;case"r":O.transitionRenameExitSelect(e)}},R.mouseMove=e=>{"m"===P()&&T.moveObject(e)},R.mouseCancel=()=>{"m"===P()&&T.moveStop()},R.keyDown=e=>{switch(P()){case"i":!function(e){switch(e.keycode||e.which){case M.Target:O.transitionActivateTarget();break;case M.Source:O.transitionActivateSource();break;case M.Factor:O.transitionActivateFactor();break;case M.Rename:O.transitionActivateRename();break;case M.Delete:O.transitionActivateDelete()}}(e)}},R.keyUp=e=>{const t=P(),a=e.keycode||e.which;("t"===t&&a===M.Target||"s"===t&&a===M.Source||"f"===t&&a===M.Factor)&&O.transitionActivateIdle()},R.init=(e,t,a)=>{T=e,O=t,M=a};var K=R;const B={};let X={},H={};B.mouseDown=e=>{X.systemStateMouseDown(e.offsetX,e.offsetY)},B.dblClick=e=>{H.stateCreate(e)},B.init=(e,t)=>{X=e,H=t};var L=B;const j={};let N={};function G(){let e;switch(N.state){case"s":case"sr":case"sm":e="s";break;case"t":case"tr":case"tm":e="t";break;case"i":e="i"}return e}j.mouseDown=e=>{switch(G()){case"i":L.mouseDown(e);break;case"s":E.mouseDown(e);break;case"t":K.mouseDown(e)}},j.dblClick=e=>("i"!==G()||L.dblClick(e),!1),j.mouseCancel=()=>{switch(G()){case"s":E.mouseCancel();break;case"t":K.mouseCancel()}},j.mouseMove=e=>{switch(G()){case"s":E.mouseMove(e);break;case"t":K.mouseMove(e)}},j.keyDown=e=>{switch(G()){case"s":E.keyDown(e);break;case"t":K.keyDown(e)}},j.keyUp=e=>{switch(G()){case"s":E.keyUp(e);break;case"t":K.keyUp(e)}};var V=function(e,t,a,s,n,i){I(e,j),N=t,L.init(N,a),E.init(N,a,n),K.init(N,s,i)};let F={},U={},z=0,Y=0,J=100;const _={s:0,t:0},W={};function q(e,t,a){return F.beginPath(),F.arc(a.x,a.y,Y,0,2*Math.PI),F.closePath(),!!F.isPointInPath(e,t)}function Z(e,t,a){const s=a.shape.source.point,n=a.shape.target.point,i=n.x-s.x,o=n.y-s.y,r=Math.sqrt(i*i+o*o),l=(i*(e-s.x)+o*(t-s.y))/(r*r),c=(i*(t-s.y)-o*(e-s.x))/r;return l>0&&l<1&&Math.abs(c)<z}W.shMap=new Map,W.getShape=e=>W.shMap.get(e),W.findShape=(e,t)=>{let a,s,n;for([a,n]of W.shMap)switch(s=a.substring(0,1),s){case"s":if(q(e,t,n))return n;break;case"t":if(Z(e,t,n))return n}return null},W.stateconflict=e=>{let t,a,s;const n=e.id;for([t,a]of W.shMap)switch(s=t.substring(0,1),s){case"s":if((e.x-a.x)*(e.x-a.x)+(e.y-a.y)*(e.y-a.y)<=4*Y*Y&&n!==t)return!0}return!1},W.findStateNameConflict=e=>{let t,a;const s=e.id,n=e.name;for([t,a]of W.shMap)if("s"===t.substring(0,1)&&a.name===n&&t!==s)return a;return null},W.generateFreeID=e=>_[e]>=J?"":(_[e]+=1,e+(_[e]-1)),W.draw=()=>{let e;for(e of(F.clearRect(0,0,U.width,U.height),W.shMap.values()))e.draw()},W.addShape=(e,t)=>{W.shMap.set(e,t)},W.deleteShape=e=>{W.shMap.delete(e)},W.init=(e,t,a,s)=>{U=e,F=U.getContext("2d"),Y=t,z=a,J=s};var Q=W;let ee={},te={},ae={},se=0;const ne={stateSelectTransitionTarget:e=>{const t=te.activeShape,a=ee.findShape(e.offsetX,e.offsetY);if(null==a||"s"!==a.id.substring(0,1)||a.id===t.id)return;t.deactivate();const s=ae.transitionCreate(t,a);te.systemStateActivate("tr",s),ee.draw()},renameKeyDown:e=>{let t=e.keyCode||e.which;const a=te.activeShape;if(13===t&&ne.renameValidate())return te.systemStateActivate("s",a),ee.draw(),!0;if(e.ctrlKey)return t=String.fromCharCode(t),"L"!==t&&"G"!==t&&"S"!==t||(te.alphabet=t),!0;if(8===t)return a.nameRemoveChr(),ee.draw(),!0;t=String.fromCharCode(t);const s=te.symbols[te.alphabet][e.shiftKey?"C":"S"][t];return void 0===s||(a.nameAddChr(s),ee.draw()),!0},stateName:e=>"sr"===te.state&&(te.activeShape.nameAddChr(e),ee.draw(),!0),nameRemoveToken:()=>(te.activeShape.nameRemoveChr(),ee.draw(),!0),checkName:()=>{if(ne.renameValidate())return te.systemStateActivate("s",te.activeShape),ee.draw(),!0},stateRenameExitSelect:e=>{ne.renameValidate()&&te.systemStateMouseDown(e.offsetX,e.offsetY)},renameValidate:()=>{const e=te.activeShape;if(0===e.name.length)return alert("Please provide a name!"),!1;if("ð‘"===e.name)return alert("The name ð‘ is blocked!"),!1;return null!==ee.findStateNameConflict(e)?(alert("There already exists a state with this name!"),!1):(e.name!==te.nameOld&&(e.updateTransitions(),te.callback(ee.shMap)),!0)},stateActivateTransition:()=>{te.selectionTransitionTarget=!0},stateActivateRename:()=>{te.systemStateActivate("sr",te.activeShape)},stateActivateDelete:()=>{"s0"!==te.activeShape.id&&(ne.stateDelete(te.activeShape),te.systemStateActivate("i",null),ee.draw())},stateActivateIdle:()=>{te.selectionTransitionTarget=!1},stateCreate:e=>{const t=ee.generateFreeID("s");if(0===t.length)return alert("Only "+se+" states allowed, limit reached!"),!1;const a=new d(t,e.offsetX,e.offsetY);return ee.stateconflict(a)?(alert("Collision with another State"),!1):(ee.addShape(t,a),te.systemStateActivate("sr",a),ee.draw(),!1)},stateDelete:e=>{let t;for(t in e.deactivate(),e.transitions.in)ae.transitionDelete(ee.getShape(t),!1);for(t in e.transitions.out)ae.transitionDelete(ee.getShape(t),!1);for(t in e.transitions.factor)ae.transitionDelete(ee.getShape(t),!1);ee.deleteShape(e.id),te.callback(ee.shMap)},init:(e,t,a,s)=>{ee=e,te=t,ae=a,se=s}};var ie=ne;var oe=class{constructor(e,t,a){this.id=e,this.nameArr=[],this.name="",this.colour=c.transitionDefaultColour,this.lineWidth=1,this.shape={source:{point:{x:0,y:0}},target:{point:{x:0,y:0}}},this.factors=[],t.transitionAdd(this,"out"),a.transitionAdd(this,"in"),this.source=t,this.target=a,this.updateShape()}delete(){let e;for(e in this.deactivate(),this.source.transitionDelete(this,"out"),this.target.transitionDelete(this,"in"),this.factors)this.factors[e].transitionDelete(this,"factor")}setTarget(e){this.target.transitionDelete(this,"in"),this.target=e,e.transitionAdd(this,"in"),this.updateShape()}setSource(e){this.source.transitionDelete(this,"out"),this.source=e,e.transitionAdd(this,"out"),this.updateShape()}activate(){let e;for(e in this.colour=c.transitionSelectedColour,this.factors)this.factors[e].colour=c.transitionStateFactorColour}deactivate(){let e;for(e in this.colour=c.transitionDefaultColour,this.factors)this.factors[e].colour=c.stateDefaultColour}moveStart(e,t){}move(e,t){}moveStop(){}updateShape(){const e=(this.source.x+this.target.x)/2,t=(this.source.y+this.target.y)/2;this.shape.source.point=this.source.closestPointOnCircle(e,t),this.shape.target.point=this.target.closestPointOnCircle(e,t)}nameUpdate(){let e,t,a;const s=this.nameArr,n=s.length;for(this.name="",e=0;e<n;e+=1)[t,a]=s[e],this.name+="s"!==t?String.fromCodePoint(a):a.name}factorUpdate(){let e,t,a;const s=this.nameArr,n=s.length;for(e in this.factors)this.factors[e].transitionDelete(this,"factor"),this.factors[e].colour=c.stateDefaultColour;for(this.factors=[],e=0;e<n;e+=1)[t,a]=s[e],"s"===t&&(this.factors[a.id]=a,a.transitionAdd(this,"factor"),a.colour=c.transitionStateFactorColour)}nameAddToken(e,t){const a=this.nameArr,s=a.length,n=s>0?a[s-1][0]:"";return("o"!==e||"o"!==n)&&(this.nameArr.push([e,t]),this.nameUpdate(),this.factorUpdate(),!0)}nameRemoveToken(){return 0!==this.nameArr.length&&(this.nameArr.pop(),this.nameUpdate(),this.factorUpdate(),!0)}nameNormalize(){const e=this.nameArr,t=e.length;t>0&&"o"===e[t-1][0]&&this.nameRemoveToken()}draw(){const e=c.context;e.lineWidth=this.lineWidth,e.strokeStyle=this.colour,e.fillStyle=this.colour,e.font="20px Verdana, Geneva, Tahoma, sans-serif",e.textAlign="center",e.textBaseline="middle",e.beginPath(),e.moveTo(this.shape.source.point.x,this.shape.source.point.y),e.lineTo(this.shape.target.point.x,this.shape.target.point.y),e.stroke();let t=this.shape.target.point.x-this.shape.source.point.x,a=this.shape.target.point.y-this.shape.source.point.y;const s=Math.sqrt(t*t+a*a);t/=s,a/=s,e.beginPath(),e.moveTo(this.shape.target.point.x,this.shape.target.point.y),e.lineTo(this.shape.target.point.x-8*t+5*a,this.shape.target.point.y-8*a-5*t),e.lineTo(this.shape.target.point.x-8*t-5*a,this.shape.target.point.y-8*a+5*t),e.fill();let n=(this.shape.source.point.x+this.shape.target.point.x)/2,i=(this.shape.source.point.y+this.shape.target.point.y)/2;n+=15*a,i+=-15*t,e.fillText(this.name,n,i)}};let re={},le={},ce={},de=0;const he={transitionCreate:(e,t)=>{const a=re.generateFreeID("t");if(0===a.length)return alert("Only "+de+" transitions allowed, limit reached!"),null;const s=new oe(a,e,t);return re.addShape(a,s),s},transitionSelectTarget:e=>{ce.rearrangement();const t=re.findShape(e.offsetX,e.offsetY);null!==t&&"s"===t.id.substring(0,1)&&t.id!==le.activeShape.source.id&&t.id!==le.activeShape.target.id&&(ce.limitspAinreached(t)?alert("limit reached"):(le.activeShape.deactivate(),le.activeShape.setTarget(t),le.activeShape.activate(),ce.arrangement(),le.callback(re.shMap),re.draw()))},transitionSelectSource:e=>{ce.rearrangement();const t=re.findShape(e.offsetX,e.offsetY);null!=t&&"s"===t.id.substring(0,1)&&t.id!==le.activeShape.source.id&&t.id!==le.activeShape.target.id&&(ce.limitspAoutreached(t)?alert("limit reached"):(le.activeShape.deactivate(),le.activeShape.setSource(t),le.activeShape.activate(),ce.arrangement(),le.callback(re.shMap),re.draw()))},transitionSelectFactor:e=>{const t=re.findShape(e.offsetX,e.offsetY);null!==t&&"s"===t.id.substring(0,1)&&(le.activeShape.deactivate(),le.activeShape.toggleFactor(t),le.activeShape.activate(),le.callback(re.shMap),re.draw())},transitionActivateTarget:()=>{le.selectionTransitionTarget=!0},transitionActivateSource:()=>{le.selectionTransitionSource=!0},transitionActivateFactor:()=>{le.selectionTransitionFactor=!0},transitionActivateDelete:()=>{he.transitionDelete(le.activeShape),le.systemStateActivate("i",null),re.draw()},transitionActivateIdle:()=>{le.selectionTransitionTarget=!1,le.selectionTransitionSource=!1,le.selectionTransitionFactor=!1},transitionDelete:(e,t=!0)=>{e.delete(),re.deleteShape(e.id),t&&le.callback(re.shMap)},transitionActivateRename:()=>{le.systemStateActivate("tr",le.activeShape)},nameValidate:()=>{const e=le.activeShape;return 0===e.name.length?(alert("Please provide a name!"),!1):(e.name!==le.nameOld&&le.callback(re.shMap),!0)},nameAppendRate:e=>"tr"===le.state&&(le.activeShape.nameAddToken("r",e),re.draw(),!0),nameAppendPlus:()=>"tr"===le.state&&(le.activeShape.nameAddToken("o",65291),re.draw(),!0),nameConfirm:()=>"tr"===le.state&&(le.activeShape.nameNormalize(),re.draw(),!!he.nameValidate()&&(le.systemStateActivate("t",le.activeShape),re.draw(),!0)),transitionRenameExitSelect:e=>{le.activeShape.nameNormalize(),he.nameValidate()&&le.systemStateMouseDown(e.offsetX,e.offsetY)},nameAppendState:e=>"tr"===le.state&&(le.activeShape.nameAddToken("s",e),re.draw(),!0),nameRemoveToken:()=>"tr"===le.state&&(le.activeShape.nameRemoveToken(),re.draw(),!0),init:(e,t,a,s)=>{re=e,le=t,de=a,ce=s}};var ue=he;const pe=[],me={addListener:e=>{pe.push(e)},update:e=>{pe.forEach(t=>{t(e)})}};var be=me;let ve="http://www.w3.org/2000/svg",fe=35;const ge={setNS:e=>{ve=e},getNS:()=>ve,setKeySize:e=>{fe=e},getKeySize:()=>fe,createKey:function(e,t,a){const s=document.createElementNS(ve,"g");return s.setAttributeNS(null,"transform","translate("+e+","+t+")"),s.appendChild(function(){const e=document.createElementNS(ve,"rect");return e.setAttributeNS(null,"x",0),e.setAttributeNS(null,"y",0),e.setAttributeNS(null,"width",fe),e.setAttributeNS(null,"height",fe),e.style.strokeWidth=1,e.style.stroke="black",e.setAttributeNS(null,"fill","white"),e}()),s.appendChild(function(e){const t=document.createElementNS(ve,"text");return t.setAttributeNS(null,"x",.5*fe),t.setAttributeNS(null,"y",.5*fe),t.style.textAnchor="middle",t.style.alignmentBaseline="central",t.style.font="20px Verdana, Geneva, Tahoma, sans-serif",t.style.fill="black",t.style.pointerEvents="none",t.innerHTML=e,t}(a)),s}};var Se=ge;let ye="http://www.w3.org/2000/svg",we=35,Ie=13;const ke={check:null,del:null,plus:null,L:null,G:null,S:null,up:null,low:null,Del:null,R:null,T:null,X:null,target:null,source:null,in:null,out:null,checkenter:null,Deleteenter:null,Renter:null,inenter:null,outenter:null,Lenter:null,Genter:null,Senter:null,upenter:null,lowenter:null,Tenter:null,Xenter:null,targetenter:null,sourceenter:null},Ce=10003,De=11013,xe=65291,Ae=76,$e=71,Ee=83,Me=8593,Re=8595,Te=9249,Oe=82,Pe=8594,Ke=88,Be=8614,Xe=8620,He=8681,Le=8679;function je(e,t){t.addEventListener("mousedown",t=>(t.preventDefault(),0!==t.button||ke[e](),!1))}function Ne(e,t){t.addEventListener("mouseenter",t=>(t.preventDefault(),0!==t.button||ke[e](),!1))}const Ge={setNS:e=>{ye=e},getNS:()=>ye,setKeySize:e=>{we=e},getKeySize:()=>we,setColoumnCount:e=>{Ie=e},getColoumnCount:()=>Ie,setHandler:(e,t)=>{ke[e]=t},getHandler:e=>ke[e],create:function(e,t,a){let s,n;Se.setKeySize(we),Se.setNS(ye);const i=document.createElementNS(ye,"g");switch(i.setAttributeNS(null,"transform","translate("+e+","+t+")"),a){case"s":n=String.fromCodePoint(Te),s=Se.createKey(we*(Ie-13),0,n),je("Del",s),Ne("Deleteenter",s),i.appendChild(s),n=String.fromCodePoint(Oe),s=Se.createKey(we*(Ie-12),0,n),je("R",s),Ne("Renter",s),i.appendChild(s),n=String.fromCodePoint(Pe),s=Se.createKey(we*(Ie-11),0,n),je("T",s),Ne("Tenter",s),i.appendChild(s),n=String.fromCodePoint(He),s=Se.createKey(we*(Ie-10),0,n),je("in",s),Ne("inenter",s),i.appendChild(s),n=String.fromCodePoint(Le),s=Se.createKey(we*(Ie-9),0,n),je("out",s),Ne("outenter",s),i.appendChild(s);break;case"t":n=String.fromCodePoint(Te),s=Se.createKey(we*(Ie-13),0,n),je("Del",s),Ne("Deleteenter",s),i.appendChild(s),n=String.fromCodePoint(Oe),s=Se.createKey(we*(Ie-12),0,n),je("R",s),i.appendChild(s),Ne("Renter",s),n=String.fromCodePoint(Be),s=Se.createKey(we*(Ie-11),0,n),je("target",s),Ne("targetenter",s),i.appendChild(s),n=String.fromCodePoint(Xe),s=Se.createKey(we*(Ie-10),0,n),je("source",s),Ne("sourceenter",s),i.appendChild(s);break;case"tspecialin":n=String.fromCodePoint(Te),s=Se.createKey(we*(Ie-13),0,n),je("Del",s),Ne("Deleteenter",s),i.appendChild(s),n=String.fromCodePoint(Oe),s=Se.createKey(we*(Ie-12),0,n),je("R",s),Ne("Renter",s),i.appendChild(s),n=String.fromCodePoint(Be),s=Se.createKey(we*(Ie-11),0,n),je("target",s),Ne("targetenter",s),i.appendChild(s);break;case"tspecialout":n=String.fromCodePoint(Te),s=Se.createKey(we*(Ie-13),0,n),je("Del",s),Ne("Deleteenter",s),i.appendChild(s),n=String.fromCodePoint(Oe),s=Se.createKey(we*(Ie-12),0,n),je("R",s),Ne("Renter",s),i.appendChild(s),n=String.fromCodePoint(Xe),s=Se.createKey(we*(Ie-10),0,n),je("source",s),Ne("sourceener",s),i.appendChild(s);break;case"X":n=String.fromCodePoint(Ke),s=Se.createKey(we*(Ie-13),0,n),je("X",s),Ne("Xenter",s),i.appendChild(s);break;case"name":n=String.fromCodePoint(xe),s=Se.createKey(we*(Ie-5),0,n),je("plus",s),i.appendChild(s),n=String.fromCodePoint(De),s=Se.createKey(we*(Ie-3),0,n),je("del",s),i.appendChild(s),n=String.fromCodePoint(Ce),s=Se.createKey(we*(Ie-1),0,n),je("check",s),Ne("checkenter",s),i.appendChild(s),n=String.fromCodePoint(Ae),s=Se.createKey(we*(Ie-13),0,n),je("L",s),Ne("Lenter",s),i.appendChild(s),n=String.fromCodePoint($e),s=Se.createKey(we*(Ie-12),0,n),je("G",s),Ne("Genter",s),i.appendChild(s),n=String.fromCodePoint(Ee),s=Se.createKey(we*(Ie-11),0,n),je("S",s),Ne("Senter",s),i.appendChild(s),n=String.fromCodePoint(Me),s=Se.createKey(we*(Ie-9),0,n),je("up",s),Ne("upenter",s),i.appendChild(s),n=String.fromCodePoint(Re),s=Se.createKey(we*(Ie-8),0,n),je("low",s),Ne("lowenter",s),i.appendChild(s)}return i}};var Ve=Ge;let Fe="http://www.w3.org/2000/svg",Ue=35,ze=13,Ye=null;function Je(e,t){t.addEventListener("mousedown",t=>(t.preventDefault(),0!==t.button||Ye(e),!1))}const _e={setNS:e=>{Fe=e},getNS:()=>Fe,setKeySize:e=>{Ue=e},getKeySize:()=>Ue,setColoumnCount:e=>{ze=e},getColoumnCount:()=>ze,setHandler:e=>{Ye=e},getHandler:()=>Ye,createAlphabet:function(e,t,a,s){let n,i,o,r,c=0,d=0,h=65;Se.setKeySize(Ue),Se.setNS(Fe);const u=document.createElementNS(Fe,"g");for(u.setAttributeNS(null,"transform","translate("+e+","+t+")");h<91;)n=String.fromCharCode(h),i=l[a][s][n],void 0!==i&&(o=String.fromCodePoint(i),r=Se.createKey(d*Ue,c*Ue,o),Je(i,r),u.appendChild(r),d+=1,d===ze&&(d=0,c+=1)),h+=1;return u}};var We=_e;let qe=35,Ze=13,Qe="http://www.w3.org/2000/svg",et=null;const tt={};function at(e,t){t.addEventListener("mousedown",t=>(t.preventDefault(),0!==t.button||et(e),!1))}tt.setNS=e=>{Qe=e},tt.getNS=()=>Qe,tt.setKeySize=e=>{qe=e},tt.getKeySize=()=>qe,tt.setColoumnCount=e=>{Ze=e},tt.getColoumnCount=()=>Ze,tt.getHandler=()=>et,tt.setHandler=e=>{et=e},tt.create=function(e,t,a){let s,n,i,o=0,r=0;Se.setKeySize(qe),Se.setNS(Qe);const l=document.createElementNS(Qe,"g");for([s,n]of(l.setAttributeNS(null,"transform","translate("+e+","+t+")"),a))"n"===s.substring(0,1)&&(i=Se.createKey(r*qe,o*qe,n.name),at(n,i),l.appendChild(i),r+=1,r===Ze&&(r=0,o+=1)),"s"===s.substring(0,1)&&(i=Se.createKey(r*qe,o*qe,n.name),at(n,i),l.appendChild(i),r+=1,r===Ze&&(r=0,o+=1));return l};var st=tt;let nt="http://www.w3.org/2000/svg",it=13,ot=35,rt=10,lt=null,ct=null,dt=null,ht=null,ut=null,pt=null,mt=null;const bt={plus:null,del:null,check:null,L:null,G:null,S:null,up:null,low:null,Del:null,R:null,T:null,X:null,target:null,source:null,in:null,out:null,checkenter:null,Deleteenter:null,Renter:null,inenter:null,outenter:null,Lenter:null,Genter:null,Senter:null,upenter:null,lowenter:null,Tenter:null,Xenter:null,targetenter:null,sourceenter:null};let vt=[10,55];const ft={};function gt(){st.setColoumnCount(it),st.setKeySize(ot),st.setNS(nt),st.setHandler(mt)}function St(e){gt();const t=st.create(vt[0],vt[1],e);null!==ht&&ct.removeChild(ht),ct.appendChild(t),ht=t}ft.updateAlphabet=(e,t)=>{ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,e,t),ct.appendChild(dt)},ft.Alphabetvisibility=e=>{dt.setAttributeNS(null,"visibility",e)},ft.updateAlphabetCase=e=>{if("up"==e){let e=dt.getElementsByTagName("text")[0].innerHTML;switch(e=e.charCodeAt(1),e){case 56398:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"L","C"),ct.appendChild(dt);break;case 57084:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"G","C"),ct.appendChild(dt);break;case 57110:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"S","C"),ct.appendChild(dt)}}else{let e=dt.getElementsByTagName("text")[0].innerHTML;switch(e=e.charCodeAt(1),e){case 56372:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"L","S"),ct.appendChild(dt);break;case 57058:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"G","S"),ct.appendChild(dt);break;case 57075:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"S","S"),ct.appendChild(dt)}}},ft.updateSpecialKeys=e=>{ct.removeChild(ut),ut=Ve.create(rt,rt,e),ct.appendChild(ut)},ft.StateKeysvisibility=e=>{ht.setAttributeNS(null,"visibility",e)},ft.visibility=e=>{ct.setAttributeNS(null,"visibility",e)},ft.init=(e,t)=>{lt=e,function(){const e=2*rt+ot*it,t=4*rt+5*ot;ct=document.createElementNS(nt,"svg"),ct.setAttributeNS(null,"width",e+"px"),ct.setAttributeNS(null,"height",t+"px")}(),Ve.setKeySize(ot),Ve.setNS(nt),Ve.setColoumnCount(it),Ve.setHandler("plus",bt.plus),Ve.setHandler("del",bt.del),Ve.setHandler("check",bt.check),Ve.setHandler("L",bt.L),Ve.setHandler("G",bt.G),Ve.setHandler("S",bt.S),Ve.setHandler("up",bt.up),Ve.setHandler("low",bt.low),Ve.setHandler("Del",bt.Del),Ve.setHandler("R",bt.R),Ve.setHandler("T",bt.T),Ve.setHandler("X",bt.X),Ve.setHandler("target",bt.target),Ve.setHandler("source",bt.source),Ve.setHandler("in",bt.in),Ve.setHandler("out",bt.out),Ve.setHandler("checkenter",bt.checkenter),Ve.setHandler("Deleteenter",bt.Deleteenter),Ve.setHandler("Renter",bt.Renter),Ve.setHandler("inenter",bt.inenter),Ve.setHandler("outenter",bt.outenter),Ve.setHandler("Senter",bt.Senter),Ve.setHandler("Genter",bt.Genter),Ve.setHandler("Lenter",bt.Lenter),Ve.setHandler("upenter",bt.upenter),Ve.setHandler("lowenter",bt.lowenter),Ve.setHandler("Tenter",bt.Tenter),Ve.setHandler("Xenter",bt.Xenter),Ve.setHandler("targetenter",bt.targetenter),Ve.setHandler("sourceenter",bt.sourceenter),We.setColoumnCount(it),We.setKeySize(ot),We.setNS(nt),We.setHandler(pt),gt(),t.addListener(St),vt=[rt,3*rt+3*ot],ut=Ve.create(rt,rt,"name"),ct.appendChild(ut),dt=We.createAlphabet(rt,2*rt+ot,"L","C"),ct.appendChild(dt),lt.appendChild(ct),ct.setAttributeNS(null,"visibility","hidden"),document.getElementById("inID").style.visibility="hidden"},ft.setNS=e=>{nt=e},ft.getNS=()=>nt,ft.setKeySize=e=>{ot=e},ft.getKeySize=()=>ot,ft.setColoumnCount=e=>{it=e},ft.getColoumnCount=()=>it,ft.setAlphabetHandler=e=>{pt=e},ft.getAlphabetHandler=()=>pt,ft.setStateKeyHandler=e=>{mt=e},ft.getStateKeyHandler=()=>mt,ft.setPadding=e=>{rt=e},ft.setSpecialKeyHandler=(e,t)=>{bt[e]=t},ft.getSpecialKeyHandler=e=>bt[e],ft.getPadding=()=>rt;var yt=ft;let wt={},It={},kt={},Ct={},Dt={},xt=0;const At={updateAlphabetL:()=>{yt.updateAlphabet("L","C")},updateAlphabetG:()=>{yt.updateAlphabet("G","S")},updateAlphabetS:()=>{yt.updateAlphabet("S","S")},updateAlphabetlow:()=>{yt.updateAlphabetCase("low")},updateAlphabetup:()=>{yt.updateAlphabetCase("up")},letterIn:e=>{switch(wt.state[0]){case"s":kt.stateName(e);break;case"t":It.nameAppendRate(e)}},RemoveTolken:()=>{switch(wt.state){case"sr":kt.nameRemoveToken();break;case"tr":It.nameRemoveToken()}},check:()=>{switch(wt.state[0]){case"s":kt.checkName();break;case"t":It.nameConfirm()}},delete:()=>{switch(wt.state[0]){case"s":kt.stateActivateDelete();break;case"t":Ct.rearrangement(),It.transitionActivateDelete()}},rename:()=>{switch(wt.state[0]){case"s":kt.stateActivateRename();break;case"t":It.transitionActivateRename()}},arrowIn:()=>{Ct.specialArrowCreate("in")},arrowOut:()=>{Ct.specialArrowCreate("out")},newTransition:()=>{kt.stateActivateTransition(),yt.updateSpecialKeys("X")},leaveX:()=>{switch(wt.state){case"s":kt.stateActivateIdle(),yt.updateSpecialKeys("s"),At.systemupdate("s");break;case"t":It.transitionActivateIdle(),yt.updateSpecialKeys("t"),At.systemupdate("t")}},transitiontarget:()=>{It.transitionActivateTarget(),yt.updateSpecialKeys("X")},transitionsource:()=>{It.transitionActivateSource(),yt.updateSpecialKeys("X")},showinfo:e=>{let t=window.event,a=document.getElementById("infoID");a.style.left=t.clientX+"px";let s=t.clientY-50;a.style.top=s+"px",a.style.visibility="visible",a.innerHTML=e,0===xt&&(xt++,setTimeout((function(){a.style.visibility="hidden",xt=0}),1250))},systemupdate:e=>{let t=document.getElementById("inID");switch(e){case"s":t.style.visibility="visible",yt.visibility("visible"),yt.updateSpecialKeys("s"),yt.Alphabetvisibility("hidden"),yt.StateKeysvisibility("hidden");break;case"sr":t.style.visibility="visible",yt.visibility("visible"),At.updateAlphabetL(),yt.Alphabetvisibility("visible"),yt.updateSpecialKeys("name"),yt.StateKeysvisibility("hidden");break;case"sm":t.style.visibility="hidden",yt.visibility("hidden"),yt.Alphabetvisibility("hidden");break;case"t":switch(wt.activeShape.type){case void 0:t.style.visibility="visible",yt.visibility("visible"),yt.updateSpecialKeys("t"),yt.Alphabetvisibility("hidden"),yt.StateKeysvisibility("hidden");break;case"in":t.style.visibility="visible",yt.visibility("visible"),yt.updateSpecialKeys("tspecialin"),yt.Alphabetvisibility("hidden"),yt.StateKeysvisibility("hidden");break;case"out":t.style.visibility="visible",yt.visibility("visible"),yt.updateSpecialKeys("tspecialout"),yt.Alphabetvisibility("hidden"),yt.StateKeysvisibility("hidden")}break;case"tr":t.style.visibility="visible",yt.visibility("visible"),At.updateAlphabetG(),yt.Alphabetvisibility("visible"),yt.updateSpecialKeys("name"),yt.StateKeysvisibility("visible");break;case"tm":case"i":t.style.visibility="hidden",yt.visibility("hidden"),yt.Alphabetvisibility("hidden"),yt.StateKeysvisibility("hidden")}},checkenter:()=>{let e=Dt.check;At.showinfo(e)},Deleteenter:()=>{let e=Dt.Delete;switch(wt.state){case"s":e+=" state";break;case"t":void 0!==wt.activeShape.type?e+=" special arrow":e+=" transition"}At.showinfo(e)},Renter:()=>{let e=Dt.rename;At.showinfo(e)},inenter:()=>{let e=Dt.in;At.showinfo(e)},outenter:()=>{let e=Dt.out;At.showinfo(e)},Senter:()=>{let e=Dt.S;At.showinfo(e)},Genter:()=>{let e=Dt.G;At.showinfo(e)},Lenter:()=>{let e=Dt.L;At.showinfo(e)},upenter:()=>{let e=Dt.up;At.showinfo(e)},lowenter:()=>{let e=Dt.low;At.showinfo(e)},Tenter:()=>{let e=Dt.T;At.showinfo(e)},Xenter:()=>{let e=Dt.X;At.showinfo(e)},tagetenter:()=>{let e=Dt.target;At.showinfo(e)},sourceenter:()=>{let e=Dt.source;At.showinfo(e)},init:(e,t,a,s,n)=>{wt=e,It=t,kt=a,Ct=s,Dt=n}};var $t=At;var Et=class extends oe{constructor(e,t,a,s){super(e,t,a),this.type=s}};let Mt={},Rt={},Tt=0;const Ot={returnstates:e=>{let t,a,s,n=[];for([t,a]of Mt.shMap)s=t.substring(0,1),"t"===s&&void 0!==a.type&&(a.source===e?n.push(a.target):a.target===e&&n.push(a.source));return n},specialArrowCreate:e=>{const t=Mt.generateFreeID("s"),a=Mt.generateFreeID("t");let s,n=Rt.activeShape.x,i=Rt.activeShape.y,o=0,r=0,l=0,c=0;const h=Ot.returnstates(Rt.activeShape);for(let e=0;e<h.length;e++)Rt.activeShape.x-h[e].x<=0&&Rt.activeShape.y-h[e].y>0||h[e].x-Rt.activeShape.x>0&&h[e].y-Rt.activeShape.y>0?l++:c++;if(l===Tt&&"in"===e||c===Tt&&"out"===e)return alert("Only "+Tt+" specialArrows allowed, limit reached!"),null;const u=Math.PI/Tt;switch(e){case"in":o=100*Math.cos(Math.PI/2-u*l),r=100*Math.cos(u*l);const h=new d(t,n+o,i-r,1);s=new Et(a,h,Rt.activeShape,e);break;case"out":o=100*Math.cos(Math.PI/2-u*c),r=100*Math.cos(u*c);const p=new d(t,n-o,i+r,1);s=new Et(a,Rt.activeShape,p,e)}return Mt.addShape(a,s),Rt.activeShape.deactivate(),Rt.systemStateActivate("tr",s),Mt.draw(),!1},rearrangement:()=>{let e=null;switch(Rt.activeShape.type){case"in":e=Rt.activeShape.target;break;case"out":e=Rt.activeShape.source}let t,a,s,n=0,i=0,o=0,r=0;const l=Math.PI/Tt;for([t,a]of Mt.shMap)s=t.substring(0,1),"t"===s&&void 0!==a.type&&t!=Rt.activeShape.id&&(a.source===e?(o=100*Math.cos(Math.PI/2-l*i),r=100*Math.cos(l*i),i++,a.target.move(e.x-o,e.y+r)):a.target===e&&(o=100*Math.cos(Math.PI/2-l*n),r=100*Math.cos(l*n),n++,a.source.move(e.x+o,e.y-r)))},arrangement:(e=Rt.activeShape)=>{let t=null;switch(e.type){case"in":t=e.target;break;case"out":t=e.source}let a,s,n,i=0,o=0,r=0,l=0;const c=Math.PI/Tt;for([a,s]of Mt.shMap)n=a.substring(0,1),"t"===n&&void 0!==s.type&&(s.source===t?(r=100*Math.cos(Math.PI/2-c*o),l=100*Math.cos(c*o),o++,s.target.move(t.x-r,t.y+l)):s.target===t&&(r=100*Math.cos(Math.PI/2-c*i),l=100*Math.cos(c*i),i++,s.source.move(t.x+r,t.y-l)))},arrangementstate:(e=Rt.activeShape)=>{let t,a,s,n=0,i=0,o=0,r=0;const l=Math.PI/Tt;for([t,a]of Mt.shMap)s=t.substring(0,1),"t"===s&&void 0!==a.type&&("out"===a.type&&a.source===e?(o=100*Math.cos(Math.PI/2-l*i),r=100*Math.cos(l*i),i++,a.target.move(e.x-o,e.y+r)):"in"===a.type&&a.target===e&&(o=100*Math.cos(Math.PI/2-l*n),r=100*Math.cos(l*n),n++,a.source.move(e.x+o,e.y-r)))},limitspAoutreached:(e=Rt.activeShape)=>{let t,a,s,n=0;for([t,a]of Mt.shMap)s=t.substring(0,1),"t"===s&&"out"===a.type&&a.source===e&&n++;return n>=Tt},limitspAinreached:(e=Rt.activeShape)=>{let t,a,s,n=0;for([t,a]of Mt.shMap)s=t.substring(0,1),"t"===s&&"in"===a.type&&a.target===e&&n++;return n>=Tt},init:(e,t,a)=>{Mt=e,Rt=t,Tt=a}};var Pt=Ot;const Kt={};Kt.help=n,Kt.symbols=l,Kt.alphabet="L",Kt.callback=be.update,Kt.activeShape=null,Kt.selectionTransitionTarget=!1,Kt.selectionTransitionSource=!1,Kt.selectionTransitionFactor=!1,Kt.state="i",Kt.nameOld="",Kt.initState=()=>{let e="n",t=new d(e,0,0,0);Q.addShape(e,t);let a=78;t.nameAddChr(a),e=Q.generateFreeID("s"),t=new d(e,2*c.stateRadius,2*c.stateRadius),Q.addShape(e,t),a=Kt.symbols.L.C.S,t.nameAddChr(a)},Kt.init=()=>{c.canvas=document.getElementById("canvasID"),c.context=c.canvas.getContext("2d"),Q.init(c.canvas,c.stateRadius,c.hitTargetPadding,c.instancesLimit),ue.init(Q,Kt,c.instancesLimit,Pt),Pt.init(Q,Kt,c.specialArrowLimit),ie.init(Q,Kt,ue,c.instancesLimit),$t.init(Kt,ue,ie,Pt,o),Kt.helpBox=document.getElementById("helpID"),Kt.helpBox.innerHTML=Kt.help.i,V(c.canvas,Kt,ie,ue,c.stateKeys,c.transitionKeys),Kt.initState(),Q.draw(),Kt.callback(Q.shMap)},Kt.systemStateActivate=(e,t)=>{null!=t&&t.activate(),Kt.nameOld=null!=t?t.name:"",Kt.activeShape=t,Kt.state=e,Kt.selectionTransitionFactor=!1,Kt.selectionTransitionSource=!1,Kt.selectionTransitionTarget=!1,Kt.alphabet="tr"===e?"G":"L",Kt.helpBox.innerHTML=Kt.help[e],$t.systemupdate(e)},Kt.systemStateMouseDown=(e,t)=>{const a=Q.findShape(e,t);let s="i";if(null!=a){s=a.id.substring(0,1)+"m",a.moveStart(e,t);let n=Pt.returnstates(a);if(0!==n.length)for(let a=0;a<n.length;a++)n[a].moveStart(e,t)}"i"!==Kt.state&&Kt.activeShape.deactivate(),Kt.systemStateActivate(s,a),Q.draw()},Kt.moveStop=()=>{if(Kt.state.length>1&&"m"===Kt.state.substring(1,2)){Kt.activeShape.moveStop();let e=Pt.returnstates(Kt.activeShape);if(0!==e.length)for(let t=0;t<e.length;t++)e[t].moveStop();Kt.systemStateActivate(Kt.state.substring(0,1),Kt.activeShape)}},Kt.moveObject=e=>{Kt.activeShape.move(e.offsetX,e.offsetY);let t=Pt.returnstates(Kt.activeShape);if(0!==t.length)for(let a=0;a<t.length;a++)t[a].move(e.offsetX,e.offsetY);for(let e=0;e<t.length;e++)if(t[e].y<2){Kt.moveStop(),Kt.activeShape.move(Kt.activeShape.x,102),t[e].move(t[e].x,2);for(let e=0;e<t.length;e++)t[e].moveStop();Pt.arrangementstate()}else if(t[e].x<Kt.activeShape.radius){Kt.moveStop(),Kt.activeShape.move(Kt.activeShape.radius+102,Kt.activeShape.y);for(let e=0;e<t.length;e++)t[e].moveStop();Pt.arrangementstate()}if(Q.stateconflict(Kt.activeShape)){if(Kt.moveStop(),0!==t.length)for(let e=0;e<t.length;e++)t[e].moveStop();let e=0,a=0,s=1;for(;Q.stateconflict(Kt.activeShape);){for(;e<=s&&Q.stateconflict(Kt.activeShape);e++)if(Kt.activeShape.move(Kt.activeShape.x+e,Kt.activeShape.y+a),0!==t.length)for(let s=0;s<t.length;s++)t[s].move(t[s].x+e,t[s].y+a);for(;a<=s&&Q.stateconflict(Kt.activeShape);a++)if(Kt.activeShape.move(Kt.activeShape.x+e,Kt.activeShape.y+a),0!==t.length)for(let s=0;s<t.length;s++)t[s].move(t[s].x+e,t[s].y+a);for(s++;e>=-s&&Q.stateconflict(Kt.activeShape);e--)if(Kt.activeShape.move(Kt.activeShape.x+e,Kt.activeShape.y+a),0!==t.length)for(let s=0;s<t.length;s++)t[s].move(t[s].x+e,t[s].y+a);for(;a>=-s&&Q.stateconflict(Kt.activeShape);a--)if(Kt.activeShape.move(Kt.activeShape.x+e,Kt.activeShape.y+a),0!==t.length)for(let s=0;s<t.length;s++)t[s].move(t[s].x+e,t[s].y+a);s++}}Q.draw()};var Bt=Kt;const Xt={};let Ht={},Lt={};function jt(e){const t=[],a=e.nameArr.length,s=e.source;let n,i,o,r=0;if(0===a)return t;for(t[0]=[],n=0;n<a;n+=1)[i,o]=e.nameArr[n],"o"===i?(t[r].push(["s",s]),r+=1,t[r]=[]):0!==o.radius?t[r].push([i,o]):t[r].push(["n",o]);return t[r].push(["s",s]),t}function Nt(e){const t=[],a=e.nameArr.length;let s,n,i,o=0;if(0===a)return t;for(t[0]=[],s=0;s<a;s+=1)[n,i]=e.nameArr[s],"o"===n?(o+=1,t[o]=[]):0!==i.radius?t[o].push([n,i]):t[o].push(["n",i]);return t}function Gt(e,t,a){let s;const n=t.length,i=Lt.get(e);for(s=0;s<n;s+=1)i.push({sign:a,prod:t[s]})}Xt.odeBuild=e=>{let t,a,s;for([t,a]of(function(e){let t,a;for([t,a]of(Lt=new Map,e))"s"===t.substring(0,1)&&Lt.set(a,[])}(e),e))"t"===t.substring(0,1)&&(void 0!==a.type?(s=Nt(a),"in"===a.type?Gt(a.target,s,1):Gt(a.source,s,-1)):(s=jt(a),Gt(a.source,s,-1),Gt(a.target,s,1)))},Xt.update=e=>{let t,a,s,n,i,o,r,l,c,d,h,u,p,m=0,b=0,v=[];const f=String.fromCodePoint(8339);for([n,i]of(Xt.odeBuild(e),t="<table>",Lt))if("N"!==n.name){for(v.push(n.name),a="<tr><td align='right'>",a=n.nameArr.length>1?a+"("+n.name+")"+f:a+n.name+f,a+="</td>",a+="<td align='center'>=</td>",a+="<td align='left'><div class='odeEquation'>",o=i.length,p=!1,r=0;r<o;r+=1){for(b=0,s=i[r].sign<0?"â€“":p?"+":"",l=i[r].prod,c=l.length,d=0;d<c;d+=1)[h,u]=l[d],"s"===h?(u=u.name,b++):u="n"===h?u.name:String.fromCodePoint(u),s+=u;if(b>1){switch(s+="N",s+=String.fromCodePoint(8315),b--,b){case 1:m=185;break;case 2:m=178;break;case 3:m=179;break;default:m=8304+b}s+=String.fromCodePoint(m)}a+=s,p=!0}p||(a+="0"),a+="</div></td></tr>",t+=a}a="<tr><td align='right'>N</td><td align='center'>=</td><td align='left'><div class='odeEquation'>";for(let e=0;e<v.length;e++)e>0&&(a+="+"),a+=v[e];a+="</div></td></tr>",t+=a,t+="</table>",Ht.innerHTML=t},Xt.init=e=>{Ht=e},Xt.getODEs=()=>Lt;var Vt=Xt;var Ft=function(){const e={},t=Vt.getODEs();return e.states=function(e){const t=new Map;return e.forEach((e,a)=>{t.set(a.id,a.name)}),t}(t),e.rates=function(e){const t=new Set;return e.forEach(e=>{e.forEach(e=>{e.prod.forEach(e=>{"r"===e[0]&&t.add(String.fromCodePoint(e[1]))})})}),t}(t),e.equations=function(e){const t=new Map;return e.forEach((e,a)=>{const s=[];e.forEach(e=>{const t={};t.sign=e.sign,t.prod=[],e.prod.forEach(e=>{const a="r"===e[0]?[e[0],String.fromCodePoint(e[1])]:[e[0],e[1].id];t.prod.push(a)}),s.push(t)}),t.set(a.id,s)}),t}(t),e};const Ut={init:()=>{Vt.init(document.getElementById("odeID")),be.addListener(Vt.update),yt.setAlphabetHandler($t.letterIn),yt.setStateKeyHandler(ue.nameAppendState),yt.setSpecialKeyHandler("plus",ue.nameAppendPlus),yt.setSpecialKeyHandler("del",$t.RemoveTolken),yt.setSpecialKeyHandler("check",$t.check),yt.setSpecialKeyHandler("L",$t.updateAlphabetL),yt.setSpecialKeyHandler("G",$t.updateAlphabetG),yt.setSpecialKeyHandler("S",$t.updateAlphabetS),yt.setSpecialKeyHandler("up",$t.updateAlphabetup),yt.setSpecialKeyHandler("low",$t.updateAlphabetlow),yt.setSpecialKeyHandler("Del",$t.delete),yt.setSpecialKeyHandler("R",$t.rename),yt.setSpecialKeyHandler("T",$t.newTransition),yt.setSpecialKeyHandler("X",$t.leaveX),yt.setSpecialKeyHandler("target",$t.transitiontarget),yt.setSpecialKeyHandler("source",$t.transitionsource),yt.setSpecialKeyHandler("in",$t.arrowIn),yt.setSpecialKeyHandler("out",$t.arrowOut),yt.setSpecialKeyHandler("checkenter",$t.checkenter),yt.setSpecialKeyHandler("Deleteenter",$t.Deleteenter),yt.setSpecialKeyHandler("Renter",$t.Renter),yt.setSpecialKeyHandler("inenter",$t.inenter),yt.setSpecialKeyHandler("outenter",$t.outenter),yt.setSpecialKeyHandler("Genter",$t.Genter),yt.setSpecialKeyHandler("Lenter",$t.Lenter),yt.setSpecialKeyHandler("Senter",$t.Senter),yt.setSpecialKeyHandler("upenter",$t.upenter),yt.setSpecialKeyHandler("lowenter",$t.lowenter),yt.setSpecialKeyHandler("Tenter",$t.Tenter),yt.setSpecialKeyHandler("Xenter",$t.Xenter),yt.setSpecialKeyHandler("targetenter",$t.tagetenter),yt.setSpecialKeyHandler("sourceenter",$t.sourceenter),yt.init(document.getElementById("inID"),be),Bt.init()}};Ut.getODEs=Ft;var zt=Ut;const Yt={};function Jt(){const e=Yt.board.create("point",[0,0],{needsRegularUpdate:!1,visible:!1}),t=Yt.board.create("point",[1,0],{needsRegularUpdate:!1,visible:!1}),a=Yt.board.create("axis",[e,t],{needsRegularUpdate:!1,name:"$t$",withLabel:!0,label:{position:"rt",offset:[-5,8]}});a.removeAllTicks();const s=Yt.board.create("ticks",[a,1],{offset:[-10,-10],precision:5,minorTicks:0,drawLabels:!0,grid:!0,majorHeight:-1,strokeColor:"#ccc"});let n,i,o;s.ticksFunction=()=>n,Yt.board.fullUpdate();let r=[];const l=Yt.board.create("point",[0,0],{needsRegularUpdate:!1,visible:!1}),c=Yt.board.create("point",[0,1],{needsRegularUpdate:!1,visible:!1}),d=Yt.board.create("axis",[l,c],{needsRegularUpdate:!1,withLabel:!0,label:{position:"rt",offset:[-5,8]}});d.removeAllTicks();const h=Yt.board.create("ticks",[d,1],{strokeColor:"#ccc",label:{offset:[10,0]},precision:8,minorTicks:0,drawLabels:!0,drawZero:!1,majorHeight:-1});h.ticksFunction=()=>i,Yt.board.fullUpdate();const u=function(){o=Yt.board.getBoundingBox();const e=10**Math.floor(Math.log10(.6*(o[2]-o[0])));n=(o[2]-o[0])/e>5?e:.5*e;const t=10**Math.floor(Math.log10(.6*(o[1]-o[3])));i=(o[1]-o[3])/t>5?t:.5*t,Yt.board.fullUpdate()};u();const p=Yt.board.create("point",[0,0],{visible:!1});Yt.upperAxis=30,Yt.lowerAxis=Yt.board.canvasHeight-30,Yt.board.on("boundingbox",()=>{console.time("Axis"),o=Yt.board.getBoundingBox();const n=new JXG.Coords(JXG.COORDS_BY_USER,[0,p.Y()],Yt.board).scrCoords[2],i=new JXG.Coords(JXG.COORDS_BY_USER,[0,p.X()],Yt.board).scrCoords[1];var m;n<=10?(a.point1.setAttribute({frozen:!0}),a.point2.setAttribute({frozen:!0}),s.visProp.label.offset=[-10,-10]):n>Yt.board.canvasHeight-10?(e.moveTo((m=Yt.board.canvasHeight-10,r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,m],Yt.board),r.usrCoords),0),t.moveTo((e=>(r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[Yt.board.canvasWidth,e],Yt.board),r.usrCoords))(Yt.board.canvasHeight-10),0),a.point1.setAttribute({frozen:!0}),a.point2.setAttribute({frozen:!0}),s.visProp.label.offset=[-10,9]):(a.point1.setAttribute({frozen:!1}),a.point2.setAttribute({frozen:!1}),e.moveTo([0,Yt.yPost(0)],0),t.moveTo([1,Yt.yPost(0)],0),e.moveTo([0,0],0),t.moveTo([1,0],0),s.visProp.label.offset=[-10,-10]),i<10?(l.moveTo((e=>(r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,Yt.board.canvasHeight],Yt.board),r.usrCoords))(10),0),c.moveTo((e=>(r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,0],Yt.board),r.usrCoords))(10),0),d.point1.setAttribute({frozen:!0}),d.point2.setAttribute({frozen:!0}),h.visProp.label.offset=[7,0]):i>Yt.board.canvasWidth-10?(d.point1.setAttribute({frozen:!0}),d.point2.setAttribute({frozen:!0}),h.visProp.label.offset=[-28,0],h.visProp.label.align="right"):(d.point1.setAttribute({frozen:!1}),d.point2.setAttribute({frozen:!1}),l.moveTo([0,0],0),c.moveTo([0,1],0)),u(),console.timeEnd("Axis")}),Yt.boardRestriction=!0,Yt.yLogFunc=function(){console.time("yLog"),this.checked?(Yt.board.setBoundingBox([-Yt.tEnd.X()/10,.3,1.1*Yt.tEnd.X(),-Math.log10(1/Yt.eps)-1],!1),h.generateLabelText=(e,t)=>e.usrCoords[2]-t.usrCoords[2]<-Math.log10(1/Yt.eps)?"":e.usrCoords[2]-t.usrCoords[2]<1-Math.log10(1/Yt.eps)?"0":"$10^{"+Math.floor(e.usrCoords[2]-t.usrCoords[2])+"}$",Yt.yPre=e=>e>Math.log10(Yt.eps)?10**e:0,Yt.yPost=e=>Math.abs(e)>Yt.eps?Math.log10(Math.abs(e)):Math.log10(Yt.eps),Yt.move=e=>e>Yt.eps?Math.log10(e):Math.log10(Yt.eps),Yt.boardRestriction=!1,Yt.board.highlightInfobox=function(e,t,a){t<=-Math.log10(1/Yt.eps)?Yt.board.infobox.setText(" ("+e+",0)"):Yt.board.infobox.setText(" ("+e+" , $"+(10**t*10**Math.ceil(-t-1)%1*10).toFixed(2)+"\\cdot 10^{"+Math.ceil(-t)+"}$)")}):(Yt.board.setBoundingBox([-Yt.tEnd.X()/10,1.2,1.1*Yt.tEnd.X(),-.1],!1),h.generateLabelText=function(e,t){return e.usrCoords[2]-t.usrCoords[2]},Yt.yPost=e=>e,Yt.yPre=e=>e,Yt.move=e=>e>Math.log10(Yt.eps)?10**e:0,Yt.boardRestriction=!0,Yt.board.highlightInfobox=function(e,t,a){Yt.board.infobox.setText("("+e+", "+t+")")}),Yt.board.fullUpdate(),u(),console.timeEnd("yLog")},window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},jax:["input/TeX","output/HTML-CSS"],svg:{fontCache:"global"},startup:{promise:new Promise((function(e,t){setTimeout(()=>e(1),100)}))}},(()=>{const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js",e.async=!0,document.head.appendChild(e)})(),Yt.promise=new Promise((e,t)=>{setTimeout(()=>e(1),100)}),Yt.typeset=function(e){return window.MathJax.startup.promise=window.MathJax.startup.promise.then(()=>(e(),window.MathJax.typesetPromise())).catch(e=>console.log("Typeset failed: "+e.message)),window.MathJax.startup.promise},Yt.eps=1e-12,Yt.yPre=e=>e,Yt.yPost=e=>e,Yt.move=e=>e>Math.log10(Yt.eps)?10**e:0,$("#plotID").mouseenter(()=>{Yt.helpID=$("#helpID").html(),$("#helpID").html("Scroll to zoom in and out. Hold <b>SHIFT</b> to pan.<br>To change interventions either drag them or hold <b>SHIFT</b> and click to enter coordinates directly. <br>Press <b>+</b> button to add an intervention and press <b>&#8211</b> button to remove last intervention.Switch <b>Log</b> checkbox to switch y-axis to logarithmic scale.<br>Press any checkbox in the <b>legend</b> to hide corresponding function graph.<br>")}),$("#plotID").mouseleave(()=>{$("#helpID").html(Yt.helpID)}),$("#ratesID").mouseenter(()=>{Yt.helpID=$("#helpID").html(),$("#helpID").html("Values can be adjusted by either directly changing the numerical value or by scrolling/ dragging the graph .<br>Click on intervention tab to view corresponding rates .<br>")}),$("#ratesID").mouseleave(()=>{$("#helpID").html(Yt.helpID)}),$("#statesID").mouseenter(()=>{Yt.helpID=$("#helpID").html(),$("#helpID").html("Values can be adjusted by either directly changing the numerical value or by scrolling/ dragging the graph .<br>")}),$("#statesID").mouseleave(()=>{$("#helpID").html(Yt.helpID)}),$("#GraphButtons").html('<span float="right" class="slider-checkbox"><input type="checkbox" id="logY" /><label class="label" for="logY"></label><button class="button" id="button">+</button>&nbsp<button class="button" id="button2">&#8211</button>')}function _t(){!function(){const e=Yt.board.create("line",[[0,0],[1,0]],{visible:!1});Yt.tEnd=Yt.board.create("glider",[200,0,e],{name:"$t_{\\infty}$",color:"black"}),Yt.board.setBoundingBox([-Yt.tEnd.X()/10,1.2,1.1*Yt.tEnd.X(),-.1],!1),Yt.tEnd.on("up",(function(e){const t=this;Yt.promise=Yt.promise.then(()=>{if(e.shiftKey&&null==Yt.input){const e=Yt.board.getBoundingBox();Yt.typeset(()=>{Yt.input=Yt.board.create("text",[(e[2]+e[0])/2.5,(e[1]+e[3])/2,'<div id="inputID"><p>Enter Value of $t_\\\\infty$</p><br><input type="float" id="xValue" required value='+t.X()+'><br><br><button class="button" id="Accept">Accept</button></div>'],{fixed:!0,highlight:!1})}).then(()=>{$("#Accept").click(()=>{t.moveTo([$("#xValue").val(),0]),Yt.board.removeObject(Yt.input),Yt.input=null,Yt.plotCurves(),Yt.board.setBoundingBox([-Yt.tEnd.X()/10,e[1],1.1*Yt.tEnd.X(),e[3]],!1)})})}Yt.plotCurves();const a=Yt.board.getBoundingBox();return Yt.board.setBoundingBox([-Yt.tEnd.X()/10,a[1],1.1*Yt.tEnd.X(),a[3]],!1),new Promise((function(e,t){setTimeout(()=>e(1),100)}))})}))}(),function(){function e(e){return e<=Yt.eps?Math.log10(Yt.eps):1===e?Math.log10(1+Yt.eps):Math.log10(e)}function t(e){return e<=Math.log10(Yt.eps)?0:10**e}function a(){let e=0;return Object.keys(Yt.states).forEach(a=>{e+=t(Yt.states[a].point.X())}),0===e&&(e=1),e}function s(){let e=0;for(var t in Yt.data.states)e+=Yt.data.states[t].value;return 0===e&&(e=1),e}Yt.saveStates=()=>{Yt.data.states={},Object.keys(Yt.states).forEach(e=>{Yt.data.states[e]={},Yt.data.states[e].value=Yt.states[e].getValue(),Yt.data.states[e].name=Yt.states[e].name})},Yt.saveInterventions=()=>{Yt.data.interventions={},Object.keys(Yt.interventions).forEach(e=>{Yt.data.interventions[e]=Yt.interventions[e].getValue()})},Yt.saveRates=()=>{Yt.data.rates={},Object.keys(Yt.rates).forEach(e=>{Yt.data.rates[e]={},Object.keys(Yt.interventions).forEach(t=>{Yt.data.rates[e][t]=Yt.rates[e][t].getValue()})})},Yt.save=()=>{Yt.saveStates(),Yt.saveRates(),Yt.saveInterventions()},Yt.loadStates=()=>{Yt.statesMap={},Yt.board.suspendUpdate(),Object.values(Yt.states).forEach(e=>{Yt.board.removeObject(e.plotPoint),JXG.JSXGraph.freeBoard(e.board)}),Object.values(Yt.curves).forEach(e=>{Yt.board.removeObject(e)}),Yt.board.removeObject(Yt.labels),Yt.board.unsuspendUpdate(),Yt.states={};for(let e=0;e<Object.keys(Yt.data.states).length;e++)Yt.statesMap[Object.keys(Yt.data.states)[e]]=e;const n=Yt.board.create("line",[()=>-1*Yt.interventions.t0.getValue(),()=>1,()=>0],{visible:!1});$("#statesID").empty(),$("#statesID").append("<table>"),document.getElementById("statesID").style.display="block",Object.keys(Yt.data.states).forEach(i=>{Yt.states[i]={},Yt.states[i].name=Yt.data.states[i].name,$("#statesID").append('<tr><td><div class="stateName" >'+Yt.states[i].name+'(0) = </div></td><td><div contenteditable="true" class="stateText"  id= "text'+i+'">'+(Yt.data.states[i].value<Yt.eps?(0).toExponential(3):Yt.data.states[i].value.toExponential(3))+'</div></td><td><div class="stateBoard" tabindex="1" id= "board'+i+'"></div></td></tr>'),Yt.states[i].board=JXG.JSXGraph.initBoard("board"+i,{axis:!1,maxboundingbox:[-1/0,1/0,1/0,-1/0],showCopyright:!1,showNavigation:!1,showInfobox:!1,highlight:!1,highlightInfobox:!1,pan:{enabled:!0,needshift:!1},zoom:{factorX:1.05,factorY:1,wheel:!0,needshift:!1,eps:.01}}),Yt.states[i].point=Yt.states[i].board.create("point",[e(Yt.data.states[i].value),0],{name:Yt.data.states[i].name,visible:!0,highlight:!1,highlightInfobox:!1,label:{offset:[0,-25]},color:Yt.colors[Yt.statesMap[i]],fixed:!0,showInfobox:!1}),Yt.states[i].board.setBoundingBox([e(Yt.data.states[i].value)-2,.1,e(Yt.data.states[i].value)+2,-.1]),Yt.states[i].point.setAttribute({frozen:!0}),Yt.states[i].getValue=function(){return t(this.point.X())};const o=Yt.states[i].board.create("axis",[[0,0],[1,0]]);o.removeAllTicks(),Yt.states[i].board.create("ticks",[o,1],{drawLabels:!0,minorTicks:0,drawZero:!0,generateLabelText:(e,t)=>e.usrCoords[1]-t.usrCoords[1]<=-12?0:"$10^{"+1*Math.floor(e.usrCoords[1]-t.usrCoords[1])+"}$"}),Yt.states[i].plotPoint=Yt.board.create("glider",[0,t(Yt.states[i].point.X())/s(),n],{color:Yt.colors[Yt.statesMap[i]],name:Yt.data.states[i].name+"(0)",label:{autoPosition:!0,visible:!1},showInfobox:!1,highlight:!1,fixed:!0}),Yt.states[i].board.on("boundingbox",()=>{const e=Yt.states[i].board.getBoundingBox();Yt.states[i].board.setBoundingBox([e[2]-4,.1,e[2],-.1]);Yt.states[i].getValue()<=Yt.eps?document.getElementById("text"+i).innerHTML=(0).toExponential(3):document.getElementById("text"+i).innerHTML=Yt.states[i].getValue().toExponential(3),Object.keys(Yt.states).forEach(e=>{Yt.states[e].plotPoint.setPositionDirectly(JXG.COORDS_BY_USER,[0,Yt.yPost(t(Yt.states[e].point.X())/a())])}),Yt.plotCurves()}),$(document).focusout("#text"+i,()=>{"block"===$("#statesID").css("display")&&(Object.keys(Yt.states).forEach(e=>{Yt.states[e].plotPoint.setPositionDirectly(JXG.COORDS_BY_USER,[0,Yt.yPost(parseFloat($("#text"+e).text())/a())])}),Yt.states[i].board.setBoundingBox([e(parseFloat($("#text"+i).text()))-2,.1,e(parseFloat($("#text"+i).text()))+2,-.1]))})}),$("#statesID").append("</table>"),document.getElementById("statesID").style.display="none",Yt.curves={},Object.keys(Yt.data.states).forEach(e=>{Yt.curves[e]=Yt.board.create("curve",[0,0],{strokeColor:Yt.colors[Yt.statesMap[e]],name:Yt.data.states[e].name+"(t)",highlight:!1}),Yt.curves.n=Yt.board.create("curve",[0,0],{strokeColor:"black",name:"N(t)",highlight:!1})}),Yt.setLegend(),Yt.setLegendFunction()},Yt.loadInterventions=()=>{Yt.board.suspendUpdate(),Object.values(Yt.interventions).forEach(e=>{Yt.board.removeObject(e.line.point1),Yt.board.removeObject(e.line.point2),Yt.board.removeObject(e.line),Yt.board.removeObject(e.point)}),Yt.board.unsuspendUpdate(),Yt.board.update(),Yt.interventions={};const t=Yt.board.create("line",[[0,0],[1,0]],{visible:!1});$("#tabtab3ID").empty(),Object.keys(Yt.data.interventions).forEach(a=>{Yt.interventions[a]={},Yt.interventions[a].point=Yt.board.create("glider",[Yt.data.interventions[a],0,t],{color:"black",visible:!0,name:"$t_{"+a.substring(1)+"}$"}),Yt.interventions[a].line=Yt.board.create("line",[[()=>Yt.interventions[a].point.X(),0],[()=>Yt.interventions[a].point.X(),1]],{color:"lightGrey",visible:!0}),Yt.interventions[a].point.on("up",(function(e){const t=this;Yt.promise=Yt.promise.then(()=>{if(e.shiftKey&&null==Yt.input){const e=Yt.board.getBoundingBox();Yt.typeset(()=>{Yt.input=Yt.board.create("text",[(e[2]+e[0])/2.5,(e[1]+e[3])/2,'<div id="inputID"><p>Enter Value of $t$<sub>'+a.substring(1,2)+'</sub></p><br><input type="float" id="xValue" required value='+t.X()+'><br><br><button class="button" id="Accept">Accept</button></div>'],{fixed:!0,highlight:!1})}).then(()=>{$("#Accept").click(()=>{t.moveTo([$("#xValue").val(),0]),Yt.board.removeObject(Yt.input),Yt.input=null,Yt.plotCurves()})})}return Yt.plotCurves(),new Promise((function(e,t){setTimeout(()=>e(1),100)}))})})),Yt.interventions[a].getValue=function(){return this.point.X()},$("#tabtab3ID").append('<button id = "button'+a+'">t<sub>'+a.substring(1)+"</sub></button>"),$("#button"+a).click(()=>{Yt.activeIntervention=a,$("#tabtab3ID").children().removeClass("active"),$("#button"+a).addClass("active"),Object.keys(Yt.rates).forEach(t=>{Object.keys(Yt.interventions).forEach(e=>{Yt.rates[t][e].point.setAttribute({visible:!1,frozen:!1})}),Yt.rates[t].board.setBoundingBox([e(Yt.rates[t][a].getValue())-2,.1,e(Yt.rates[t][a].getValue())+2,-.1]),Yt.rates[t][a].point.setAttribute({visible:!0,frozen:!0})})})}),Yt.interventions.t0.line.setAttribute({visible:!1}),$("#buttont0").addClass("active"),Yt.activeIntervention="t0"},Yt.loadRates=()=>{Yt.rates={},$("#ratesID").empty(),$("#ratesID").append("<table>"),document.getElementById("ratesID").style.display="block",Object.keys(Yt.data.rates).forEach(a=>{Yt.rates[a]={},$("#ratesID").append('<tr><td><div class="rateName" >'+a+'= </div></td><td><div contenteditable="true" class="rateText"  id= "text'+a+'">'+Yt.data.rates[a].t0+'</div></td><td><div class="rateBoard"  id= "board'+a+'"></div></td></tr>'),Yt.rates[a].board=JXG.JSXGraph.initBoard("board"+a,{axis:!1,maxboundingbox:[-1/0,1/0,1/0,-1/0],boundingbox:[-.6,.1,1,-.1],showCopyright:!1,showNavigation:!1,showInfobox:!1,highlight:!1,pan:{enabled:!0,needshift:!1},zoom:{factorX:1.05,factorY:1,wheel:!0,needshift:!1,eps:.01}});const s=Yt.rates[a].board.create("axis",[[0,0],[1,0]]);s.removeAllTicks(),Yt.rates[a].board.create("ticks",[s,1],{drawLabels:!0,minorTicks:0,drawZero:!0,generateLabelText:(e,t)=>e.usrCoords[1]-t.usrCoords[1]<=-12?0:"$10^{"+1*Math.floor(e.usrCoords[1]-t.usrCoords[1])+"}$"}),Object.keys(Yt.data.rates[a]).forEach(s=>{Yt.rates[a][s]={},Yt.rates[a][s].point=Yt.rates[a].board.create("point",[e(Yt.data.rates[a][s]),0],{name:a,visible:!1,label:{offset:[0,-25]},color:"black",fixed:!0,showInfobox:!1,highlight:!1}),Yt.rates[a][s].getValue=function(){return t(this.point.X())},Yt.rates[a].board.on("boundingbox",()=>{const e=Yt.rates[a].board.getBoundingBox();Yt.rates[a].board.setBoundingBox([e[2]-4,.1,e[2],-.1]);Yt.rates[a][Yt.activeIntervention].getValue()<=Yt.eps?document.getElementById("text"+a).innerHTML=(0).toExponential(3):document.getElementById("text"+a).innerHTML=Yt.rates[a][Yt.activeIntervention].getValue().toExponential(3),Yt.plotCurves()}),$(document).focusout("#text"+a,()=>{"block"===$("#ratesID").css("display")&&Yt.rates[a].board.setBoundingBox([e(parseFloat($("#text"+a).text()))-2,.1,e(parseFloat($("#text"+a).text()))+2,-.1])})})}),$("#ratesID").append("</table>"),Object.keys(Yt.data.rates).forEach(t=>{Yt.rates[t].board.setBoundingBox([e(Yt.data.rates[t].t0)-2,.1,e(Yt.data.rates[t].t0)+2,-.1]),Yt.rates[t].t0.point.setAttribute({visible:!0,frozen:!0})})}}(),Yt.data.states={},Yt.data.states.s0={},Yt.data.states.s0.name="S",Yt.data.states.s0.value=1e3,Yt.data.interventions={},Yt.data.interventions.t0=0,Yt.data.rates={},Yt.load()}function Wt(){$("#button").click(()=>{console.time("addIntervention"),Yt.save(),Yt.data.interventions["t"+Object.keys(Yt.data.interventions).length]=Yt.data.interventions["t"+(Object.keys(Yt.data.interventions).length-1)]+10,Object.keys(Yt.data.rates).forEach(e=>{Yt.data.rates[e]["t"+Object.keys(Yt.data.rates[e]).length]=Yt.data.rates[e]["t"+(Object.keys(Yt.data.rates[e]).length-1)]}),Yt.load(),console.timeEnd("addIntervention"),Yt.plotCurves()}),$("#button2").click(()=>{console.time("removeIntervention"),Yt.save(),Object.keys(Yt.data.interventions).length>=2&&(delete Yt.data.interventions["t"+(Object.keys(Yt.data.interventions).length-1)],Object.keys(Yt.data.rates).forEach(e=>{delete Yt.data.rates[e]["t"+Object.keys(Yt.data.interventions).length]})),Yt.load(),console.timeEnd("removeIntervention"),Yt.plotCurves()}),$("#logY").change((function(){Yt.yLogFunc.call(this),Object.keys(Yt.states).forEach(e=>{Yt.states[e].plotPoint.moveTo([Yt.states[e].plotPoint.X(),Yt.move(Yt.states[e].plotPoint.Y())])}),Yt.plotCurves()}))}Yt.curves={},Yt.data={},Yt.states={},Yt.rates={},Yt.statesMap={},Yt.interventions={},Yt.load=()=>{$("#ratesID").show(),$("#tab3ID").show(),$("#statesID").hide(),Yt.loadInterventions(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#statesID").show(),Yt.loadStates(),$("#ratesID").show(),$("#tab3ID").show(),$("#statesID").hide(),Yt.loadRates(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#statesID").show(),$("#Values").addClass("active"),$("#Rates").removeClass("active")},Yt.update=()=>{Yt.save();const e=zt.getODEs();e.states.forEach((e,t)=>{Object.keys(Yt.data.states).includes(t)?Yt.data.states[t].name!==e&&(Yt.data.states[t].name=e):(Yt.data.states[t]={},Yt.data.states[t].name=e,Yt.data.states[t].value=0)}),Object.keys(Yt.data.states).forEach(t=>{e.states.has(t)||delete Yt.data.states[t]}),e.rates.forEach(e=>{Object.keys(Yt.data.rates).includes(e)||(Yt.data.rates[e]={},Object.keys(Yt.data.interventions).forEach(t=>{Yt.data.rates[e][t]=.1}))}),Object.keys(Yt.data.rates).forEach(t=>{e.rates.has(t)||delete Yt.data.rates[t]}),Yt.load(),Yt.plotCurves()},Yt.pointArray=[],Yt.interventionArray=[],Yt.colors=["red","blue","green","purple","orange","gray","pink","yellow","teal","Brown","BlueViolet","CadetBlue","Chartreuse","Chocolate","CornflowerBlue","Coral","Crimson","Cyan","DarkMagenta","DarkGreen","Fuchsia","Indigo","Khaki","Lime","Magenta","Maroon","Navy","Olive"],Yt.setLegend=()=>{let e="",t="<br>";e+=" .switch { position: relative; display: inline-block; width: 30px; height: 18px;}",e+=".switch input {opacity: 0;width: 0;height: 0;}",e+=".slidern {position: absolute; cursor: pointer;top: 0;left: 0;right: 0;bottom: 0;background-color: #ccc;-webkit-transition: 0.4s;transition: 0.4s;}",e+='.slidern:before {position: absolute;content: ""; height: 13px; width: 13px; left: 2px;bottom: 2px; background-color: white;-webkit-transition: 0.4s;transition: 0.4s;}',e+="input:checked + .slidern {background-color:",e+="black",e+=";}",e+="input:focus + .slidern {box-shadow: 0 0 1px grey;}",e+="input:checked + .slidern:before {-webkit-transform: translateX(13px); -ms-transform: translateX(13px); transform: translateX(13px);}",e+=".slidern.round {border-radius: 17px;}",e+=".slidern.round:before {border-radius: 50%;}",t+='<label class="switch">',t+='<input type="checkbox" id="checkn" name="checkn" checked> n',t+='<span class="slidern round"></span></label><span> ',t+="N",t+="(t)  &nbsp&nbsp</span><br>",Object.keys(Yt.curves).forEach(a=>{"n"!==a&&(e+=".slider"+a+" {position: absolute; cursor: pointer;top: 0;left: 0;right: 0;bottom: 0;background-color: #ccc;-webkit-transition: 0.4s;transition: 0.4s;}",e+=".slider"+a+':before {position: absolute;content: ""; height: 13px; width: 13px; left: 2px;bottom: 2px; background-color: white;-webkit-transition: 0.4s;transition: 0.4s;}',e+="input:checked + .slider"+a+" {background-color:",e+="n"===a?"black":Yt.colors[Yt.statesMap[a]],e+=";}",e+="input:focus + .slider"+a+" {box-shadow: 0 0 1px "+Yt.colors[Yt.statesMap[a]]+";}",e+="input:checked + .slider"+a+":before {-webkit-transform: translateX(13px); -ms-transform: translateX(13px); transform: translateX(13px);}",e+=".slider"+a+".round {border-radius: 17px;}",e+=".slider"+a+".round:before {border-radius: 50%;}",t+='<label class="switch">',t+='<input type="checkbox" id="check'+a+'" name="check'+a+'" checked> '+a,t+='<span class="slider'+a+' round"></span></label><span> ',t+="n"===a?"N":Yt.states[a].name,t+="(t)  &nbsp&nbsp</span><br>")});const a=document.createElement("style");a.type="text/css",a.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(a);const s=Yt.board.getBoundingBox();Yt.labels=Yt.board.create("text",[s[2],(s[1]+s[3])*(.55+.03*Object.keys(Yt.curves).length),t],{frozen:!0,fontSize:18,fixed:!0,visible:!0,anchorX:"right",anchorY:"top",highlight:!1})},Yt.setLegendFunction=()=>{Object.keys(Yt.curves).forEach(e=>{$("#check"+e).on("click",(function(){this.checked?Yt.curves[e].setAttribute({visible:!0}):Yt.curves[e].setAttribute({visible:!1})}))})};var qt=function(){Wt()};var Zt=function(){console.time("Ode");const e=zt.getODEs(),t={};function a(e){return Object.keys(Yt.interventions).includes("t"+(1+parseInt(e.substring(1),10)))?Yt.interventions["t"+(1+parseInt(e.substring(1),10))].getValue():Yt.tEnd.X()}Yt.delta=20,Object.keys(Yt.interventions).forEach(a=>{t[a]=function(t){return function(a,s){const n=s.map(()=>0);let i,o=0;return e.equations.forEach((e,t)=>{o+=s[Yt.statesMap[t]]}),e.equations.forEach((e,a)=>{e.forEach(e=>{i=!1;let r=e.sign>0?1:-1;e.prod.forEach(e=>{"r"===e[0]?r*=Yt.rates[e[1]][t].getValue():"n"===e[0]?r*=o:(i?(r*=s[Yt.statesMap[e[1]]],r/=o):r*=s[Yt.statesMap[e[1]]],i=!0)}),n[Yt.statesMap[a]]+=r})}),n}}(a)});let s=[[]];e.states.forEach((e,t)=>{s[0][Yt.statesMap[t]]=Yt.states[t].getValue()}),Object.keys(Yt.interventions).sort((e,t)=>e.substring(1)<t.substring(1)?-1:1).forEach(e=>{s=s.concat(JXG.Math.Numerics.rungeKutta("rk4",s[s.length-1],[Yt.interventions[e].getValue(),a(e)],(a(e)-Yt.interventions[e].getValue())*Yt.delta+1,t[e]).slice(1))});let n=0;for(let e=0;e<s[0].length;e++)n+=s[0][e];if(0!==n)for(let e=0;e<s.length;e++)for(let t=0;t<s[e].length;t++)s[e][t]=s[e][t]/n;for(let e=0;e<s.length;e++){let t=0;s[e][s[s.length-1].length]=Yt.interventions.t0.getValue()+e/Yt.delta;for(let a=0;a<s[e].length-1;a++)t+=s[e][a];s[e].unshift(t)}return console.timeEnd("Ode"),s};var Qt=function(){Yt.plotCurves=function(e,t){let a=-1;return function(){clearTimeout(a);const s=arguments,n=this;a=setTimeout((function(){e.apply(n,s)}),t)}}(()=>{const e=Zt();console.time("Plot"),Object.keys(Yt.curves).forEach(t=>{Yt.curves[t].dataX=[],Yt.curves[t].dataY=[];for(let a=0;a<1e3;a++)Yt.curves[t].dataX[a]=e[Math.floor(a*e.length/1e3)][e[0].length-1],Yt.curves[t].dataY[a]="n"===t?Yt.yPost(e[Math.floor(a*e.length/1e3)][0]):Yt.yPost(e[Math.floor(a*e.length/1e3)][Yt.statesMap[t]+1])}),Yt.board.update(),console.timeEnd("Plot")},20)};function ea(e){var t,a,s,n,i,o,r=0,l="s1",c=!0;if("Epidemic-Model-Data"===e.slice(0,19)){for(r=20;":"!==e[r];){for(s=[],t=0,a=0,n="",i="",o="";"("!==e[r];)i+=e[r],r++;for(r++;","!==e[r];)t+=e[r],r++;for(t=parseInt(t),r++;")"!==e[r];)a+=e[r],r++;for(a=parseInt(a),r++,r++;","!==e[r];)o+=e[r],r++;for(o=parseFloat(o),r++;";"!==e[r]&&":"!==e[r];)n+=e[r],","===e[++r]&&(s.push(parseInt(n)),n="",r++);if(s.push(parseInt(n)),c){var h=0;c=!1;const e=Q.getShape("s0");for(Bt.systemStateActivate("sr",e),Bt.activeShape.move(t,a),ie.nameRemoveToken();h<s.length;)ie.stateName(s[h]),h++;Bt.activeShape.deactivate(),Bt.systemStateActivate("i"),Q.draw(),Bt.callback(Q.shMap),Yt.data.states={},Yt.data.states.s0={},Yt.data.states.s0.name="S",Yt.data.states.s0.value=o,Yt.data.interventions={},Yt.data.interventions.t0=0,Yt.data.rates={}}else{for(;i!==l;)l=Q.generateFreeID("s");const e=new d(i,t,a);Q.addShape(i,e);for(h=0;h<s.length;)e.nameAddChr(s[h]),h++;Q.draw(),Bt.callback(Q.shMap),Yt.data.states[i]={},Yt.data.states[i].name=e.name,Yt.data.states[i].value=o}":"!==e[r]&&r++}r+=2;var u="",p="";for(s=[],n="";";"!==e[r]&&":"!==e[r];){for(u="",p="",s=[],n="";","!==e[r];){for(n="";"-"!==e[r]&&","!==e[r];)n+=e[r],r++;switch(n[0]){case"(":n=n.substring(1,n.length-1),s.push("("),s.push(n),s.push(")");break;case"+":s.push("+");break;default:s.push(n)}","!==e[r]&&r++}for(s.push(","),n="",r++;","!==e[r];)n+=e[r],r++;for(u+=n,u=Q.getShape(u),r++,n="";";"!==e[r]&&":"!==e[r];)n+=e[r],r++;p+=n,p=Q.getShape(p);var m=ue.transitionCreate(u,p);Bt.systemStateActivate("tr",m);for(h=0;","!==s[h];){var b="";switch(s[h]){case"+":Bt.activeShape.nameAddToken("o",65291),h++;break;case"(":for(h++;")"!==s[h];)b+=s[h],h++;b=Q.getShape(b),Bt.activeShape.nameAddToken("s",b),h++;break;default:Bt.activeShape.nameAddToken("r",parseInt(s[h])),h++}}Bt.activeShape.deactivate(),Bt.systemStateActivate("i"),Q.draw(),Bt.callback(Q.shMap),":"!==e[r]&&r++}r+=2;u="",p="";for(s=[],n="";";"!==e[r]&&":"!==e[r];){for(u="",p="",s=[],n="";","!==e[r];){for(n="";"-"!==e[r]&&","!==e[r];)n+=e[r],r++;switch(n[0]){case"(":n=n.substring(1,n.length-1),s.push("("),s.push(n),s.push(")");break;case"+":s.push("+");break;default:s.push(n)}","!==e[r]&&r++}for(s.push(","),r++,n="";";"!==e[r]&&":"!==e[r];)n+=e[r],r++;p+=n,p=Q.getShape(p),Bt.systemStateActivate("t",p),Pt.specialArrowCreate("in");for(h=0;","!==s[h];){b="";switch(s[h]){case"+":Bt.activeShape.nameAddToken("o",65291),h++;break;case"(":for(h++;")"!==s[h];)b+=s[h],h++;b=Q.getShape(b),Bt.activeShape.nameAddToken("s",b),h++;break;default:Bt.activeShape.nameAddToken("r",parseInt(s[h])),h++}}Bt.activeShape.deactivate(),Bt.systemStateActivate("i"),Q.draw(),Bt.callback(Q.shMap),":"!==e[r]&&r++}r+=2;var v,f,g,S;u="",p="";for(s=[],n="";";"!==e[r]&&":"!==e[r];){for(u="",p="",s=[],n="";","!==e[r];){for(n="";"-"!==e[r]&&","!==e[r];)n+=e[r],r++;switch(n[0]){case"(":n=n.substring(1,n.length-1),s.push("("),s.push(n),s.push(")");break;case"+":s.push("+");break;default:s.push(n)}","!==e[r]&&r++}for(s.push(","),r++,n="";";"!==e[r]&&":"!==e[r];)n+=e[r],r++;u+=n,u=Q.getShape(u),Bt.systemStateActivate("t",u),Pt.specialArrowCreate("out");for(h=0;","!==s[h];){b="";switch(s[h]){case"+":Bt.activeShape.nameAddToken("o",65291),h++;break;case"(":for(h++;")"!==s[h];)b+=s[h],h++;b=Q.getShape(b),Bt.activeShape.nameAddToken("s",b),h++;break;default:Bt.activeShape.nameAddToken("r",parseInt(s[h])),h++}}Bt.activeShape.deactivate(),Bt.systemStateActivate("i"),Q.draw(),Bt.callback(Q.shMap),":"!==e[r]&&r++}for(r+=2;":"!==e[r];){for(v="",f="";"-"!==e[r];)v+=e[r],r++;for(r++;","!==e[r]&&":"!==e[r];)f+=e[r],r++;f=parseFloat(f),":"!==e[r]&&r++,Yt.data.interventions[v]=f}for(r+=2;":"!==e[r];){for(g="",v="",S="";","!==e[r];)g+=e[r],r++;for(g=String.fromCodePoint(g),r++;","!==e[r];)v+=e[r],r++;for(r++;":"!==e[r]&&";"!==e[r];)S+=e[r],r++;S=parseFloat(S),":"!==e[r]&&r++,void 0===Yt.data.rates[g]&&(Yt.data.rates[g]={}),Yt.data.rates[g][v]=S}Yt.load(),document.getElementById("uploadmodel").style.backgroundColor="lightgreen",$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").show(),$("#helpID").hide(),$("#Simulator").removeClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").addClass("active")}else alert("wrong data input")}function ta(e,t,a){var s=new Blob([e],{type:a});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(s,t);else{var n=document.createElement("a"),i=URL.createObjectURL(s);n.href=i,n.download=t,document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(i)}),0)}}function aa(){let e="<br>",t="";Object.keys(Yt.states).forEach(t=>{e+='<label class="switch">',e+='<input type="checkbox" id="fittingcheck'+t+'" name="fittingcheck'+t+'"> '+t,e+='<span class="slider'+t+' round"></span></label><span> ',e+=Yt.states[t].name,e+="(t)  &nbsp&nbsp</span><br>"}),e+='<button id="fittingchoicevalidate" class="downloadupload" style="margin-right: 6px; width: 97px">Accept</button>',e+='<button id="fittingchoicecancel" class="downloadupload" style="width: 97px">Cancel</button>',$("#fittingchoice").html(e),document.getElementById("fittingchoicevalidate").addEventListener("click",(function(){Object.keys(Yt.states).forEach(e=>{let a="fittingcheck";a+=e,document.getElementById(a).checked&&(t+='"',t+=e,t+='",')}),","===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),$("#fittingchoice").html(""),function(e){Zt();var t,a,s,n,i,o='{"Model":\n';for([s,n]of(o+='         {"Equations": {',Q.shMap))if("s"===s.substring(0,1)){for([t,a]of(o+='"',o+=s,o+='": "',Q.shMap))if("t"===t.substring(0,1)&&a.source.id===s&&void 0===a.type){i=0,o+="-",o+=s,o+="*";for(let e=0;e<a.nameArr.length;e++)switch(a.nameArr[e][0]){case"r":o+=a.nameArr[e][1],o+="*";break;case"s":o+=a.nameArr[e][1].id,o+="*","n"!=a.nameArr[e][1].id&&i++;break;case"o":for(;i>0;i--)o+="/n";o+="-",o+=s,o+="*"}for("*"===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1));i>0;i--)o+="/n"}for([t,a]of Q.shMap)if("t"===t.substring(0,1)&&a.target.id===s&&void 0===a.type){i=0,o+="+",o+=a.source.id,o+="*";for(let e=0;e<a.nameArr.length;e++)switch(a.nameArr[e][0]){case"r":o+=a.nameArr[e][1],o+="*";break;case"s":o+=a.nameArr[e][1].id,o+="*","n"!=a.nameArr[e][1].id&&i++;break;case"o":for(;i>0;i--)o+="/n";o+="+",o+=a.source.id,o+="*"}for("*"===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1));i>0;i--)o+="/n"}o+='", '}o=o.substring(0,o.length-2),o+='},\n          "Parameters": [',Object.keys(Yt.rates).forEach(e=>{o+='"',o+=e.codePointAt(0),o+='",'}),","===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),o+="],\n",o+='          "state_ids": [',Object.keys(Yt.states).forEach(e=>{o+='"',o+=e,o+='"',o+=","}),","===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),o+="],\n",o+='          "state-names": {',Object.keys(Yt.states).forEach(e=>{o+='"',o+=e,o+='"',o+=":",o+='"',o+=Yt.states[e].name,o+='"',o+=","}),","===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),o+="},\n",o+='          "IV": [',Object.keys(Yt.states).forEach(e=>{o+=Yt.states[e].getValue(),o+=","}),","===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),o+='],\n          "Compartments_to_Fit": [',o+=e,o+='],\n          "N": ';var r=0;Object.keys(Yt.states).forEach(e=>{r+=Yt.states[e].getValue()}),o+=r,ta(o+="}\n}","EMD-model.json",/text.*/)}(t)})),document.getElementById("fittingchoicecancel").addEventListener("click",(function(){$("#fittingchoice").html("")}))}const sa={SIR:"",SIS:"",SEIR:"",SIRS:"",SIRD:"",SIRV:""},na={SIRvitaldynamics:"",SISvitaldynamics:"",SEIRvitaldynamics:"",SIRSvitaldynamics:"",SIRDvitaldynamics:"",SIRVvitaldynamics:""};sa.SIR="Epidemic-Model-Data\n",sa.SIR+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(500,100),0,119877:\n",sa.SIR+="120573-(s1),s0,s1;120574,s1,s2:\n",sa.SIR+=":\n",sa.SIR+=":\n",sa.SIR+="t0-0:\n",sa.SIR+="120573,t0,0.3;120574,t0,0.1:",sa.SIS="Epidemic-Model-Data\n",sa.SIS+="s0(100,100),1000,119878;s1(300,100),10,119868:\n",sa.SIS+="120573-(s1),s0,s1;120574,s1,s0:\n",sa.SIS+=":\n",sa.SIS+=":\n",sa.SIS+="t0-0:\n",sa.SIS+="120573,t0,0.2;120574,t0,0.1:\n",sa.SEIR="Epidemic-Model-Data\n",sa.SEIR+="s0(100,100),1000,119878;s1(300,100),0,119864;s2(500,100),10,119868;s3(700,100),0,119877:\n",sa.SEIR+="120573-(s2),s0,s1;120572,s1,s2;120574,s2,s3:\n",sa.SEIR+=":\n",sa.SEIR+=":\n",sa.SEIR+="t0-0:\n",sa.SEIR+="120573,t0,0.3;120572,t0,0.1;120574,t0,0.1:\n",sa.SIRS="Epidemic-Model-Data\n",sa.SIRS+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(450,300),0,119877:\n",sa.SIRS+="120573-(s1),s0,s1;120574,s1,s2;120591,s2,s0:\n",sa.SIRS+=":\n",sa.SIRS+=":\n",sa.SIRS+="t0-0:\n",sa.SIRS+="120573,t0,0.4;120574,t0,0.2;120591,t0,0.01:\n",sa.SIRD="Epidemic-Model-Data\n",sa.SIRD+="s0(100,200),1000,119878;s1(300,200),10,119868;s2(500,100),0,119877;s3(500,300),0,119863:\n",sa.SIRD+="120573-(s1),s0,s1;120574,s1,s2;120575,s1,s3:\n",sa.SIRD+=":\n",sa.SIRD+=":\n",sa.SIRD+="t0-0:\n",sa.SIRD+="120573,t0,0.3;120574,t0,0.1;120575,t0,0.005:\n",sa.SIRV="Epidemic-Model-Data\n",sa.SIRV+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(500,100),0,119877;s3(200,200),0,119881:\n",sa.SIRV+="120573-(s1),s0,s1;120574,s1,s2;120575,s0,s3:\n",sa.SIRV+=":\n",sa.SIRV+=":\n",sa.SIRV+="t0-0:\n",sa.SIRV+="120573,t0,0.3;120574,t0,0.1;120575,t0,0.01:\n",na.SIRvitaldynamics="Epidemic-Model-Data\n",na.SIRvitaldynamics+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(500,100),0,119877:\n",na.SIRvitaldynamics+="120573-(s1),s0,s1;120574,s1,s2:\n",na.SIRvitaldynamics+="120583-(n),s0:\n",na.SIRvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2:\n",na.SIRvitaldynamics+="t0-0:\n",na.SIRvitaldynamics+="120573,t0,0.3;120574,t0,0.1;120583,t0,0.01;120584,t0,0.01:\n",na.SISvitaldynamics="Epidemic-Model-Data\n",na.SISvitaldynamics+="s0(100,100),1000,119878;s1(300,100),10,119868:\n",na.SISvitaldynamics+="120573-(s1),s0,s1;120574,s1,s0:\n",na.SISvitaldynamics+="120583-(n),s0:\n",na.SISvitaldynamics+="120584-(s0),s0;120584-(s1),s1:\n",na.SISvitaldynamics+="t0-0:\n",na.SISvitaldynamics+="120573,t0,0.2;120574,t0,0.1;120583,t0,0.001;120584,t0,0.001:\n",na.SEIRvitaldynamics="Epidemic-Model-Data\n",na.SEIRvitaldynamics+="s0(100,100),1000,119878;s1(300,100),0,119864;s2(500,100),10,119868;s3(700,100),0,119877:\n",na.SEIRvitaldynamics+="120573-(s2),s0,s1;120572,s1,s2;120574,s2,s3:\n",na.SEIRvitaldynamics+="120583-(n),s0:\n",na.SEIRvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2;120584-(s3),s3:\n",na.SEIRvitaldynamics+="t0-0:\n",na.SEIRvitaldynamics+="120573,t0,0.3;120572,t0,0.1;120574,t0,0.1;120583,t0,0.001;120584,t0,0.001:\n",na.SIRSvitaldynamics="Epidemic-Model-Data\n",na.SIRSvitaldynamics+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(450,300),0,119877:\n",na.SIRSvitaldynamics+="120573-(s1),s0,s1;120574,s1,s2;120591,s2,s0:\n",na.SIRSvitaldynamics+="(n)-120583,s0:\n",na.SIRSvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2:\n",na.SIRSvitaldynamics+="t0-0:\n",na.SIRSvitaldynamics+="120573,t0,0.4;120574,t0,0.2;120591,t0,0.01;120583,t0,0.001;120584,t0,0.001:\n",na.SIRDvitaldynamics="Epidemic-Model-Data\n",na.SIRDvitaldynamics+="s0(100,200),1000,119878;s1(300,200),10,119868;s2(500,100),0,119877;s3(500,300),0,119863:\n",na.SIRDvitaldynamics+="120573-(s1),s0,s1;120574,s1,s2;120575,s1,s3:\n",na.SIRDvitaldynamics+="120583-(s0)-+-120583-(s1)-+-120583-(s2),s0:\n",na.SIRDvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2:\n",na.SIRDvitaldynamics+="t0-0:\n",na.SIRDvitaldynamics+="120573,t0,0.3;120574,t0,0.1;120575,t0,0.005;120583,t0,0.01;120584,t0,0.01:\n",na.SIRVvitaldynamics="Epidemic-Model-Data\n",na.SIRVvitaldynamics+="s0(100,100),1000,119878;s1(300,100),10,119868;s2(500,100),0,119877;s3(200,200),0,119881:\n",na.SIRVvitaldynamics+="120573-(s1),s0,s1;120574,s1,s2;120575,s0,s3:\n",na.SIRVvitaldynamics+="120583-(n),s0:\n",na.SIRVvitaldynamics+="120584-(s0),s0;120584-(s1),s1;120584-(s2),s2;120584-(s3),s3:\n",na.SIRVvitaldynamics+="t0-0:\n",na.SIRVvitaldynamics+="120573,t0,0.3;120574,t0,0.1;120575,t0,0.01;120583,t0,0.01;120584,t0,0.01:\n";var ia=function(){let e,t="";for(e in t+='<div style="padding-left:130px; margin-bottom: 5px; font-size: 10pt; font-family: Verdana, Geneva, Tahoma, sans-serif;">With vital dynamics:</div>',sa)t+='<span style="padding-bottom:5px; display:block;">',t+='<button id="',t+=e,t+='" style="width:100px; margin-right: 50px;" class="downloadupload">',t+=e,t+="</button>",t+='<button id="',t+=e,t+="vitaldynamics",t+='" style="width:100px;" class="downloadupload">',t+=e,t+="</button>",t+="</span>";for(e in document.getElementById("defaultmodelscontent").innerHTML=t,sa){let t=e,a=e;a+="vitaldynamics",document.getElementById(t).addEventListener("click",(function(){"s1"===Q.generateFreeID("s")?(ea(sa[t]),$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").hide(),$("#Simulator").removeClass("active"),$("#Designer").addClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").removeClass("active")):alert("There is an acitve model running! \nPlease refresh the website.")})),document.getElementById(a).addEventListener("click",(function(){"s1"===Q.generateFreeID("s")?(ea(na[a]),$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").hide(),$("#Simulator").removeClass("active"),$("#Designer").addClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").removeClass("active")):alert("There is an acitve model running! \nPlease refresh the website.")}))}};function oa(){JXG.Options=JXG.merge(JXG.Options,{board:{showNavigation:!1,showCopyright:!1,useMathJax:!0}}),JXG.Options.text.useMathJax=!0,Yt.board=JXG.JSXGraph.initBoard("plotID",{boundingbox:[-20,1.2,220,-.1],axis:!1,keepaspectratio:!1,showCopyright:!1,showNavigation:!1,zoom:{factorX:1.25,factorY:1.25,wheel:!0,needshift:!1,eps:.1}}),Jt(),Qt(),_t(),qt(),Yt.plotCurves(),ia()}function ra(){$("#Designer").click(()=>{$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").hide(),$("#Simulator").removeClass("active"),$("#Designer").addClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").removeClass("active")}),$("#Simulator").click(()=>{$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#helpID").show(),$("#plotID").show(),$("#tab2ID").show(),$("#GraphButtons").show(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").hide(),$("#Simulator").addClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").removeClass("active"),Object.values(Yt.rates).forEach(e=>{e.board.update()})}),$("#Defaultmodels").click(()=>{$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#defaultmodelscontent").show(),$("#Simulator").removeClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").removeClass("active"),$("#Defaultmodels").addClass("active")}),$("#UploadDownload").click(()=>{$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").show(),$("#defaultmodelscontent").hide(),$("#helpID").hide(),$("#Simulator").removeClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").addClass("active"),$("#Defaultmodels").removeClass("active")}),$("#uploadmodel").change(()=>{!function(){if("s1"!==Q.generateFreeID("s"))return alert("There is an acitve model running! \nPlease refresh the website before the upload."),void(document.getElementById("uploadmodel").style.backgroundColor="red");const e=document.getElementById("uploadmodel").files[0];if(e.type.match(/text.*/)){const t=new FileReader;t.onload=function(e){ea(t.result)},t.readAsText(e)}else alert("Error with your datatype")}()}),$("#downloadmodel").click(()=>{!function(){var e,t,a="Epidemic-Model-Data\n";for([e,t]of Q.shMap)"s"===e.substring(0,1)&&(a+=e,a+="(",a+=t.x,a+=",",a+=t.y,a+=")",a+=",",void 0!==Yt.states[e]?a+=Yt.states[e].getValue():a+="0",a+=",",a+=t.nameArr,a+=";");for([e,t]of(a=a.substring(0,a.length-1),a+=":",a+="\n",Q.shMap))if("t"===e.substring(0,1)&&void 0===t.type){for(let e=0;e<t.nameArr.length;e++)switch(t.nameArr[e][0]){case"r":a+=t.nameArr[e][1],a+="-";break;case"s":a+="(",a+=t.nameArr[e][1].id,a+=")",a+="-";break;case"o":a+="+",a+="-"}a=a.substring(0,a.length-1),a+=",",a+=t.source.id,a+=",",a+=t.target.id,a+=";"}for([e,t]of(":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",Q.shMap))if("t"===e.substring(0,1)&&"in"===t.type){for(let e=0;e<t.nameArr.length;e++)switch(t.nameArr[e][0]){case"r":a+=t.nameArr[e][1],a+="-";break;case"s":a+="(",a+=t.nameArr[e][1].id,a+=")",a+="-";break;case"o":a+="+",a+="-"}a=a.substring(0,a.length-1),a+=",",a+=t.target.id,a+=";"}for([e,t]of(":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",Q.shMap))if("t"===e.substring(0,1)&&"out"===t.type){for(let e=0;e<t.nameArr.length;e++)switch(t.nameArr[e][0]){case"r":a+=t.nameArr[e][1],a+="-";break;case"s":a+="(",a+=t.nameArr[e][1].id,a+=")",a+="-";break;case"o":a+="+",a+="-"}a=a.substring(0,a.length-1),a+=",",a+=t.source.id,a+=";"}":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",Object.keys(Yt.interventions).forEach(e=>{a+=e,a+="-",a+=Yt.interventions[e].getValue(),a+=","}),":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",Object.keys(Yt.rates).forEach(e=>{Object.keys(Yt.interventions).forEach(t=>{a+=e.codePointAt(0),a+=",",a+=t,a+=",",a+=Yt.rates[e][t].getValue(),a+=";"})}),":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",ta(a,"EMD-download.txt",/text.*/)}()}),$("#downloaddatacsv").click(()=>{!function(){const e=Zt();var t,a,s="population,";for([t,a]of Q.shMap){"s"===t.substring(0,1)&&(s+=t,s+=",")}s+="\n";for(let t=0;t<e.length;t++){var n=e[t].pop();Number.isInteger(n)&&(s+=e[t],s+=",",s+="\n")}ta(s,"EMD-data.csv",/text.*/)}()}),$("#downloadmodeljson").click(()=>{aa()}),$("#downloadfittingprogram").click(()=>{window.open("https://github.com/Kilian672/EMD-Code/blob/main/App.exe","_blank").focus()}),$("#Rates").click(()=>{$("#ratesID").show(),$("#tab3ID").show(),$("#statesID").hide(),$("#Rates").addClass("active"),$("#Values").removeClass("active"),Object.values(Yt.rates).forEach(e=>{e.board.update()})}),$("#Values").click(()=>{$("#ratesID").hide(),$("#tab3ID").hide(),$("#statesID").show(),$("#Values").addClass("active"),$("#Rates").removeClass("active"),Object.values(Yt.states).forEach(e=>{e.board.update()})})}document.addEventListener("DOMContentLoaded",()=>{ra(),document.getElementById("Designer").click(),zt.init(),document.getElementById("Simulator").click(),document.getElementById("Rates").click(),$("#Simulator").click(e=>{$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#plotID").show(),$("#tab2ID").show(),$("#GraphButtons").show(),$("#Simulator").addClass("active"),$("#Designer").removeClass("active"),0!==Object.keys(Yt).length&&Yt.update(),document.getElementById("Rates").click()}),oa(),document.getElementById("Designer").click()})}]);