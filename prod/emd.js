!function(e){var t={};function a(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);const n={i:"",s:"",sr:"",sm:"",t:"",tr:"",tm:""};n.i="Double click an empty space in the <b>Model</b> pane to create a state.<br>Click an object to select it.<br>Drag a state to improve readability.<br>",n.s="Press <b>DEL</b> to delete the state.<br>Press <b>INS</b> to rename the state.<br>Hold <b>CTRL</b> and click a state to create a transition.<br>Click an empty space for more options.",n.sr="Press <b>CTRL</b> + <b>l</b> (latin), <b>g</b> (greek), <b>s</b> (symbol) to choose an alphabet.<br>Enter letters (<b>a</b> or <b>A</b>) to change the name.<br>Enter numbers (<b>1</b>, <b>2</b>, <b>12</b>) to add a subscript<br>Delete with <b>BACKSPACE</b>, confirm with <b>ENTER</b> or click.",n.t="Press <b>DEL</b> to delete the transition.<br>Press <b>INS</b> to rename the transition.<br>Hold <b>t</b> to choose a transition target (<b>s</b>ource, <b>f</b>actor).<br>Click an empty space for more options.",n.tr=n.sr,n.sm=n.s,n.tm=n.t;var s=n;const i={check:"",Delete:"",rename:"",in:"",out:"",S:"",G:"",L:"",up:"",low:"",T:"",X:"",target:"",source:""};i.check="Confirm the name",i.Delete="Delete the active",i.rename="Click this button to Rename",i.in="Create a specialArrow in",i.out="Create a specialArrow out",i.S="special alphabet keyboard",i.G="greek alphabet keyboard",i.L="latin alphabet keyboard",i.up="Upper case alphabet",i.low="Lower case alphabet",i.T="Create a new Transition",i.X="Vallidate your input",i.target="Choose a new target",i.source="Choose a new source";var o=i;const r={L:{S:null,C:null},G:{S:null,C:null},S:{S:null,C:null}};r.L.S={A:119886,B:119887,C:119888,D:119889,E:119890,F:119891,G:119892,H:8462,I:119894,J:119895,K:119896,L:119897,M:119898,N:119899,O:119900,P:119901,Q:119902,R:119903,S:119904,T:119905,U:119906,V:119907,W:119908,X:119909,Y:119910,Z:119911,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.L.C={A:119860,B:119861,C:119862,D:119863,E:119864,F:119865,G:119866,H:119867,I:119868,J:119869,K:119870,L:119871,M:119872,N:119873,O:119874,P:119875,Q:119876,R:119877,S:119878,T:119879,U:119880,V:119881,W:119882,X:119883,Y:119884,Z:119885,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.G.S={A:120572,B:120573,C:120585,D:120575,E:120576,F:120593,G:120574,H:120578,I:120580,J:120589,K:120581,L:120582,M:120583,N:120584,O:120586,P:120587,Q:120579,R:120588,S:120590,T:120591,U:120592,W:120596,X:120594,Y:120595,Z:120577,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.G.C={A:120546,B:120547,C:120559,D:120549,E:120550,F:120567,G:120548,H:120552,I:120554,K:120555,L:120556,M:120557,N:120558,O:120560,P:120561,Q:120553,R:120562,S:120564,T:120565,U:120566,W:120570,X:120568,Y:120569,Z:120551,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.S.S={E:120598,F:120601,K:120600,P:120603,Q:120599,R:120602,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329},r.S.C={Q:120563,0:8320,1:8321,2:8322,3:8323,4:8324,5:8325,6:8326,7:8327,8:8328,9:8329};var l=r;var c={stateRadius:20,snapToPadding:6,hitTargetPadding:6,instancesLimit:1e6,specialArrowLimit:5,stateDefaultColour:"black",stateSelectedColour:"blue",stateTransitionFactorColour:"red",transitionDefaultColour:"black",transitionSelectedColour:"blue",transitionStateFactorColour:"red",stateKeys:{Rename:45,Delete:46,Transition:17},transitionKeys:{Rename:45,Delete:46,Target:84,Source:83,Factor:70},canvas:null,context:null,buildString:e=>{let t="";for(let a=0;a<e.length;a+=1)t+=String.fromCodePoint(e[a]);return t}};var d=class{constructor(e,t,a,n=c.stateRadius){this.radius=n,this.x=Math.min(t,c.canvas.width-this.radius),this.x=Math.max(this.x,this.radius),this.y=Math.min(a,c.canvas.height-this.radius),this.y=Math.max(this.y,this.radius),this.moveOffsetX=0,this.moveOffsetY=0,this.id=e,this.nameArr=[],this.name="",this.data=[],this.colour=c.stateDefaultColour,this.lineWidth=1,this.transitions={in:[],out:[],factor:[]}}transitionAdd(e,t){this.transitions[t][e.id]=e}transitionDelete(e,t){delete this.transitions[t][e.id]}updateTransitions(){let e;for(e in this.transitions.factor)this.transitions.factor[e].nameUpdate()}activate(){let e;for(e in this.colour=c.stateSelectedColour,this.transitions.factor)this.transitions.factor[e].colour=c.stateTransitionFactorColour}deactivate(){let e;for(e in this.colour=c.stateDefaultColour,this.transitions.factor)this.transitions.factor[e].colour=c.transitionDefaultColour}moveStart(e,t){this.moveOffsetX=e-this.x,this.moveOffsetY=t-this.y}move(e,t){let a;for(a in this.x=e-this.moveOffsetX,this.y=t-this.moveOffsetY,this.x=Math.min(this.x,c.canvas.width-this.radius),this.x=Math.max(this.x,this.radius),this.y=Math.min(this.y,c.canvas.height-this.radius),this.y=Math.max(this.y,this.radius),this.transitions.in)this.transitions.in[a].updateShape();for(a in this.transitions.out)this.transitions.out[a].updateShape()}moveStop(){this.moveOffsetX=0,this.moveOffsetY=0}nameAddChr(e){this.nameArr.push(e),this.name+=String.fromCodePoint(e)}nameRemoveChr(){return 0!==this.nameArr.length&&(this.nameArr.pop(),this.name=c.buildString(this.nameArr),!0)}draw(){if(0!==this.radius){const e=c.context;e.lineWidth=this.lineWidth,e.strokeStyle=this.colour,e.fillStyle=this.colour,e.font="20px Verdana, Geneva, Tahoma, sans-serif",e.textAlign="center",e.textBaseline="middle",e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI),e.stroke(),e.fillText(this.name,this.x,this.y)}}closestPointOnCircle(e,t){const a=e-this.x,n=t-this.y,s=Math.sqrt(a*a+n*n);return{x:this.x+a*this.radius/s,y:this.y+n*this.radius/s}}};let h={},u={};function p(e){return e.preventDefault(),0!==e.button||(h.mouseDown(e),u.focus()),!1}function b(e){return e.preventDefault(),!1}function v(e){return e.preventDefault(),!1}function m(e){return e.preventDefault(),h.dblClick(e),!1}function f(e){return e.preventDefault(),0===e.button&&h.mouseCancel(e),!1}function g(e){h.mouseCancel(e)}function y(e){h.mouseMove(e)}function S(e){return e.preventDefault(),h.keyDown(e),!1}function w(e){h.keyUp(e)}var k=function(e,t){u=e,h=t,u.addEventListener("mousedown",p),u.addEventListener("click",b),u.addEventListener("dblclick",m),u.addEventListener("contextmenu",v),u.addEventListener("mousemove",y),u.addEventListener("mouseup",f),u.addEventListener("mouseout",g),u.addEventListener("keydown",S),u.addEventListener("keyup",w)};let C={};const x={};let D={},A={};function I(){let e;return e="s"===D.state?D.selectionTransitionTarget?"t":"i":"sm"===D.state?"m":"sr"===D.state?"r":null,e}x.mouseDown=e=>{switch(I()){case"i":D.systemStateMouseDown(e.offsetX,e.offsetY);break;case"t":A.stateSelectTransitionTarget(e);break;case"r":A.stateRenameExitSelect(e)}},x.mouseMove=e=>{"m"===I()&&D.moveObject(e)},x.mouseCancel=()=>{"m"===I()&&D.moveStop()},x.keyDown=e=>{const t=I(),a=e.keycode||e.which;switch(t){case"i":!function(e){switch(e){case C.Transition:A.stateActivateTransition();break;case C.Rename:A.stateActivateRename();break;case C.Delete:A.stateActivateDelete()}}(a);break;case"r":A.renameKeyDown(e)}},x.keyUp=e=>{const t=I(),a=e.keycode||e.which;"t"===t&&a===C.Transition&&A.stateActivateIdle()},x.init=(e,t,a)=>{D=e,C=a,A=t};var T=x;let M={};const E={};let O={},P={};function K(){let e;return e="t"===O.state?O.selectionTransitionTarget?"t":O.selectionTransitionSource?"s":O.selectionTransitionFactor?"f":"i":"tm"===O.state?"m":"tr"===O.state?"r":null,e}E.mouseDown=e=>{switch(K()){case"i":O.systemStateMouseDown(e.offsetX,e.offsetY);break;case"t":P.transitionSelectTarget(e);break;case"s":P.transitionSelectSource(e);break;case"f":P.transitionSelectFactor(e);break;case"r":P.transitionRenameExitSelect(e)}},E.mouseMove=e=>{"m"===K()&&O.moveObject(e)},E.mouseCancel=()=>{"m"===K()&&O.moveStop()},E.keyDown=e=>{switch(K()){case"i":!function(e){switch(e.keycode||e.which){case M.Target:P.transitionActivateTarget();break;case M.Source:P.transitionActivateSource();break;case M.Factor:P.transitionActivateFactor();break;case M.Rename:P.transitionActivateRename();break;case M.Delete:P.transitionActivateDelete()}}(e)}},E.keyUp=e=>{const t=K(),a=e.keycode||e.which;("t"===t&&a===M.Target||"s"===t&&a===M.Source||"f"===t&&a===M.Factor)&&P.transitionActivateIdle()},E.init=(e,t,a)=>{O=e,P=t,M=a};var X=E;const B={};let H={},R={};B.mouseDown=e=>{H.systemStateMouseDown(e.offsetX,e.offsetY)},B.dblClick=e=>{R.stateCreate(e)},B.init=(e,t)=>{H=e,R=t};var L=B;const j={};let N={};function G(){let e;switch(N.state){case"s":case"sr":case"sm":e="s";break;case"t":case"tr":case"tm":e="t";break;case"i":e="i"}return e}j.mouseDown=e=>{switch(G()){case"i":L.mouseDown(e);break;case"s":T.mouseDown(e);break;case"t":X.mouseDown(e)}},j.dblClick=e=>("i"!==G()||L.dblClick(e),!1),j.mouseCancel=()=>{switch(G()){case"s":T.mouseCancel();break;case"t":X.mouseCancel()}},j.mouseMove=e=>{switch(G()){case"s":T.mouseMove(e);break;case"t":X.mouseMove(e)}},j.keyDown=e=>{switch(G()){case"s":T.keyDown(e);break;case"t":X.keyDown(e)}},j.keyUp=e=>{switch(G()){case"s":T.keyUp(e);break;case"t":X.keyUp(e)}};var F=function(e,t,a,n,s,i){k(e,j),N=t,L.init(N,a),T.init(N,a,s),X.init(N,n,i)};let V={},U={},z=0,Y=0,J=100;const _={s:0,t:0},W={};function q(e,t,a){return V.beginPath(),V.arc(a.x,a.y,Y,0,2*Math.PI),V.closePath(),!!V.isPointInPath(e,t)}function Z(e,t,a){const n=a.shape.source.point,s=a.shape.target.point,i=s.x-n.x,o=s.y-n.y,r=Math.sqrt(i*i+o*o),l=(i*(e-n.x)+o*(t-n.y))/(r*r),c=(i*(t-n.y)-o*(e-n.x))/r;return l>0&&l<1&&Math.abs(c)<z}W.shMap=new Map,W.getShape=e=>W.shMap.get(e),W.findShape=(e,t)=>{let a,n,s;for([a,s]of W.shMap)switch(n=a.substring(0,1),n){case"s":if(q(e,t,s))return s;break;case"t":if(Z(e,t,s))return s}return null},W.stateconflict=e=>{let t,a,n;const s=e.id;for([t,a]of W.shMap)switch(n=t.substring(0,1),n){case"s":if((e.x-a.x)*(e.x-a.x)+(e.y-a.y)*(e.y-a.y)<=4*Y*Y&&s!==t)return!0}return!1},W.findStateNameConflict=e=>{let t,a;const n=e.id,s=e.name;for([t,a]of W.shMap)if("s"===t.substring(0,1)&&a.name===s&&t!==n)return a;return null},W.generateFreeID=e=>_[e]>=J?"":(_[e]+=1,e+(_[e]-1)),W.draw=()=>{let e;for(e of(V.clearRect(0,0,U.width,U.height),W.shMap.values()))e.draw()},W.addShape=(e,t)=>{W.shMap.set(e,t)},W.deleteShape=e=>{W.shMap.delete(e)},W.init=(e,t,a,n)=>{U=e,V=U.getContext("2d"),Y=t,z=a,J=n};var Q=W;let ee={},te={},ae={},ne=0;const se={stateSelectTransitionTarget:e=>{const t=te.activeShape,a=ee.findShape(e.offsetX,e.offsetY);if(null==a||"s"!==a.id.substring(0,1)||a.id===t.id)return;t.deactivate();const n=ae.transitionCreate(t,a);te.systemStateActivate("tr",n),ee.draw()},renameKeyDown:e=>{let t=e.keyCode||e.which;const a=te.activeShape;if(13===t&&se.renameValidate())return te.systemStateActivate("s",a),ee.draw(),!0;if(e.ctrlKey)return t=String.fromCharCode(t),"L"!==t&&"G"!==t&&"S"!==t||(te.alphabet=t),!0;if(8===t)return a.nameRemoveChr(),ee.draw(),!0;t=String.fromCharCode(t);const n=te.symbols[te.alphabet][e.shiftKey?"C":"S"][t];return void 0===n||(a.nameAddChr(n),ee.draw()),!0},stateName:e=>"sr"===te.state&&(te.activeShape.nameAddChr(e),ee.draw(),!0),nameRemoveToken:()=>(te.activeShape.nameRemoveChr(),ee.draw(),!0),checkName:()=>{if(se.renameValidate())return te.systemStateActivate("s",te.activeShape),ee.draw(),!0},stateRenameExitSelect:e=>{se.renameValidate()&&te.systemStateMouseDown(e.offsetX,e.offsetY)},renameValidate:()=>{const e=te.activeShape;if(0===e.name.length)return alert("Please provide a name!"),!1;if("ð‘"===e.name)return alert("The name ð‘ is blocked!"),!1;return null!==ee.findStateNameConflict(e)?(alert("There already exists a state with this name!"),!1):(e.name!==te.nameOld&&(e.updateTransitions(),te.callback(ee.shMap)),!0)},stateActivateTransition:()=>{te.selectionTransitionTarget=!0},stateActivateRename:()=>{te.systemStateActivate("sr",te.activeShape)},stateActivateDelete:()=>{"s0"!==te.activeShape.id&&(se.stateDelete(te.activeShape),te.systemStateActivate("i",null),ee.draw())},stateActivateIdle:()=>{te.selectionTransitionTarget=!1},stateCreate:e=>{const t=ee.generateFreeID("s");if(0===t.length)return alert("Only "+ne+" states allowed, limit reached!"),!1;const a=new d(t,e.offsetX,e.offsetY);return ee.stateconflict(a)?(alert("Collision with another State"),!1):(ee.addShape(t,a),te.systemStateActivate("sr",a),ee.draw(),!1)},stateDelete:e=>{let t;for(t in e.deactivate(),e.transitions.in)ae.transitionDelete(ee.getShape(t),!1);for(t in e.transitions.out)ae.transitionDelete(ee.getShape(t),!1);for(t in e.transitions.factor)ae.transitionDelete(ee.getShape(t),!1);ee.deleteShape(e.id),te.callback(ee.shMap)},init:(e,t,a,n)=>{ee=e,te=t,ae=a,ne=n}};var ie=se;var oe=class{constructor(e,t,a){this.id=e,this.nameArr=[],this.name="",this.colour=c.transitionDefaultColour,this.lineWidth=1,this.shape={source:{point:{x:0,y:0}},target:{point:{x:0,y:0}}},this.factors=[],t.transitionAdd(this,"out"),a.transitionAdd(this,"in"),this.source=t,this.target=a,this.updateShape()}delete(){let e;for(e in this.deactivate(),this.source.transitionDelete(this,"out"),this.target.transitionDelete(this,"in"),this.factors)this.factors[e].transitionDelete(this,"factor")}setTarget(e){this.target.transitionDelete(this,"in"),this.target=e,e.transitionAdd(this,"in"),this.updateShape()}setSource(e){this.source.transitionDelete(this,"out"),this.source=e,e.transitionAdd(this,"out"),this.updateShape()}activate(){let e;for(e in this.colour=c.transitionSelectedColour,this.factors)this.factors[e].colour=c.transitionStateFactorColour}deactivate(){let e;for(e in this.colour=c.transitionDefaultColour,this.factors)this.factors[e].colour=c.stateDefaultColour}moveStart(e,t){}move(e,t){}moveStop(){}updateShape(){const e=(this.source.x+this.target.x)/2,t=(this.source.y+this.target.y)/2;this.shape.source.point=this.source.closestPointOnCircle(e,t),this.shape.target.point=this.target.closestPointOnCircle(e,t)}nameUpdate(){let e,t,a;const n=this.nameArr,s=n.length;for(this.name="",e=0;e<s;e+=1)[t,a]=n[e],this.name+="s"!==t?String.fromCodePoint(a):a.name}factorUpdate(){let e,t,a;const n=this.nameArr,s=n.length;for(e in this.factors)this.factors[e].transitionDelete(this,"factor"),this.factors[e].colour=c.stateDefaultColour;for(this.factors=[],e=0;e<s;e+=1)[t,a]=n[e],"s"===t&&(this.factors[a.id]=a,a.transitionAdd(this,"factor"),a.colour=c.transitionStateFactorColour)}nameAddToken(e,t){const a=this.nameArr,n=a.length,s=n>0?a[n-1][0]:"";return("o"!==e||"o"!==s)&&(this.nameArr.push([e,t]),this.nameUpdate(),this.factorUpdate(),!0)}nameRemoveToken(){return 0!==this.nameArr.length&&(this.nameArr.pop(),this.nameUpdate(),this.factorUpdate(),!0)}nameNormalize(){const e=this.nameArr,t=e.length;t>0&&"o"===e[t-1][0]&&this.nameRemoveToken()}draw(){const e=c.context;e.lineWidth=this.lineWidth,e.strokeStyle=this.colour,e.fillStyle=this.colour,e.font="20px Verdana, Geneva, Tahoma, sans-serif",e.textAlign="center",e.textBaseline="middle",e.beginPath(),e.moveTo(this.shape.source.point.x,this.shape.source.point.y),e.lineTo(this.shape.target.point.x,this.shape.target.point.y),e.stroke();let t=this.shape.target.point.x-this.shape.source.point.x,a=this.shape.target.point.y-this.shape.source.point.y;const n=Math.sqrt(t*t+a*a);t/=n,a/=n,e.beginPath(),e.moveTo(this.shape.target.point.x,this.shape.target.point.y),e.lineTo(this.shape.target.point.x-8*t+5*a,this.shape.target.point.y-8*a-5*t),e.lineTo(this.shape.target.point.x-8*t-5*a,this.shape.target.point.y-8*a+5*t),e.fill();let s=(this.shape.source.point.x+this.shape.target.point.x)/2,i=(this.shape.source.point.y+this.shape.target.point.y)/2;s+=15*a,i+=-15*t,e.fillText(this.name,s,i)}};let re={},le={},ce={},de=0;const he={transitionCreate:(e,t)=>{const a=re.generateFreeID("t");if(0===a.length)return alert("Only "+de+" transitions allowed, limit reached!"),null;const n=new oe(a,e,t);return re.addShape(a,n),n},transitionSelectTarget:e=>{ce.rearrangement();const t=re.findShape(e.offsetX,e.offsetY);null!==t&&"s"===t.id.substring(0,1)&&t.id!==le.activeShape.source.id&&t.id!==le.activeShape.target.id&&(ce.limitspAinreached(t)?alert("limit reached"):(le.activeShape.deactivate(),le.activeShape.setTarget(t),le.activeShape.activate(),ce.arrangement(),le.callback(re.shMap),re.draw()))},transitionSelectSource:e=>{ce.rearrangement();const t=re.findShape(e.offsetX,e.offsetY);null!=t&&"s"===t.id.substring(0,1)&&t.id!==le.activeShape.source.id&&t.id!==le.activeShape.target.id&&(ce.limitspAoutreached(t)?alert("limit reached"):(le.activeShape.deactivate(),le.activeShape.setSource(t),le.activeShape.activate(),ce.arrangement(),le.callback(re.shMap),re.draw()))},transitionSelectFactor:e=>{const t=re.findShape(e.offsetX,e.offsetY);null!==t&&"s"===t.id.substring(0,1)&&(le.activeShape.deactivate(),le.activeShape.toggleFactor(t),le.activeShape.activate(),le.callback(re.shMap),re.draw())},transitionActivateTarget:()=>{le.selectionTransitionTarget=!0},transitionActivateSource:()=>{le.selectionTransitionSource=!0},transitionActivateFactor:()=>{le.selectionTransitionFactor=!0},transitionActivateDelete:()=>{he.transitionDelete(le.activeShape),le.systemStateActivate("i",null),re.draw()},transitionActivateIdle:()=>{le.selectionTransitionTarget=!1,le.selectionTransitionSource=!1,le.selectionTransitionFactor=!1},transitionDelete:(e,t=!0)=>{e.delete(),re.deleteShape(e.id),t&&le.callback(re.shMap)},transitionActivateRename:()=>{le.systemStateActivate("tr",le.activeShape)},nameValidate:()=>{const e=le.activeShape;return 0===e.name.length?(alert("Please provide a name!"),!1):(e.name!==le.nameOld&&le.callback(re.shMap),!0)},nameAppendRate:e=>"tr"===le.state&&(le.activeShape.nameAddToken("r",e),re.draw(),!0),nameAppendPlus:()=>"tr"===le.state&&(le.activeShape.nameAddToken("o",65291),re.draw(),!0),nameConfirm:()=>"tr"===le.state&&(le.activeShape.nameNormalize(),re.draw(),!!he.nameValidate()&&(le.systemStateActivate("t",le.activeShape),re.draw(),!0)),transitionRenameExitSelect:e=>{le.activeShape.nameNormalize(),he.nameValidate()&&le.systemStateMouseDown(e.offsetX,e.offsetY)},nameAppendState:e=>"tr"===le.state&&(le.activeShape.nameAddToken("s",e),re.draw(),!0),nameRemoveToken:()=>"tr"===le.state&&(le.activeShape.nameRemoveToken(),re.draw(),!0),init:(e,t,a,n)=>{re=e,le=t,de=a,ce=n}};var ue=he;const pe=[],be={addListener:e=>{pe.push(e)},update:e=>{pe.forEach(t=>{t(e)})}};var ve=be;let me="http://www.w3.org/2000/svg",fe=35;const ge={setNS:e=>{me=e},getNS:()=>me,setKeySize:e=>{fe=e},getKeySize:()=>fe,createKey:function(e,t,a){const n=document.createElementNS(me,"g");return n.setAttributeNS(null,"transform","translate("+e+","+t+")"),n.appendChild(function(){const e=document.createElementNS(me,"rect");return e.setAttributeNS(null,"x",0),e.setAttributeNS(null,"y",0),e.setAttributeNS(null,"width",fe),e.setAttributeNS(null,"height",fe),e.style.strokeWidth=1,e.style.stroke="black",e.setAttributeNS(null,"fill","white"),e}()),n.appendChild(function(e){const t=document.createElementNS(me,"text");return t.setAttributeNS(null,"x",.5*fe),t.setAttributeNS(null,"y",.5*fe),t.style.textAnchor="middle",t.style.alignmentBaseline="central",t.style.font="20px Verdana, Geneva, Tahoma, sans-serif",t.style.fill="black",t.style.pointerEvents="none",t.innerHTML=e,t}(a)),n}};var ye=ge;let Se="http://www.w3.org/2000/svg",we=35,ke=13;const Ce={check:null,del:null,plus:null,L:null,G:null,S:null,up:null,low:null,Del:null,R:null,T:null,X:null,target:null,source:null,in:null,out:null,checkenter:null,Deleteenter:null,Renter:null,inenter:null,outenter:null,Lenter:null,Genter:null,Senter:null,upenter:null,lowenter:null,Tenter:null,Xenter:null,targetenter:null,sourceenter:null},xe=10003,De=11013,Ae=65291,Ie=76,Te=71,Me=83,Ee=8593,$e=8595,Oe=9249,Pe=82,Ke=8594,Xe=88,Be=8614,He=8620,Re=8681,Le=8679;function je(e,t){t.addEventListener("mousedown",t=>(t.preventDefault(),0!==t.button||Ce[e](),!1))}function Ne(e,t){t.addEventListener("mouseenter",t=>(t.preventDefault(),0!==t.button||Ce[e](),!1))}const Ge={setNS:e=>{Se=e},getNS:()=>Se,setKeySize:e=>{we=e},getKeySize:()=>we,setColoumnCount:e=>{ke=e},getColoumnCount:()=>ke,setHandler:(e,t)=>{Ce[e]=t},getHandler:e=>Ce[e],create:function(e,t,a){let n,s;ye.setKeySize(we),ye.setNS(Se);const i=document.createElementNS(Se,"g");switch(i.setAttributeNS(null,"transform","translate("+e+","+t+")"),a){case"s":s=String.fromCodePoint(Oe),n=ye.createKey(we*(ke-13),0,s),je("Del",n),Ne("Deleteenter",n),i.appendChild(n),s=String.fromCodePoint(Pe),n=ye.createKey(we*(ke-12),0,s),je("R",n),Ne("Renter",n),i.appendChild(n),s=String.fromCodePoint(Ke),n=ye.createKey(we*(ke-11),0,s),je("T",n),Ne("Tenter",n),i.appendChild(n),s=String.fromCodePoint(Re),n=ye.createKey(we*(ke-10),0,s),je("in",n),Ne("inenter",n),i.appendChild(n),s=String.fromCodePoint(Le),n=ye.createKey(we*(ke-9),0,s),je("out",n),Ne("outenter",n),i.appendChild(n);break;case"t":s=String.fromCodePoint(Oe),n=ye.createKey(we*(ke-13),0,s),je("Del",n),Ne("Deleteenter",n),i.appendChild(n),s=String.fromCodePoint(Pe),n=ye.createKey(we*(ke-12),0,s),je("R",n),i.appendChild(n),Ne("Renter",n),s=String.fromCodePoint(Be),n=ye.createKey(we*(ke-11),0,s),je("target",n),Ne("targetenter",n),i.appendChild(n),s=String.fromCodePoint(He),n=ye.createKey(we*(ke-10),0,s),je("source",n),Ne("sourceenter",n),i.appendChild(n);break;case"tspecialin":s=String.fromCodePoint(Oe),n=ye.createKey(we*(ke-13),0,s),je("Del",n),Ne("Deleteenter",n),i.appendChild(n),s=String.fromCodePoint(Pe),n=ye.createKey(we*(ke-12),0,s),je("R",n),Ne("Renter",n),i.appendChild(n),s=String.fromCodePoint(Be),n=ye.createKey(we*(ke-11),0,s),je("target",n),Ne("targetenter",n),i.appendChild(n);break;case"tspecialout":s=String.fromCodePoint(Oe),n=ye.createKey(we*(ke-13),0,s),je("Del",n),Ne("Deleteenter",n),i.appendChild(n),s=String.fromCodePoint(Pe),n=ye.createKey(we*(ke-12),0,s),je("R",n),Ne("Renter",n),i.appendChild(n),s=String.fromCodePoint(He),n=ye.createKey(we*(ke-10),0,s),je("source",n),Ne("sourceener",n),i.appendChild(n);break;case"X":s=String.fromCodePoint(Xe),n=ye.createKey(we*(ke-13),0,s),je("X",n),Ne("Xenter",n),i.appendChild(n);break;case"name":s=String.fromCodePoint(Ae),n=ye.createKey(we*(ke-5),0,s),je("plus",n),i.appendChild(n),s=String.fromCodePoint(De),n=ye.createKey(we*(ke-3),0,s),je("del",n),i.appendChild(n),s=String.fromCodePoint(xe),n=ye.createKey(we*(ke-1),0,s),je("check",n),Ne("checkenter",n),i.appendChild(n),s=String.fromCodePoint(Ie),n=ye.createKey(we*(ke-13),0,s),je("L",n),Ne("Lenter",n),i.appendChild(n),s=String.fromCodePoint(Te),n=ye.createKey(we*(ke-12),0,s),je("G",n),Ne("Genter",n),i.appendChild(n),s=String.fromCodePoint(Me),n=ye.createKey(we*(ke-11),0,s),je("S",n),Ne("Senter",n),i.appendChild(n),s=String.fromCodePoint(Ee),n=ye.createKey(we*(ke-9),0,s),je("up",n),Ne("upenter",n),i.appendChild(n),s=String.fromCodePoint($e),n=ye.createKey(we*(ke-8),0,s),je("low",n),Ne("lowenter",n),i.appendChild(n)}return i}};var Fe=Ge;let Ve="http://www.w3.org/2000/svg",Ue=35,ze=13,Ye=null;function Je(e,t){t.addEventListener("mousedown",t=>(t.preventDefault(),0!==t.button||Ye(e),!1))}const _e={setNS:e=>{Ve=e},getNS:()=>Ve,setKeySize:e=>{Ue=e},getKeySize:()=>Ue,setColoumnCount:e=>{ze=e},getColoumnCount:()=>ze,setHandler:e=>{Ye=e},getHandler:()=>Ye,createAlphabet:function(e,t,a,n){let s,i,o,r,c=0,d=0,h=65;ye.setKeySize(Ue),ye.setNS(Ve);const u=document.createElementNS(Ve,"g");for(u.setAttributeNS(null,"transform","translate("+e+","+t+")");h<91;)s=String.fromCharCode(h),i=l[a][n][s],void 0!==i&&(o=String.fromCodePoint(i),r=ye.createKey(d*Ue,c*Ue,o),Je(i,r),u.appendChild(r),d+=1,d===ze&&(d=0,c+=1)),h+=1;return u}};var We=_e;let qe=35,Ze=13,Qe="http://www.w3.org/2000/svg",et=null;const tt={};function at(e,t){t.addEventListener("mousedown",t=>(t.preventDefault(),0!==t.button||et(e),!1))}tt.setNS=e=>{Qe=e},tt.getNS=()=>Qe,tt.setKeySize=e=>{qe=e},tt.getKeySize=()=>qe,tt.setColoumnCount=e=>{Ze=e},tt.getColoumnCount=()=>Ze,tt.getHandler=()=>et,tt.setHandler=e=>{et=e},tt.create=function(e,t,a){let n,s,i,o=0,r=0;ye.setKeySize(qe),ye.setNS(Qe);const l=document.createElementNS(Qe,"g");for([n,s]of(l.setAttributeNS(null,"transform","translate("+e+","+t+")"),a))"n"===n.substring(0,1)&&(i=ye.createKey(r*qe,o*qe,s.name),at(s,i),l.appendChild(i),r+=1,r===Ze&&(r=0,o+=1)),"s"===n.substring(0,1)&&(i=ye.createKey(r*qe,o*qe,s.name),at(s,i),l.appendChild(i),r+=1,r===Ze&&(r=0,o+=1));return l};var nt=tt;let st="http://www.w3.org/2000/svg",it=13,ot=35,rt=10,lt=null,ct=null,dt=null,ht=null,ut=null,pt=null,bt=null;const vt={plus:null,del:null,check:null,L:null,G:null,S:null,up:null,low:null,Del:null,R:null,T:null,X:null,target:null,source:null,in:null,out:null,checkenter:null,Deleteenter:null,Renter:null,inenter:null,outenter:null,Lenter:null,Genter:null,Senter:null,upenter:null,lowenter:null,Tenter:null,Xenter:null,targetenter:null,sourceenter:null};let mt=[10,55];const ft={};function gt(){nt.setColoumnCount(it),nt.setKeySize(ot),nt.setNS(st),nt.setHandler(bt)}function yt(e){gt();const t=nt.create(mt[0],mt[1],e);null!==ht&&ct.removeChild(ht),ct.appendChild(t),ht=t}ft.updateAlphabet=(e,t)=>{ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,e,t),ct.appendChild(dt)},ft.Alphabetvisibility=e=>{dt.setAttributeNS(null,"visibility",e)},ft.updateAlphabetCase=e=>{if("up"==e){let e=dt.getElementsByTagName("text")[0].innerHTML;switch(e=e.charCodeAt(1),e){case 56398:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"L","C"),ct.appendChild(dt);break;case 57084:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"G","C"),ct.appendChild(dt);break;case 57110:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"S","C"),ct.appendChild(dt)}}else{let e=dt.getElementsByTagName("text")[0].innerHTML;switch(e=e.charCodeAt(1),e){case 56372:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"L","S"),ct.appendChild(dt);break;case 57058:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"G","S"),ct.appendChild(dt);break;case 57075:ct.removeChild(dt),dt=We.createAlphabet(rt,2*rt+ot,"S","S"),ct.appendChild(dt)}}},ft.updateSpecialKeys=e=>{ct.removeChild(ut),ut=Fe.create(rt,rt,e),ct.appendChild(ut)},ft.StateKeysvisibility=e=>{ht.setAttributeNS(null,"visibility",e)},ft.visibility=e=>{ct.setAttributeNS(null,"visibility",e)},ft.init=(e,t)=>{lt=e,function(){const e=2*rt+ot*it,t=4*rt+5*ot;ct=document.createElementNS(st,"svg"),ct.setAttributeNS(null,"width",e+"px"),ct.setAttributeNS(null,"height",t+"px")}(),Fe.setKeySize(ot),Fe.setNS(st),Fe.setColoumnCount(it),Fe.setHandler("plus",vt.plus),Fe.setHandler("del",vt.del),Fe.setHandler("check",vt.check),Fe.setHandler("L",vt.L),Fe.setHandler("G",vt.G),Fe.setHandler("S",vt.S),Fe.setHandler("up",vt.up),Fe.setHandler("low",vt.low),Fe.setHandler("Del",vt.Del),Fe.setHandler("R",vt.R),Fe.setHandler("T",vt.T),Fe.setHandler("X",vt.X),Fe.setHandler("target",vt.target),Fe.setHandler("source",vt.source),Fe.setHandler("in",vt.in),Fe.setHandler("out",vt.out),Fe.setHandler("checkenter",vt.checkenter),Fe.setHandler("Deleteenter",vt.Deleteenter),Fe.setHandler("Renter",vt.Renter),Fe.setHandler("inenter",vt.inenter),Fe.setHandler("outenter",vt.outenter),Fe.setHandler("Senter",vt.Senter),Fe.setHandler("Genter",vt.Genter),Fe.setHandler("Lenter",vt.Lenter),Fe.setHandler("upenter",vt.upenter),Fe.setHandler("lowenter",vt.lowenter),Fe.setHandler("Tenter",vt.Tenter),Fe.setHandler("Xenter",vt.Xenter),Fe.setHandler("targetenter",vt.targetenter),Fe.setHandler("sourceenter",vt.sourceenter),We.setColoumnCount(it),We.setKeySize(ot),We.setNS(st),We.setHandler(pt),gt(),t.addListener(yt),mt=[rt,3*rt+3*ot],ut=Fe.create(rt,rt,"name"),ct.appendChild(ut),dt=We.createAlphabet(rt,2*rt+ot,"L","C"),ct.appendChild(dt),lt.appendChild(ct),ct.setAttributeNS(null,"visibility","hidden"),document.getElementById("inID").style.visibility="hidden"},ft.setNS=e=>{st=e},ft.getNS=()=>st,ft.setKeySize=e=>{ot=e},ft.getKeySize=()=>ot,ft.setColoumnCount=e=>{it=e},ft.getColoumnCount=()=>it,ft.setAlphabetHandler=e=>{pt=e},ft.getAlphabetHandler=()=>pt,ft.setStateKeyHandler=e=>{bt=e},ft.getStateKeyHandler=()=>bt,ft.setPadding=e=>{rt=e},ft.setSpecialKeyHandler=(e,t)=>{vt[e]=t},ft.getSpecialKeyHandler=e=>vt[e],ft.getPadding=()=>rt;var St=ft;let wt={},kt={},Ct={},xt={},Dt={},At=0;const It={updateAlphabetL:()=>{St.updateAlphabet("L","C")},updateAlphabetG:()=>{St.updateAlphabet("G","S")},updateAlphabetS:()=>{St.updateAlphabet("S","S")},updateAlphabetlow:()=>{St.updateAlphabetCase("low")},updateAlphabetup:()=>{St.updateAlphabetCase("up")},letterIn:e=>{switch(wt.state[0]){case"s":Ct.stateName(e);break;case"t":kt.nameAppendRate(e)}},RemoveTolken:()=>{switch(wt.state){case"sr":Ct.nameRemoveToken();break;case"tr":kt.nameRemoveToken()}},check:()=>{switch(wt.state[0]){case"s":Ct.checkName();break;case"t":kt.nameConfirm()}},delete:()=>{switch(wt.state[0]){case"s":Ct.stateActivateDelete();break;case"t":xt.rearrangement(),kt.transitionActivateDelete()}},rename:()=>{switch(wt.state[0]){case"s":Ct.stateActivateRename();break;case"t":kt.transitionActivateRename()}},arrowIn:()=>{xt.specialArrowCreate("in")},arrowOut:()=>{xt.specialArrowCreate("out")},newTransition:()=>{Ct.stateActivateTransition(),St.updateSpecialKeys("X")},leaveX:()=>{switch(wt.state){case"s":Ct.stateActivateIdle(),St.updateSpecialKeys("s"),It.systemupdate("s");break;case"t":kt.transitionActivateIdle(),St.updateSpecialKeys("t"),It.systemupdate("t")}},transitiontarget:()=>{kt.transitionActivateTarget(),St.updateSpecialKeys("X")},transitionsource:()=>{kt.transitionActivateSource(),St.updateSpecialKeys("X")},showinfo:e=>{let t=window.event,a=document.getElementById("infoID");a.style.left=t.clientX+"px";let n=t.clientY-50;a.style.top=n+"px",a.style.visibility="visible",a.innerHTML=e,0===At&&(At++,setTimeout((function(){a.style.visibility="hidden",At=0}),1250))},systemupdate:e=>{let t=document.getElementById("inID");switch(e){case"s":t.style.visibility="visible",St.visibility("visible"),St.updateSpecialKeys("s"),St.Alphabetvisibility("hidden"),St.StateKeysvisibility("hidden");break;case"sr":t.style.visibility="visible",St.visibility("visible"),It.updateAlphabetL(),St.Alphabetvisibility("visible"),St.updateSpecialKeys("name"),St.StateKeysvisibility("hidden");break;case"sm":t.style.visibility="hidden",St.visibility("hidden"),St.Alphabetvisibility("hidden");break;case"t":switch(wt.activeShape.type){case void 0:t.style.visibility="visible",St.visibility("visible"),St.updateSpecialKeys("t"),St.Alphabetvisibility("hidden"),St.StateKeysvisibility("hidden");break;case"in":t.style.visibility="visible",St.visibility("visible"),St.updateSpecialKeys("tspecialin"),St.Alphabetvisibility("hidden"),St.StateKeysvisibility("hidden");break;case"out":t.style.visibility="visible",St.visibility("visible"),St.updateSpecialKeys("tspecialout"),St.Alphabetvisibility("hidden"),St.StateKeysvisibility("hidden")}break;case"tr":t.style.visibility="visible",St.visibility("visible"),It.updateAlphabetG(),St.Alphabetvisibility("visible"),St.updateSpecialKeys("name"),St.StateKeysvisibility("visible");break;case"tm":case"i":t.style.visibility="hidden",St.visibility("hidden"),St.Alphabetvisibility("hidden"),St.StateKeysvisibility("hidden")}},checkenter:()=>{let e=Dt.check;It.showinfo(e)},Deleteenter:()=>{let e=Dt.Delete;switch(wt.state){case"s":e+=" state";break;case"t":void 0!==wt.activeShape.type?e+=" special arrow":e+=" transition"}It.showinfo(e)},Renter:()=>{let e=Dt.rename;It.showinfo(e)},inenter:()=>{let e=Dt.in;It.showinfo(e)},outenter:()=>{let e=Dt.out;It.showinfo(e)},Senter:()=>{let e=Dt.S;It.showinfo(e)},Genter:()=>{let e=Dt.G;It.showinfo(e)},Lenter:()=>{let e=Dt.L;It.showinfo(e)},upenter:()=>{let e=Dt.up;It.showinfo(e)},lowenter:()=>{let e=Dt.low;It.showinfo(e)},Tenter:()=>{let e=Dt.T;It.showinfo(e)},Xenter:()=>{let e=Dt.X;It.showinfo(e)},tagetenter:()=>{let e=Dt.target;It.showinfo(e)},sourceenter:()=>{let e=Dt.source;It.showinfo(e)},init:(e,t,a,n,s)=>{wt=e,kt=t,Ct=a,xt=n,Dt=s}};var Tt=It;var Mt=class extends oe{constructor(e,t,a,n){super(e,t,a),this.type=n}};let Et={},$t={},Ot=0;const Pt={returnstates:e=>{let t,a,n,s=[];for([t,a]of Et.shMap)n=t.substring(0,1),"t"===n&&void 0!==a.type&&(a.source===e?s.push(a.target):a.target===e&&s.push(a.source));return s},specialArrowCreate:e=>{const t=Et.generateFreeID("s"),a=Et.generateFreeID("t");let n,s=$t.activeShape.x,i=$t.activeShape.y,o=0,r=0,l=0,c=0;const h=Pt.returnstates($t.activeShape);for(let e=0;e<h.length;e++)$t.activeShape.x-h[e].x<=0&&$t.activeShape.y-h[e].y>0||h[e].x-$t.activeShape.x>0&&h[e].y-$t.activeShape.y>0?l++:c++;if(l===Ot&&"in"===e||c===Ot&&"out"===e)return alert("Only "+Ot+" specialArrows allowed, limit reached!"),null;const u=Math.PI/Ot;switch(e){case"in":o=100*Math.cos(Math.PI/2-u*l),r=100*Math.cos(u*l);const h=new d(t,s+o,i-r,1);n=new Mt(a,h,$t.activeShape,e);break;case"out":o=100*Math.cos(Math.PI/2-u*c),r=100*Math.cos(u*c);const p=new d(t,s-o,i+r,1);n=new Mt(a,$t.activeShape,p,e)}return Et.addShape(a,n),$t.activeShape.deactivate(),$t.systemStateActivate("tr",n),Et.draw(),!1},rearrangement:()=>{let e=null;switch($t.activeShape.type){case"in":e=$t.activeShape.target;break;case"out":e=$t.activeShape.source}let t,a,n,s=0,i=0,o=0,r=0;const l=Math.PI/Ot;for([t,a]of Et.shMap)n=t.substring(0,1),"t"===n&&void 0!==a.type&&t!=$t.activeShape.id&&(a.source===e?(o=100*Math.cos(Math.PI/2-l*i),r=100*Math.cos(l*i),i++,a.target.move(e.x-o,e.y+r)):a.target===e&&(o=100*Math.cos(Math.PI/2-l*s),r=100*Math.cos(l*s),s++,a.source.move(e.x+o,e.y-r)))},arrangement:(e=$t.activeShape)=>{let t=null;switch(e.type){case"in":t=e.target;break;case"out":t=e.source}let a,n,s,i=0,o=0,r=0,l=0;const c=Math.PI/Ot;for([a,n]of Et.shMap)s=a.substring(0,1),"t"===s&&void 0!==n.type&&(n.source===t?(r=100*Math.cos(Math.PI/2-c*o),l=100*Math.cos(c*o),o++,n.target.move(t.x-r,t.y+l)):n.target===t&&(r=100*Math.cos(Math.PI/2-c*i),l=100*Math.cos(c*i),i++,n.source.move(t.x+r,t.y-l)))},arrangementstate:(e=$t.activeShape)=>{let t,a,n,s=0,i=0,o=0,r=0;const l=Math.PI/Ot;for([t,a]of Et.shMap)n=t.substring(0,1),"t"===n&&void 0!==a.type&&("out"===a.type&&a.source===e?(o=100*Math.cos(Math.PI/2-l*i),r=100*Math.cos(l*i),i++,a.target.move(e.x-o,e.y+r)):"in"===a.type&&a.target===e&&(o=100*Math.cos(Math.PI/2-l*s),r=100*Math.cos(l*s),s++,a.source.move(e.x+o,e.y-r)))},limitspAoutreached:(e=$t.activeShape)=>{let t,a,n,s=0;for([t,a]of Et.shMap)n=t.substring(0,1),"t"===n&&"out"===a.type&&a.source===e&&s++;return s>=Ot},limitspAinreached:(e=$t.activeShape)=>{let t,a,n,s=0;for([t,a]of Et.shMap)n=t.substring(0,1),"t"===n&&"in"===a.type&&a.target===e&&s++;return s>=Ot},init:(e,t,a)=>{Et=e,$t=t,Ot=a}};var Kt=Pt;const Xt={};Xt.help=s,Xt.symbols=l,Xt.alphabet="L",Xt.callback=ve.update,Xt.activeShape=null,Xt.selectionTransitionTarget=!1,Xt.selectionTransitionSource=!1,Xt.selectionTransitionFactor=!1,Xt.state="i",Xt.nameOld="",Xt.initState=()=>{let e="n",t=new d(e,0,0,0);Q.addShape(e,t);let a=78;t.nameAddChr(a),e=Q.generateFreeID("s"),t=new d(e,2*c.stateRadius,2*c.stateRadius),Q.addShape(e,t),a=Xt.symbols.L.C.S,t.nameAddChr(a)},Xt.init=()=>{c.canvas=document.getElementById("canvasID"),c.context=c.canvas.getContext("2d"),Q.init(c.canvas,c.stateRadius,c.hitTargetPadding,c.instancesLimit),ue.init(Q,Xt,c.instancesLimit,Kt),Kt.init(Q,Xt,c.specialArrowLimit),ie.init(Q,Xt,ue,c.instancesLimit),Tt.init(Xt,ue,ie,Kt,o),Xt.helpBox=document.getElementById("helpID"),Xt.helpBox.innerHTML=Xt.help.i,F(c.canvas,Xt,ie,ue,c.stateKeys,c.transitionKeys),Xt.initState(),Q.draw(),Xt.callback(Q.shMap)},Xt.systemStateActivate=(e,t)=>{null!=t&&t.activate(),Xt.nameOld=null!=t?t.name:"",Xt.activeShape=t,Xt.state=e,Xt.selectionTransitionFactor=!1,Xt.selectionTransitionSource=!1,Xt.selectionTransitionTarget=!1,Xt.alphabet="tr"===e?"G":"L",Xt.helpBox.innerHTML=Xt.help[e],Tt.systemupdate(e)},Xt.systemStateMouseDown=(e,t)=>{const a=Q.findShape(e,t);let n="i";if(null!=a){n=a.id.substring(0,1)+"m",a.moveStart(e,t);let s=Kt.returnstates(a);if(0!==s.length)for(let a=0;a<s.length;a++)s[a].moveStart(e,t)}"i"!==Xt.state&&Xt.activeShape.deactivate(),Xt.systemStateActivate(n,a),Q.draw()},Xt.moveStop=()=>{if(Xt.state.length>1&&"m"===Xt.state.substring(1,2)){Xt.activeShape.moveStop();let e=Kt.returnstates(Xt.activeShape);if(0!==e.length)for(let t=0;t<e.length;t++)e[t].moveStop();Xt.systemStateActivate(Xt.state.substring(0,1),Xt.activeShape)}},Xt.moveObject=e=>{Xt.activeShape.move(e.offsetX,e.offsetY);let t=Kt.returnstates(Xt.activeShape);if(0!==t.length)for(let a=0;a<t.length;a++)t[a].move(e.offsetX,e.offsetY);for(let e=0;e<t.length;e++)if(t[e].y<2){Xt.moveStop(),Xt.activeShape.move(Xt.activeShape.x,102),t[e].move(t[e].x,2);for(let e=0;e<t.length;e++)t[e].moveStop();Kt.arrangementstate()}else if(t[e].x<Xt.activeShape.radius){Xt.moveStop(),Xt.activeShape.move(Xt.activeShape.radius+102,Xt.activeShape.y);for(let e=0;e<t.length;e++)t[e].moveStop();Kt.arrangementstate()}if(Q.stateconflict(Xt.activeShape)){if(Xt.moveStop(),0!==t.length)for(let e=0;e<t.length;e++)t[e].moveStop();let e=0,a=0,n=1;for(;Q.stateconflict(Xt.activeShape);){for(;e<=n&&Q.stateconflict(Xt.activeShape);e++)if(Xt.activeShape.move(Xt.activeShape.x+e,Xt.activeShape.y+a),0!==t.length)for(let n=0;n<t.length;n++)t[n].move(t[n].x+e,t[n].y+a);for(;a<=n&&Q.stateconflict(Xt.activeShape);a++)if(Xt.activeShape.move(Xt.activeShape.x+e,Xt.activeShape.y+a),0!==t.length)for(let n=0;n<t.length;n++)t[n].move(t[n].x+e,t[n].y+a);for(n++;e>=-n&&Q.stateconflict(Xt.activeShape);e--)if(Xt.activeShape.move(Xt.activeShape.x+e,Xt.activeShape.y+a),0!==t.length)for(let n=0;n<t.length;n++)t[n].move(t[n].x+e,t[n].y+a);for(;a>=-n&&Q.stateconflict(Xt.activeShape);a--)if(Xt.activeShape.move(Xt.activeShape.x+e,Xt.activeShape.y+a),0!==t.length)for(let n=0;n<t.length;n++)t[n].move(t[n].x+e,t[n].y+a);n++}}Q.draw()};var Bt=Xt;const Ht={};let Rt={},Lt={};function jt(e){const t=[],a=e.nameArr.length,n=e.source;let s,i,o,r=0;if(0===a)return t;for(t[0]=[],s=0;s<a;s+=1)[i,o]=e.nameArr[s],"o"===i?(t[r].push(["s",n]),r+=1,t[r]=[]):0!==o.radius?t[r].push([i,o]):t[r].push(["n",o]);return t[r].push(["s",n]),t}function Nt(e){const t=[],a=e.nameArr.length;let n,s,i,o=0;if(0===a)return t;for(t[0]=[],n=0;n<a;n+=1)[s,i]=e.nameArr[n],"o"===s?(o+=1,t[o]=[]):0!==i.radius?t[o].push([s,i]):t[o].push(["n",i]);return t}function Gt(e,t,a){let n;const s=t.length,i=Lt.get(e);for(n=0;n<s;n+=1)i.push({sign:a,prod:t[n]})}Ht.odeBuild=e=>{let t,a,n;for([t,a]of(function(e){let t,a;for([t,a]of(Lt=new Map,e))"s"===t.substring(0,1)&&Lt.set(a,[])}(e),e))"t"===t.substring(0,1)&&(void 0!==a.type?(n=Nt(a),"in"===a.type?Gt(a.target,n,1):Gt(a.source,n,-1)):(n=jt(a),Gt(a.source,n,-1),Gt(a.target,n,1)))},Ht.update=e=>{let t,a,n,s,i,o,r,l,c,d,h,u,p,b=0,v=0,m=[];const f=String.fromCodePoint(8339);for([s,i]of(Ht.odeBuild(e),t="<table>",Lt))if("N"!==s.name){for(m.push(s.name),a="<tr><td align='right'>",a=s.nameArr.length>1?a+"("+s.name+")"+f:a+s.name+f,a+="</td>",a+="<td align='center'>=</td>",a+="<td align='left'><div class='odeEquation'>",o=i.length,p=!1,r=0;r<o;r+=1){for(v=0,n=i[r].sign<0?"â€“":p?"+":"",l=i[r].prod,c=l.length,d=0;d<c;d+=1)[h,u]=l[d],"s"===h?(u=u.name,v++):u="n"===h?u.name:String.fromCodePoint(u),n+=u;if(v>1){switch(n+="N",n+=String.fromCodePoint(8315),v--,v){case 1:b=185;break;case 2:b=178;break;case 3:b=179;break;default:b=8304+v}n+=String.fromCodePoint(b)}a+=n,p=!0}p||(a+="0"),a+="</div></td></tr>",t+=a}a="<tr><td align='right'>N</td><td align='center'>=</td><td align='left'><div class='odeEquation'>";for(let e=0;e<m.length;e++)e>0&&(a+="+"),a+=m[e];a+="</div></td></tr>",t+=a,t+="</table>",Rt.innerHTML=t},Ht.init=e=>{Rt=e},Ht.getODEs=()=>Lt;var Ft=Ht;var Vt=function(){const e={},t=Ft.getODEs();return e.states=function(e){const t=new Map;return e.forEach((e,a)=>{t.set(a.id,a.name)}),t}(t),e.rates=function(e){const t=new Set;return e.forEach(e=>{e.forEach(e=>{e.prod.forEach(e=>{"r"===e[0]&&t.add(String.fromCodePoint(e[1]))})})}),t}(t),e.equations=function(e){const t=new Map;return e.forEach((e,a)=>{const n=[];e.forEach(e=>{const t={};t.sign=e.sign,t.prod=[],e.prod.forEach(e=>{const a="r"===e[0]?[e[0],String.fromCodePoint(e[1])]:[e[0],e[1].id];t.prod.push(a)}),n.push(t)}),t.set(a.id,n)}),t}(t),e};const Ut={init:()=>{Ft.init(document.getElementById("odeID")),ve.addListener(Ft.update),St.setAlphabetHandler(Tt.letterIn),St.setStateKeyHandler(ue.nameAppendState),St.setSpecialKeyHandler("plus",ue.nameAppendPlus),St.setSpecialKeyHandler("del",Tt.RemoveTolken),St.setSpecialKeyHandler("check",Tt.check),St.setSpecialKeyHandler("L",Tt.updateAlphabetL),St.setSpecialKeyHandler("G",Tt.updateAlphabetG),St.setSpecialKeyHandler("S",Tt.updateAlphabetS),St.setSpecialKeyHandler("up",Tt.updateAlphabetup),St.setSpecialKeyHandler("low",Tt.updateAlphabetlow),St.setSpecialKeyHandler("Del",Tt.delete),St.setSpecialKeyHandler("R",Tt.rename),St.setSpecialKeyHandler("T",Tt.newTransition),St.setSpecialKeyHandler("X",Tt.leaveX),St.setSpecialKeyHandler("target",Tt.transitiontarget),St.setSpecialKeyHandler("source",Tt.transitionsource),St.setSpecialKeyHandler("in",Tt.arrowIn),St.setSpecialKeyHandler("out",Tt.arrowOut),St.setSpecialKeyHandler("checkenter",Tt.checkenter),St.setSpecialKeyHandler("Deleteenter",Tt.Deleteenter),St.setSpecialKeyHandler("Renter",Tt.Renter),St.setSpecialKeyHandler("inenter",Tt.inenter),St.setSpecialKeyHandler("outenter",Tt.outenter),St.setSpecialKeyHandler("Genter",Tt.Genter),St.setSpecialKeyHandler("Lenter",Tt.Lenter),St.setSpecialKeyHandler("Senter",Tt.Senter),St.setSpecialKeyHandler("upenter",Tt.upenter),St.setSpecialKeyHandler("lowenter",Tt.lowenter),St.setSpecialKeyHandler("Tenter",Tt.Tenter),St.setSpecialKeyHandler("Xenter",Tt.Xenter),St.setSpecialKeyHandler("targetenter",Tt.tagetenter),St.setSpecialKeyHandler("sourceenter",Tt.sourceenter),St.init(document.getElementById("inID"),ve),Bt.init()}};Ut.getODEs=Vt;var zt=Ut;const Yt={};function Jt(){const e=Yt.board.create("point",[0,0],{needsRegularUpdate:!1,visible:!1}),t=Yt.board.create("point",[1,0],{needsRegularUpdate:!1,visible:!1}),a=Yt.board.create("axis",[e,t],{needsRegularUpdate:!1,name:"$t$",withLabel:!0,label:{position:"rt",offset:[-5,8]}});a.removeAllTicks();const n=Yt.board.create("ticks",[a,1],{offset:[-10,-10],precision:5,minorTicks:0,drawLabels:!0,grid:!0,majorHeight:-1,strokeColor:"#ccc"});let s,i,o;n.ticksFunction=()=>s,Yt.board.fullUpdate();let r=[];const l=Yt.board.create("point",[0,0],{needsRegularUpdate:!1,visible:!1}),c=Yt.board.create("point",[0,1],{needsRegularUpdate:!1,visible:!1}),d=Yt.board.create("axis",[l,c],{needsRegularUpdate:!1,withLabel:!0,label:{position:"rt",offset:[-5,8]}});d.removeAllTicks();const h=Yt.board.create("ticks",[d,1],{strokeColor:"#ccc",label:{offset:[10,0]},precision:8,minorTicks:0,drawLabels:!0,drawZero:!1,majorHeight:-1});h.ticksFunction=()=>i,Yt.board.fullUpdate();const u=function(){o=Yt.board.getBoundingBox();const e=10**Math.floor(Math.log10(.6*(o[2]-o[0])));s=(o[2]-o[0])/e>5?e:.5*e;const t=10**Math.floor(Math.log10(.6*(o[1]-o[3])));i=(o[1]-o[3])/t>5?t:.5*t,Yt.board.fullUpdate()};u();const p=Yt.board.create("point",[0,0],{visible:!1});Yt.upperAxis=30,Yt.lowerAxis=Yt.board.canvasHeight-30,Yt.board.on("boundingbox",()=>{console.time("Axis"),o=Yt.board.getBoundingBox();const s=new JXG.Coords(JXG.COORDS_BY_USER,[0,p.Y()],Yt.board).scrCoords[2],i=new JXG.Coords(JXG.COORDS_BY_USER,[0,p.X()],Yt.board).scrCoords[1];var b;s<=10?(a.point1.setAttribute({frozen:!0}),a.point2.setAttribute({frozen:!0}),n.visProp.label.offset=[-10,-10]):s>Yt.board.canvasHeight-10?(e.moveTo((b=Yt.board.canvasHeight-10,r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,b],Yt.board),r.usrCoords),0),t.moveTo((e=>(r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[Yt.board.canvasWidth,e],Yt.board),r.usrCoords))(Yt.board.canvasHeight-10),0),a.point1.setAttribute({frozen:!0}),a.point2.setAttribute({frozen:!0}),n.visProp.label.offset=[-10,9]):(a.point1.setAttribute({frozen:!1}),a.point2.setAttribute({frozen:!1}),e.moveTo([0,Yt.yPost(0)],0),t.moveTo([1,Yt.yPost(0)],0),e.moveTo([0,0],0),t.moveTo([1,0],0),n.visProp.label.offset=[-10,-10]),i<10?(l.moveTo((e=>(r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,Yt.board.canvasHeight],Yt.board),r.usrCoords))(10),0),c.moveTo((e=>(r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,0],Yt.board),r.usrCoords))(10),0),d.point1.setAttribute({frozen:!0}),d.point2.setAttribute({frozen:!0}),h.visProp.label.offset=[7,0]):i>Yt.board.canvasWidth-10?(d.point1.setAttribute({frozen:!0}),d.point2.setAttribute({frozen:!0}),h.visProp.label.offset=[-28,0],h.visProp.label.align="right"):(d.point1.setAttribute({frozen:!1}),d.point2.setAttribute({frozen:!1}),l.moveTo([0,0],0),c.moveTo([0,1],0)),u(),console.timeEnd("Axis")}),Yt.boardRestriction=!0,Yt.yLogFunc=function(){console.time("yLog"),this.checked?(Yt.board.setBoundingBox([-Yt.tEnd.X()/10,.3,1.1*Yt.tEnd.X(),-Math.log10(1/Yt.eps)-1],!1),h.generateLabelText=(e,t)=>e.usrCoords[2]-t.usrCoords[2]<-Math.log10(1/Yt.eps)?"":e.usrCoords[2]-t.usrCoords[2]<1-Math.log10(1/Yt.eps)?"0":"$10^{"+Math.floor(e.usrCoords[2]-t.usrCoords[2])+"}$",Yt.yPre=e=>e>Math.log10(Yt.eps)?10**e:0,Yt.yPost=e=>Math.abs(e)>Yt.eps?Math.log10(Math.abs(e)):Math.log10(Yt.eps),Yt.move=e=>e>Yt.eps?Math.log10(e):Math.log10(Yt.eps),Yt.boardRestriction=!1,Yt.board.highlightInfobox=function(e,t,a){t<=-Math.log10(1/Yt.eps)?Yt.board.infobox.setText(" ("+e+",0)"):Yt.board.infobox.setText(" ("+e+" , $"+(10**t*10**Math.ceil(-t-1)%1*10).toFixed(2)+"\\cdot 10^{"+Math.ceil(-t)+"}$)")}):(Yt.board.setBoundingBox([-Yt.tEnd.X()/10,1.2,1.1*Yt.tEnd.X(),-.1],!1),h.generateLabelText=function(e,t){return e.usrCoords[2]-t.usrCoords[2]},Yt.yPost=e=>e,Yt.yPre=e=>e,Yt.move=e=>e>Math.log10(Yt.eps)?10**e:0,Yt.boardRestriction=!0,Yt.board.highlightInfobox=function(e,t,a){Yt.board.infobox.setText("("+e+", "+t+")")}),Yt.board.fullUpdate(),u(),console.timeEnd("yLog")},window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},jax:["input/TeX","output/HTML-CSS"],svg:{fontCache:"global"},startup:{promise:new Promise((function(e,t){setTimeout(()=>e(1),100)}))}},(()=>{const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js",e.async=!0,document.head.appendChild(e)})(),Yt.promise=new Promise((e,t)=>{setTimeout(()=>e(1),100)}),Yt.typeset=function(e){return window.MathJax.startup.promise=window.MathJax.startup.promise.then(()=>(e(),window.MathJax.typesetPromise())).catch(e=>console.log("Typeset failed: "+e.message)),window.MathJax.startup.promise},Yt.eps=1e-12,Yt.yPre=e=>e,Yt.yPost=e=>e,Yt.move=e=>e>Math.log10(Yt.eps)?10**e:0,$("#plotID").mouseenter(()=>{Yt.helpID=$("#helpID").html(),$("#helpID").html("Scroll to zoom in and out. Hold <b>SHIFT</b> to pan.<br>To change interventions either drag them or hold <b>SHIFT</b> and click to enter coordinates directly. <br>Press <b>+</b> button to add an intervention and press <b>&#8211</b> button to remove last intervention.Switch <b>Log</b> checkbox to switch y-axis to logarithmic scale.<br>Press any checkbox in the <b>legend</b> to hide corresponding function graph.<br>")}),$("#plotID").mouseleave(()=>{$("#helpID").html(Yt.helpID)}),$("#ratesID").mouseenter(()=>{Yt.helpID=$("#helpID").html(),$("#helpID").html("Values can be adjusted by either directly changing the numerical value or by scrolling/ dragging the graph .<br>Click on intervention tab to view corresponding rates .<br>")}),$("#ratesID").mouseleave(()=>{$("#helpID").html(Yt.helpID)}),$("#statesID").mouseenter(()=>{Yt.helpID=$("#helpID").html(),$("#helpID").html("Values can be adjusted by either directly changing the numerical value or by scrolling/ dragging the graph .<br>")}),$("#statesID").mouseleave(()=>{$("#helpID").html(Yt.helpID)}),$("#GraphButtons").html('<span float="right" class="slider-checkbox"><input type="checkbox" id="logY" /><label class="label" for="logY"></label><button class="button" id="button">+</button>&nbsp<button class="button" id="button2">&#8211</button>')}function _t(){!function(){const e=Yt.board.create("line",[[0,0],[1,0]],{visible:!1});Yt.tEnd=Yt.board.create("glider",[200,0,e],{name:"$t_{\\infty}$",color:"black"}),Yt.board.setBoundingBox([-Yt.tEnd.X()/10,1.2,1.1*Yt.tEnd.X(),-.1],!1),Yt.tEnd.on("up",(function(e){const t=this;Yt.promise=Yt.promise.then(()=>{if(e.shiftKey&&null==Yt.input){const e=Yt.board.getBoundingBox();Yt.typeset(()=>{Yt.input=Yt.board.create("text",[(e[2]+e[0])/2.5,(e[1]+e[3])/2,'<div id="inputID"><p>Enter Value of $t_\\\\infty$</p><br><input type="float" id="xValue" required value='+t.X()+'><br><br><button class="button" id="Accept">Accept</button></div>'],{fixed:!0,highlight:!1})}).then(()=>{$("#Accept").click(()=>{t.moveTo([$("#xValue").val(),0]),Yt.board.removeObject(Yt.input),Yt.input=null,Yt.plotCurves(),Yt.board.setBoundingBox([-Yt.tEnd.X()/10,e[1],1.1*Yt.tEnd.X(),e[3]],!1)})})}Yt.plotCurves();const a=Yt.board.getBoundingBox();return Yt.board.setBoundingBox([-Yt.tEnd.X()/10,a[1],1.1*Yt.tEnd.X(),a[3]],!1),new Promise((function(e,t){setTimeout(()=>e(1),100)}))})}))}(),function(){function e(e){return e<=Yt.eps?Math.log10(Yt.eps):1===e?Math.log10(1+Yt.eps):Math.log10(e)}function t(e){return e<=Math.log10(Yt.eps)?0:10**e}function a(){let e=0;return Object.keys(Yt.states).forEach(a=>{e+=t(Yt.states[a].point.X())}),0===e&&(e=1),e}function n(){let e=0;for(var t in Yt.data.states)e+=Yt.data.states[t].value;return 0===e&&(e=1),e}Yt.saveStates=()=>{Yt.data.states={},Object.keys(Yt.states).forEach(e=>{Yt.data.states[e]={},Yt.data.states[e].value=Yt.states[e].getValue(),Yt.data.states[e].name=Yt.states[e].name})},Yt.saveInterventions=()=>{Yt.data.interventions={},Object.keys(Yt.interventions).forEach(e=>{Yt.data.interventions[e]=Yt.interventions[e].getValue()})},Yt.saveRates=()=>{Yt.data.rates={},Object.keys(Yt.rates).forEach(e=>{Yt.data.rates[e]={},Object.keys(Yt.interventions).forEach(t=>{Yt.data.rates[e][t]=Yt.rates[e][t].getValue()})})},Yt.save=()=>{Yt.saveStates(),Yt.saveRates(),Yt.saveInterventions()},Yt.loadStates=()=>{Yt.statesMap={},Yt.board.suspendUpdate(),Object.values(Yt.states).forEach(e=>{Yt.board.removeObject(e.plotPoint),JXG.JSXGraph.freeBoard(e.board)}),Object.values(Yt.curves).forEach(e=>{Yt.board.removeObject(e)}),Yt.board.removeObject(Yt.labels),Yt.board.unsuspendUpdate(),Yt.states={};for(let e=0;e<Object.keys(Yt.data.states).length;e++)Yt.statesMap[Object.keys(Yt.data.states)[e]]=e;const s=Yt.board.create("line",[()=>-1*Yt.interventions.t0.getValue(),()=>1,()=>0],{visible:!1});$("#statesID").empty(),$("#statesID").append("<table>"),document.getElementById("statesID").style.display="block",Object.keys(Yt.data.states).forEach(i=>{Yt.states[i]={},Yt.states[i].name=Yt.data.states[i].name,$("#statesID").append('<tr><td><div class="stateName" >'+Yt.states[i].name+'(0) = </div></td><td><div contenteditable="true" class="stateText"  id= "text'+i+'">'+(Yt.data.states[i].value<Yt.eps?(0).toExponential(3):Yt.data.states[i].value.toExponential(3))+'</div></td><td><div class="stateBoard" tabindex="1" id= "board'+i+'"></div></td></tr>'),Yt.states[i].board=JXG.JSXGraph.initBoard("board"+i,{axis:!1,maxboundingbox:[-1/0,1/0,1/0,-1/0],showCopyright:!1,showNavigation:!1,showInfobox:!1,highlight:!1,highlightInfobox:!1,pan:{enabled:!0,needshift:!1},zoom:{factorX:1.05,factorY:1,wheel:!0,needshift:!1,eps:.01}}),Yt.states[i].point=Yt.states[i].board.create("point",[e(Yt.data.states[i].value),0],{name:Yt.data.states[i].name,visible:!0,highlight:!1,highlightInfobox:!1,label:{offset:[0,-25]},color:Yt.colors[Yt.statesMap[i]],fixed:!0,showInfobox:!1}),Yt.states[i].board.setBoundingBox([e(Yt.data.states[i].value)-2,.1,e(Yt.data.states[i].value)+2,-.1]),Yt.states[i].point.setAttribute({frozen:!0}),Yt.states[i].getValue=function(){return t(this.point.X())};const o=Yt.states[i].board.create("axis",[[0,0],[1,0]]);o.removeAllTicks(),Yt.states[i].board.create("ticks",[o,1],{drawLabels:!0,minorTicks:0,drawZero:!0,generateLabelText:(e,t)=>e.usrCoords[1]-t.usrCoords[1]<=-12?0:"$10^{"+1*Math.floor(e.usrCoords[1]-t.usrCoords[1])+"}$"}),Yt.states[i].plotPoint=Yt.board.create("glider",[0,t(Yt.states[i].point.X())/n(),s],{color:Yt.colors[Yt.statesMap[i]],name:Yt.data.states[i].name+"(0)",label:{autoPosition:!0,visible:!1},showInfobox:!1,highlight:!1,fixed:!0}),Yt.states[i].board.on("boundingbox",()=>{const e=Yt.states[i].board.getBoundingBox();Yt.states[i].board.setBoundingBox([e[2]-4,.1,e[2],-.1]);Yt.states[i].getValue()<=Yt.eps?document.getElementById("text"+i).innerHTML=(0).toExponential(3):document.getElementById("text"+i).innerHTML=Yt.states[i].getValue().toExponential(3),Object.keys(Yt.states).forEach(e=>{Yt.states[e].plotPoint.setPositionDirectly(JXG.COORDS_BY_USER,[0,Yt.yPost(t(Yt.states[e].point.X())/a())])}),Yt.plotCurves()}),$(document).focusout("#text"+i,()=>{"block"===$("#statesID").css("display")&&(Object.keys(Yt.states).forEach(e=>{Yt.states[e].plotPoint.setPositionDirectly(JXG.COORDS_BY_USER,[0,Yt.yPost(parseFloat($("#text"+e).text())/a())])}),Yt.states[i].board.setBoundingBox([e(parseFloat($("#text"+i).text()))-2,.1,e(parseFloat($("#text"+i).text()))+2,-.1]))})}),$("#statesID").append("</table>"),document.getElementById("statesID").style.display="none",Yt.curves={},Object.keys(Yt.data.states).forEach(e=>{Yt.curves[e]=Yt.board.create("curve",[0,0],{strokeColor:Yt.colors[Yt.statesMap[e]],name:Yt.data.states[e].name+"(t)",highlight:!1}),Yt.curves.n=Yt.board.create("curve",[0,0],{strokeColor:"black",name:"N(t)",highlight:!1})}),Yt.setLegend(),Yt.setLegendFunction()},Yt.loadInterventions=()=>{Yt.board.suspendUpdate(),Object.values(Yt.interventions).forEach(e=>{Yt.board.removeObject(e.line.point1),Yt.board.removeObject(e.line.point2),Yt.board.removeObject(e.line),Yt.board.removeObject(e.point)}),Yt.board.unsuspendUpdate(),Yt.board.update(),Yt.interventions={};const t=Yt.board.create("line",[[0,0],[1,0]],{visible:!1});$("#tabtab3ID").empty(),Object.keys(Yt.data.interventions).forEach(a=>{Yt.interventions[a]={},Yt.interventions[a].point=Yt.board.create("glider",[Yt.data.interventions[a],0,t],{color:"black",visible:!0,name:"$t_{"+a.substring(1)+"}$"}),Yt.interventions[a].line=Yt.board.create("line",[[()=>Yt.interventions[a].point.X(),0],[()=>Yt.interventions[a].point.X(),1]],{color:"lightGrey",visible:!0}),Yt.interventions[a].point.on("up",(function(e){const t=this;Yt.promise=Yt.promise.then(()=>{if(e.shiftKey&&null==Yt.input){const e=Yt.board.getBoundingBox();Yt.typeset(()=>{Yt.input=Yt.board.create("text",[(e[2]+e[0])/2.5,(e[1]+e[3])/2,'<div id="inputID"><p>Enter Value of $t$<sub>'+a.substring(1,2)+'</sub></p><br><input type="float" id="xValue" required value='+t.X()+'><br><br><button class="button" id="Accept">Accept</button></div>'],{fixed:!0,highlight:!1})}).then(()=>{$("#Accept").click(()=>{t.moveTo([$("#xValue").val(),0]),Yt.board.removeObject(Yt.input),Yt.input=null,Yt.plotCurves()})})}return Yt.plotCurves(),new Promise((function(e,t){setTimeout(()=>e(1),100)}))})})),Yt.interventions[a].getValue=function(){return this.point.X()},$("#tabtab3ID").append('<button id = "button'+a+'">t<sub>'+a.substring(1)+"</sub></button>"),$("#button"+a).click(()=>{Yt.activeIntervention=a,$("#tabtab3ID").children().removeClass("active"),$("#button"+a).addClass("active"),Object.keys(Yt.rates).forEach(t=>{Object.keys(Yt.interventions).forEach(e=>{Yt.rates[t][e].point.setAttribute({visible:!1,frozen:!1})}),Yt.rates[t].board.setBoundingBox([e(Yt.rates[t][a].getValue())-2,.1,e(Yt.rates[t][a].getValue())+2,-.1]),Yt.rates[t][a].point.setAttribute({visible:!0,frozen:!0})})})}),Yt.interventions.t0.line.setAttribute({visible:!1}),$("#buttont0").addClass("active"),Yt.activeIntervention="t0"},Yt.loadRates=()=>{Yt.rates={},$("#ratesID").empty(),$("#ratesID").append("<table>"),document.getElementById("ratesID").style.display="block",Object.keys(Yt.data.rates).forEach(a=>{Yt.rates[a]={},$("#ratesID").append('<tr><td><div class="rateName" >'+a+'= </div></td><td><div contenteditable="true" class="rateText"  id= "text'+a+'">'+Yt.data.rates[a].t0+'</div></td><td><div class="rateBoard"  id= "board'+a+'"></div></td></tr>'),Yt.rates[a].board=JXG.JSXGraph.initBoard("board"+a,{axis:!1,maxboundingbox:[-1/0,1/0,1/0,-1/0],boundingbox:[-.6,.1,1,-.1],showCopyright:!1,showNavigation:!1,showInfobox:!1,highlight:!1,pan:{enabled:!0,needshift:!1},zoom:{factorX:1.05,factorY:1,wheel:!0,needshift:!1,eps:.01}});const n=Yt.rates[a].board.create("axis",[[0,0],[1,0]]);n.removeAllTicks(),Yt.rates[a].board.create("ticks",[n,1],{drawLabels:!0,minorTicks:0,drawZero:!0,generateLabelText:(e,t)=>e.usrCoords[1]-t.usrCoords[1]<=-12?0:"$10^{"+1*Math.floor(e.usrCoords[1]-t.usrCoords[1])+"}$"}),Object.keys(Yt.data.rates[a]).forEach(n=>{Yt.rates[a][n]={},Yt.rates[a][n].point=Yt.rates[a].board.create("point",[e(Yt.data.rates[a][n]),0],{name:a,visible:!1,label:{offset:[0,-25]},color:"black",fixed:!0,showInfobox:!1,highlight:!1}),Yt.rates[a][n].getValue=function(){return t(this.point.X())},Yt.rates[a].board.on("boundingbox",()=>{const e=Yt.rates[a].board.getBoundingBox();Yt.rates[a].board.setBoundingBox([e[2]-4,.1,e[2],-.1]);Yt.rates[a][Yt.activeIntervention].getValue()<=Yt.eps?document.getElementById("text"+a).innerHTML=(0).toExponential(3):document.getElementById("text"+a).innerHTML=Yt.rates[a][Yt.activeIntervention].getValue().toExponential(3),Yt.plotCurves()}),$(document).focusout("#text"+a,()=>{"block"===$("#ratesID").css("display")&&Yt.rates[a].board.setBoundingBox([e(parseFloat($("#text"+a).text()))-2,.1,e(parseFloat($("#text"+a).text()))+2,-.1])})})}),$("#ratesID").append("</table>"),Object.keys(Yt.data.rates).forEach(t=>{Yt.rates[t].board.setBoundingBox([e(Yt.data.rates[t].t0)-2,.1,e(Yt.data.rates[t].t0)+2,-.1]),Yt.rates[t].t0.point.setAttribute({visible:!0,frozen:!0})})}}(),Yt.data.states={},Yt.data.states.s0={},Yt.data.states.s0.name="S",Yt.data.states.s0.value=1e3,Yt.data.interventions={},Yt.data.interventions.t0=0,Yt.data.rates={},Yt.load()}function Wt(){$("#button").click(()=>{console.time("addIntervention"),Yt.save(),Yt.data.interventions["t"+Object.keys(Yt.data.interventions).length]=Yt.data.interventions["t"+(Object.keys(Yt.data.interventions).length-1)]+10,Object.keys(Yt.data.rates).forEach(e=>{Yt.data.rates[e]["t"+Object.keys(Yt.data.rates[e]).length]=Yt.data.rates[e]["t"+(Object.keys(Yt.data.rates[e]).length-1)]}),Yt.load(),console.timeEnd("addIntervention"),Yt.plotCurves()}),$("#button2").click(()=>{console.time("removeIntervention"),Yt.save(),Object.keys(Yt.data.interventions).length>=2&&(delete Yt.data.interventions["t"+(Object.keys(Yt.data.interventions).length-1)],Object.keys(Yt.data.rates).forEach(e=>{delete Yt.data.rates[e]["t"+Object.keys(Yt.data.interventions).length]})),Yt.load(),console.timeEnd("removeIntervention"),Yt.plotCurves()}),$("#logY").change((function(){Yt.yLogFunc.call(this),Object.keys(Yt.states).forEach(e=>{Yt.states[e].plotPoint.moveTo([Yt.states[e].plotPoint.X(),Yt.move(Yt.states[e].plotPoint.Y())])}),Yt.plotCurves()}))}Yt.curves={},Yt.data={},Yt.states={},Yt.rates={},Yt.statesMap={},Yt.interventions={},Yt.load=()=>{$("#ratesID").show(),$("#tab3ID").show(),$("#statesID").hide(),Yt.loadInterventions(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#statesID").show(),Yt.loadStates(),$("#ratesID").show(),$("#tab3ID").show(),$("#statesID").hide(),Yt.loadRates(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#statesID").show(),$("#Values").addClass("active"),$("#Rates").removeClass("active")},Yt.update=()=>{Yt.save();const e=zt.getODEs();e.states.forEach((e,t)=>{Object.keys(Yt.data.states).includes(t)?Yt.data.states[t].name!==e&&(Yt.data.states[t].name=e):(Yt.data.states[t]={},Yt.data.states[t].name=e,Yt.data.states[t].value=0)}),Object.keys(Yt.data.states).forEach(t=>{e.states.has(t)||delete Yt.data.states[t]}),e.rates.forEach(e=>{Object.keys(Yt.data.rates).includes(e)||(Yt.data.rates[e]={},Object.keys(Yt.data.interventions).forEach(t=>{Yt.data.rates[e][t]=.1}))}),Object.keys(Yt.data.rates).forEach(t=>{e.rates.has(t)||delete Yt.data.rates[t]}),Yt.load(),Yt.plotCurves()},Yt.pointArray=[],Yt.interventionArray=[],Yt.colors=["red","blue","green","purple","orange","gray","pink","yellow","teal","Brown","BlueViolet","CadetBlue","Chartreuse","Chocolate","CornflowerBlue","Coral","Crimson","Cyan","DarkMagenta","DarkGreen","Fuchsia","Indigo","Khaki","Lime","Magenta","Maroon","Navy","Olive"],Yt.setLegend=()=>{let e="",t="<br>";e+=" .switch { position: relative; display: inline-block; width: 30px; height: 18px;}",e+=".switch input {opacity: 0;width: 0;height: 0;}",e+=".slidern {position: absolute; cursor: pointer;top: 0;left: 0;right: 0;bottom: 0;background-color: #ccc;-webkit-transition: 0.4s;transition: 0.4s;}",e+='.slidern:before {position: absolute;content: ""; height: 13px; width: 13px; left: 2px;bottom: 2px; background-color: white;-webkit-transition: 0.4s;transition: 0.4s;}',e+="input:checked + .slidern {background-color:",e+="black",e+=";}",e+="input:focus + .slidern {box-shadow: 0 0 1px grey;}",e+="input:checked + .slidern:before {-webkit-transform: translateX(13px); -ms-transform: translateX(13px); transform: translateX(13px);}",e+=".slidern.round {border-radius: 17px;}",e+=".slidern.round:before {border-radius: 50%;}",t+='<label class="switch">',t+='<input type="checkbox" id="checkn" name="checkn" checked> n',t+='<span class="slidern round"></span></label><span> ',t+="N",t+="(t)  &nbsp&nbsp</span><br>",Object.keys(Yt.curves).forEach(a=>{"n"!==a&&(e+=".slider"+a+" {position: absolute; cursor: pointer;top: 0;left: 0;right: 0;bottom: 0;background-color: #ccc;-webkit-transition: 0.4s;transition: 0.4s;}",e+=".slider"+a+':before {position: absolute;content: ""; height: 13px; width: 13px; left: 2px;bottom: 2px; background-color: white;-webkit-transition: 0.4s;transition: 0.4s;}',e+="input:checked + .slider"+a+" {background-color:",e+="n"===a?"black":Yt.colors[Yt.statesMap[a]],e+=";}",e+="input:focus + .slider"+a+" {box-shadow: 0 0 1px "+Yt.colors[Yt.statesMap[a]]+";}",e+="input:checked + .slider"+a+":before {-webkit-transform: translateX(13px); -ms-transform: translateX(13px); transform: translateX(13px);}",e+=".slider"+a+".round {border-radius: 17px;}",e+=".slider"+a+".round:before {border-radius: 50%;}",t+='<label class="switch">',t+='<input type="checkbox" id="check'+a+'" name="check'+a+'" checked> '+a,t+='<span class="slider'+a+' round"></span></label><span> ',t+="n"===a?"N":Yt.states[a].name,t+="(t)  &nbsp&nbsp</span><br>")});const a=document.createElement("style");a.type="text/css",a.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(a);const n=Yt.board.getBoundingBox();Yt.labels=Yt.board.create("text",[n[2],(n[1]+n[3])*(.55+.03*Object.keys(Yt.curves).length),t],{frozen:!0,fontSize:18,fixed:!0,visible:!0,anchorX:"right",anchorY:"top",highlight:!1})},Yt.setLegendFunction=()=>{Object.keys(Yt.curves).forEach(e=>{$("#check"+e).on("click",(function(){this.checked?Yt.curves[e].setAttribute({visible:!0}):Yt.curves[e].setAttribute({visible:!1})}))})};var qt=function(){Wt()};var Zt=function(){console.time("Ode");const e=zt.getODEs(),t={};function a(e){return Object.keys(Yt.interventions).includes("t"+(1+parseInt(e.substring(1),10)))?Yt.interventions["t"+(1+parseInt(e.substring(1),10))].getValue():Yt.tEnd.X()}Yt.delta=20,Object.keys(Yt.interventions).forEach(a=>{t[a]=function(t){return function(a,n){const s=n.map(()=>0);let i,o=0;return e.equations.forEach((e,t)=>{o+=n[Yt.statesMap[t]]}),e.equations.forEach((e,a)=>{e.forEach(e=>{i=!1;let r=e.sign>0?1:-1;e.prod.forEach(e=>{"r"===e[0]?r*=Yt.rates[e[1]][t].getValue():"n"===e[0]?r*=o:(i?(r*=n[Yt.statesMap[e[1]]],r/=o):r*=n[Yt.statesMap[e[1]]],i=!0)}),s[Yt.statesMap[a]]+=r})}),s}}(a)});let n=[[]];e.states.forEach((e,t)=>{n[0][Yt.statesMap[t]]=Yt.states[t].getValue()}),Object.keys(Yt.interventions).sort((e,t)=>e.substring(1)<t.substring(1)?-1:1).forEach(e=>{n=n.concat(JXG.Math.Numerics.rungeKutta("rk4",n[n.length-1],[Yt.interventions[e].getValue(),a(e)],(a(e)-Yt.interventions[e].getValue())*Yt.delta+1,t[e]).slice(1))});let s=0;for(let e=0;e<n[0].length;e++)s+=n[0][e];if(0!==s)for(let e=0;e<n.length;e++)for(let t=0;t<n[e].length;t++)n[e][t]=n[e][t]/s;for(let e=0;e<n.length;e++){let t=0;n[e][n[n.length-1].length]=Yt.interventions.t0.getValue()+e/Yt.delta;for(let a=0;a<n[e].length-1;a++)t+=n[e][a];n[e].unshift(t)}return console.timeEnd("Ode"),n};var Qt=function(){Yt.plotCurves=function(e,t){let a=-1;return function(){clearTimeout(a);const n=arguments,s=this;a=setTimeout((function(){e.apply(s,n)}),t)}}(()=>{const e=Zt();console.time("Plot"),Object.keys(Yt.curves).forEach(t=>{Yt.curves[t].dataX=[],Yt.curves[t].dataY=[];for(let a=0;a<1e3;a++)Yt.curves[t].dataX[a]=e[Math.floor(a*e.length/1e3)][e[0].length-1],Yt.curves[t].dataY[a]="n"===t?Yt.yPost(e[Math.floor(a*e.length/1e3)][0]):Yt.yPost(e[Math.floor(a*e.length/1e3)][Yt.statesMap[t]+1])}),Yt.board.update(),console.timeEnd("Plot")},20)};function ea(){if("s1"!==Q.generateFreeID("s"))return alert("There is an acitve model running! \nPlease refresh the website before the upload."),void(document.getElementById("uploadmodel").style.backgroundColor="red");const e=document.getElementById("uploadmodel").files[0];if(e.type.match(/text.*/)){const t=new FileReader;t.onload=function(e){!function(e){var t,a,n,s,i=0,o=100,r="s1",l=!0;if("Epidemic-Model-Data"===e.slice(0,19)){for(i=20;":"!==e[i];){for(t=[],a="",n="",s="";","!==e[i];)n+=e[i],i++;for(i++;","!==e[i];)s+=e[i],i++;for(s=parseFloat(s),i++;";"!==e[i]&&":"!==e[i];)a+=e[i],i++,","===e[i]&&(t.push(parseInt(a)),a="",i++);if(t.push(parseInt(a)),l){var c=0;l=!1;const e=Q.getShape("s0");for(Bt.systemStateActivate("sr",e),Bt.activeShape.move(100,150),ie.nameRemoveToken();c<t.length;)ie.stateName(t[c]),c++;Bt.activeShape.deactivate(),Bt.systemStateActivate("i"),Q.draw(),Bt.callback(Q.shMap),Yt.data.states={},Yt.data.states.s0={},Yt.data.states.s0.name="S",Yt.data.states.s0.value=s,Yt.data.interventions={},Yt.data.interventions.t0=0,Yt.data.rates={}}else{for(;n!==r;)r=Q.generateFreeID("s");const e=new d(n,o,150);Q.addShape(n,e);for(c=0;c<t.length;)e.nameAddChr(t[c]),c++;Q.draw(),Bt.callback(Q.shMap),Yt.data.states[n]={},Yt.data.states[n].name=e.name,Yt.data.states[n].value=s}o+=150,":"!==e[i]&&i++}i+=2;var h="",u="";for(t=[],a="";";"!==e[i]&&":"!==e[i];){for(h="",u="",t=[],a="";","!==e[i];){for(a="";"-"!==e[i]&&","!==e[i];)a+=e[i],i++;switch(a[0]){case"(":a=a.substring(1,a.length-1),t.push("("),t.push(a),t.push(")");break;case"+":t.push("+");break;default:t.push(a)}","!==e[i]&&i++}for(t.push(","),a="",i++;","!==e[i];)a+=e[i],i++;for(h+=a,h=Q.getShape(h),i++,a="";";"!==e[i]&&":"!==e[i];)a+=e[i],i++;u+=a,u=Q.getShape(u);var p=ue.transitionCreate(h,u);Bt.systemStateActivate("tr",p);for(c=0;","!==t[c];){var b="";switch(t[c]){case"+":Bt.activeShape.nameAddToken("o",65291),c++;break;case"(":for(c++;")"!==t[c];)b+=t[c],c++;b=Q.getShape(b),Bt.activeShape.nameAddToken("s",b),c++;break;default:Bt.activeShape.nameAddToken("r",parseInt(t[c])),c++}}Bt.activeShape.deactivate(),Bt.systemStateActivate("i"),Q.draw(),Bt.callback(Q.shMap),":"!==e[i]&&i++}i+=2;h="",u="";for(t=[],a="";";"!==e[i]&&":"!==e[i];){for(h="",u="",t=[],a="";","!==e[i];){for(a="";"-"!==e[i]&&","!==e[i];)a+=e[i],i++;switch(a[0]){case"(":a=a.substring(1,a.length-1),t.push("("),t.push(a),t.push(")");break;case"+":t.push("+");break;default:t.push(a)}","!==e[i]&&i++}for(t.push(","),i++,a="";";"!==e[i]&&":"!==e[i];)a+=e[i],i++;u+=a,u=Q.getShape(u),Bt.systemStateActivate("t",u),Kt.specialArrowCreate("in");for(c=0;","!==t[c];){b="";switch(t[c]){case"+":Bt.activeShape.nameAddToken("o",65291),c++;break;case"(":for(c++;")"!==t[c];)b+=t[c],c++;b=Q.getShape(b),Bt.activeShape.nameAddToken("s",b),c++;break;default:Bt.activeShape.nameAddToken("r",parseInt(t[c])),c++}}Bt.activeShape.deactivate(),Bt.systemStateActivate("i"),Q.draw(),Bt.callback(Q.shMap),":"!==e[i]&&i++}i+=2;var v,m,f,g;h="",u="";for(t=[],a="";";"!==e[i]&&":"!==e[i];){for(h="",u="",t=[],a="";","!==e[i];){for(a="";"-"!==e[i]&&","!==e[i];)a+=e[i],i++;switch(a[0]){case"(":a=a.substring(1,a.length-1),t.push("("),t.push(a),t.push(")");break;case"+":t.push("+");break;default:t.push(a)}","!==e[i]&&i++}for(t.push(","),i++,a="";";"!==e[i]&&":"!==e[i];)a+=e[i],i++;h+=a,h=Q.getShape(h),Bt.systemStateActivate("t",h),Kt.specialArrowCreate("out");for(c=0;","!==t[c];){b="";switch(t[c]){case"+":Bt.activeShape.nameAddToken("o",65291),c++;break;case"(":for(c++;")"!==t[c];)b+=t[c],c++;b=Q.getShape(b),Bt.activeShape.nameAddToken("s",b),c++;break;default:Bt.activeShape.nameAddToken("r",parseInt(t[c])),c++}}Bt.activeShape.deactivate(),Bt.systemStateActivate("i"),Q.draw(),Bt.callback(Q.shMap),":"!==e[i]&&i++}for(i+=2;":"!==e[i];){for(v="",m="";"-"!==e[i];)v+=e[i],i++;for(i++;","!==e[i]&&":"!==e[i];)m+=e[i],i++;m=parseFloat(m),":"!==e[i]&&i++,Yt.data.interventions[v]=m}for(i+=2;":"!==e[i];){for(f="",v="",g="";","!==e[i];)f+=e[i],i++;for(f=String.fromCodePoint(f),i++;","!==e[i];)v+=e[i],i++;for(i++;":"!==e[i]&&";"!==e[i];)g+=e[i],i++;g=parseFloat(g),":"!==e[i]&&i++,void 0===Yt.data.rates[f]&&(Yt.data.rates[f]={}),Yt.data.rates[f][v]=g}Yt.load(),document.getElementById("uploadmodel").style.backgroundColor="lightgreen",$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").show(),$("#helpID").hide(),$("#Simulator").removeClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").addClass("active")}else alert("wrong data input")}(t.result)},t.readAsText(e)}else alert("Error with your datatype")}function ta(e,t,a){var n=new Blob([e],{type:a});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,t);else{var s=document.createElement("a"),i=URL.createObjectURL(n);s.href=i,s.download=t,document.body.appendChild(s),s.click(),setTimeout((function(){document.body.removeChild(s),window.URL.revokeObjectURL(i)}),0)}}function aa(){JXG.Options=JXG.merge(JXG.Options,{board:{showNavigation:!1,showCopyright:!1,useMathJax:!0}}),JXG.Options.text.useMathJax=!0,Yt.board=JXG.JSXGraph.initBoard("plotID",{boundingbox:[-20,1.2,220,-.1],axis:!1,keepaspectratio:!1,showCopyright:!1,showNavigation:!1,zoom:{factorX:1.25,factorY:1.25,wheel:!0,needshift:!1,eps:.1}}),Jt(),Qt(),_t(),qt(),Yt.plotCurves()}function na(){$("#Designer").click(()=>{$("#fsmID").show(),$("#odeID").show(),$("#inID").show(),$("#helpID").show(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").hide(),$("#Simulator").removeClass("active"),$("#Designer").addClass("active"),$("#UploadDownload").removeClass("active")}),$("#Simulator").click(()=>{$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#helpID").show(),$("#plotID").show(),$("#tab2ID").show(),$("#GraphButtons").show(),$("#downloaduploadID").hide(),$("#Simulator").addClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").removeClass("active"),Object.values(Yt.rates).forEach(e=>{e.board.update()})}),$("#UploadDownload").click(()=>{$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#plotID").hide(),$("#tab2ID").hide(),$("#statesID").hide(),$("#ratesID").hide(),$("#tab3ID").hide(),$("#GraphButtons").hide(),$("#downloaduploadID").show(),$("#helpID").hide(),$("#Simulator").removeClass("active"),$("#Designer").removeClass("active"),$("#UploadDownload").addClass("active")}),$("#uploadmodel").change(()=>{ea()}),$("#downloadmodel").click(()=>{!function(){var e,t,a="Epidemic-Model-Data\n";for([e,t]of Q.shMap)"s"===e.substring(0,1)&&(a+=e,a+=",",void 0!==Yt.states[e]?a+=Yt.states[e].getValue():a+="0",a+=",",a+=t.nameArr,a+=";");for([e,t]of(a=a.substring(0,a.length-1),a+=":",a+="\n",Q.shMap))if("t"===e.substring(0,1)&&void 0===t.type){for(let e=0;e<t.nameArr.length;e++)switch(t.nameArr[e][0]){case"r":a+=t.nameArr[e][1],a+="-";break;case"s":a+="(",a+=t.nameArr[e][1].id,a+=")",a+="-";break;case"o":a+="+",a+="-"}a=a.substring(0,a.length-1),a+=",",a+=t.source.id,a+=",",a+=t.target.id,a+=";"}for([e,t]of(":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",Q.shMap))if("t"===e.substring(0,1)&&"in"===t.type){for(let e=0;e<t.nameArr.length;e++)switch(t.nameArr[e][0]){case"r":a+=t.nameArr[e][1],a+="-";break;case"s":a+="(",a+=t.nameArr[e][1].id,a+=")",a+="-";break;case"o":a+="+",a+="-"}a=a.substring(0,a.length-1),a+=",",a+=t.target.id,a+=";"}for([e,t]of(":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",Q.shMap))if("t"===e.substring(0,1)&&"out"===t.type){for(let e=0;e<t.nameArr.length;e++)switch(t.nameArr[e][0]){case"r":a+=t.nameArr[e][1],a+="-";break;case"s":a+="(",a+=t.nameArr[e][1].id,a+=")",a+="-";break;case"o":a+="+",a+="-"}a=a.substring(0,a.length-1),a+=",",a+=t.source.id,a+=";"}":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",Object.keys(Yt.interventions).forEach(e=>{a+=e,a+="-",a+=Yt.interventions[e].getValue(),a+=","}),":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",a+="\n",Object.keys(Yt.rates).forEach(e=>{Object.keys(Yt.interventions).forEach(t=>{a+=e.codePointAt(0),a+=",",a+=t,a+=",",a+=Yt.rates[e][t].getValue(),a+=";"})}),":"!==a.charAt(a.length-1)&&"\n"!==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),a+=":"):a+=":",ta(a,"EMD-download.txt",/text.*/)}()}),$("#downloaddatacsv").click(()=>{!function(){const e=Zt();var t,a,n="population,";for([t,a]of Q.shMap){"s"===t.substring(0,1)&&(n+=t,n+=",")}n+="\n";for(let t=0;t<e.length;t++){var s=e[t].pop();Number.isInteger(s)&&(n+=e[t],n+=",",n+="\n")}ta(n,"EMD-data.csv",/text.*/)}()}),$("#Rates").click(()=>{$("#ratesID").show(),$("#tab3ID").show(),$("#statesID").hide(),$("#Rates").addClass("active"),$("#Values").removeClass("active"),Object.values(Yt.rates).forEach(e=>{e.board.update()})}),$("#Values").click(()=>{$("#ratesID").hide(),$("#tab3ID").hide(),$("#statesID").show(),$("#Values").addClass("active"),$("#Rates").removeClass("active"),Object.values(Yt.states).forEach(e=>{e.board.update()})})}document.addEventListener("DOMContentLoaded",()=>{na(),document.getElementById("Designer").click(),zt.init(),document.getElementById("Simulator").click(),document.getElementById("Rates").click(),$("#Simulator").click(e=>{$("#fsmID").hide(),$("#odeID").hide(),$("#inID").hide(),$("#plotID").show(),$("#tab2ID").show(),$("#GraphButtons").show(),$("#Simulator").addClass("active"),$("#Designer").removeClass("active"),0!==Object.keys(Yt).length&&Yt.update(),document.getElementById("Rates").click()}),aa(),document.getElementById("Designer").click()})}]);
